id,name,description,procedures
T1037,Boot or Logon Initialization Scripts,"Adversaries may use scripts automatically executed at boot or logon initialization to establish persistence. Initialization scripts can be used to perform administrative functions, which may often execute other programs or send information to an internal logging server. These scripts can vary based on operating system and whether applied locally or remotely.    Adversaries may use these scripts to maintain persistence on a single system. Depending on the access configuration of the logon scripts, either local credentials or an administrator account may be necessary.   An adversary may also be able to escalate their privileges since some boot or logon initialization scripts run with higher privileges.","['[APT29] has hijacked legitimate application-specific startup scripts to enable malware to execute on system startup.', 'Depending on the Linux distribution and when executing with root permissions, [RotaJakiro] may install persistence using a `.conf` file in the `/etc/init/` folder.', '[Rocke] has installed an ""init.d"" startup script to maintain persistence.\t']"
T1557,Adversary-in-the-Middle,"Adversaries may attempt to position themselves between two or more networked devices using an adversary-in-the-middle (AiTM) technique to support follow-on behaviors such as [Network Sniffing] [Transmitted Data Manipulation] or replay attacks ([Exploitation for Credential Access] By abusing features of common networking protocols that can determine the flow of network traffic (e.g. ARP, DNS, LLMNR, etc.), adversaries may force a device to communicate through an adversary controlled system so they can collect information or perform additional actions.  For example, adversaries may manipulate victim DNS settings to enable other malicious activities such as preventing/redirecting users from accessing legitimate sites and/or pushing additional malware. Adversaries may also manipulate DNS and leverage their position in order to intercept user credentials and session cookies. [Downgrade Attack] can also be used to establish an AiTM position, such as by negotiating a less secure, deprecated, or weaker version of communication protocol (SSL/TLS) or encryption algorithm.  Adversaries may also leverage the AiTM position to attempt to monitor and/or modify traffic, such as in [Transmitted Data Manipulation] Adversaries can setup a position similar to AiTM to prevent traffic from flowing to the appropriate destination, potentially to [Impair Defenses] and/or in support of a [Network Denial of Service]","['[Dok] proxies web traffic to potentially monitor and alter victim HTTP(S) traffic.', '[Kimsuky] has used modified versions of PHProxy to examine web traffic between the victim and the accessed website.']"
T1033,System Owner/User Discovery,"Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using [OS Credential Dumping] The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs. Adversaries may use the information from [System Owner/User Discovery] during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.  Various utilities and commands may acquire this information, including <code>whoami</code>. In macOS and Linux, the currently logged in user can be identified with <code>w</code> and <code>who</code>. On macOS the <code>dscl . list /Users | grep -v '_'</code> command can also be used to enumerate user accounts. Environment variables, such as <code>%USERNAME%</code> and <code>$USER</code>, may also be used to access this information.  On network devices, [Network Device CLI] commands such as `show users` and `show ssh` can be used to display users currently logged into the device.","['[Trojan.Karagany] can gather information about the user on a compromised host.', '[PoetRAT] sent username, computer name, and the previously generated UUID in reply to a ""who"" command from C2.', '[Revenge RAT] gathers the username from the system.', '[DRATzarus] can obtain a list of users from an infected machine.', '[TrickBot] can identify the user and groups the user belongs to on a compromised host.', '[ShadowPad] has collected the username of the victim system.', '[Squirrelwaffle] can collect the user name from a compromised host.', '[Emotet] has enumerated all users connected to network shares.', '[APT38] has identified primary users, currently logged in users, sets of users that commonly use a system, or inactive users.', '[NBTscan] can list active users on the system.\t', '[NDiskMonitor] obtains the victim username and encrypts the information to send over its C2 channel.', '[BabyShark] has executed the <code>whoami</code> command.', '[WellMess] can collect the username on the victim machine to send to C2.', '[MacMa] can collect the username from the compromised machine.', '[SslMM] sends the logged-on username to its hard-coded C2.', '[BLUELIGHT] can collect the username on a compromised host.', ""[StrifeWater] can collect the user name from the victim's machine."", '[Bumblebee] has the ability to identify the user name.', '[Dyre] has the ability to identify the users on a compromised host.', '[Woody RAT] can retrieve a list of user accounts and usernames from an infected machine.', '[Diavol] can collect the username from a compromised host.', '[Epic] collects the user name from the victim’s machine.', '[POWERSTATS] has the ability to identify the username on the compromised host.', '[FIN8] has executed the command `quser` to display the session details of a compromised machine. ', '[S-Type] has run tests to determine the privilege level of the compromised user.', '[MarkiRAT] can retrieve the victim’s username.', '[Ke3chang] has used implants capable of collecting the signed-in username.', '[Mosquito] runs <code>whoami</code> on the victim’s machine.', '[Unknown Logger] can obtain information about the victim usernames.', '[Azorult] can collect the username from the victim’s machine.', '[metaMain] can collect the username from a compromised host.', '[FIN7] has used the command `cmd.exe /C quser` to collect user session information.', '[AuTo Stealer] has the ability to collect the username from an infected host.', '[HAFNIUM] has used `whoami` to gather user information.', 'During [C0017] [APT41] used `whoami` to gather information from victim machines.', '[Exaramel for Linux] can run <code>whoami</code> to identify the system owner.', '[SysUpdate] can collect the username from a compromised host.', '[RATANKBA] runs the <code>whoami</code> and <code>query user</code> commands.', '[FlawedAmmyy] enumerates the current user during the initial infection.', '[Rising Sun] can detect the username of the infected host.\t', '[UPPERCUT] has the capability to collect the current logged on user’s username from a machine.', '[WINERACK] can gather information on the victim username.', '[SynAck] gathers user names from infected hosts.', '[XAgentOSX] contains the getInfoOSX function to return the OS X version as well as the current user.', '[WINDSHIELD] can gather the victim user name.', '[Koadic] can identify logged in users across the domain and views user sessions.', '[LitePower] can determine if the current user has admin privileges.', '[APT19] used an HTTP malware variant and a Port 22 malware variant to collect the victim’s username.', '[Octopus] can collect the username from the victim’s machine.', '[SideTwist] can collect the username on a targeted system.', '[SpeakUp] uses the <code>whoami</code> command. ', '[GrimAgent] can identify the user id on a target machine.', '[Cardinal RAT] can collect the username from a victim machine.', '[Pupy] can enumerate local information for Linux hosts and find currently logged on users for Windows hosts.', '[Lokibot] has the ability to discover the username on the infected host.', '[FIN10] has used Meterpreter to enumerate users on remote systems.', '[Agent Tesla] can collect the username from the victim’s machine.', '[MechaFlounder] has the ability to identify the username and hostname on a compromised host.', ""[APT32] collected the victim's username and executed the <code>whoami</code> command on the victim's machine. [APT32] executed shellcode to collect the username on the victim's machine. "", '[KONNI] can collect the username from the victim’s machine.', ""[Gold Dragon] collects the endpoint victim's username and uses it as a basis for downloading additional components from the C2 server."", 'During [Operation Wocao] threat actors enumerated sessions and users on a remote host, and identified privileged users logged into a targeted system.', '[Lucifer] has the ability to identify the username on a compromised host.', '[Felismus] collects the current username and sends it to the C2 server.', '[APT39] used [Remexi] to collect usernames from the system.', '[Milan] can identify users registered to a targeted machine.', '[Zebrocy] gets the username from the system.', '[QakBot] can identify the user name on a compromised system.', '[Cannon] can gather the username from the system.', '[SLOTHFULMEDIA] has collected the username from a victim machine.', '[Turian] can retrieve usernames.', '[SodaMaster] can identify the username on a compromised host.', '[APT37] identifies the victim username.', 'Various [Lazarus Group] malware enumerates logged-on users.', 'During [Night Dragon] threat actors used password cracking and pass-the-hash tools to discover usernames and passwords.', '[POWRUNER] may collect information about the currently logged in user by running <code>whoami</code> on a victim.', '[InvisiMole] lists local users and session information.', '[Aria-body] has the ability to identify the username on a compromised host.', '[AsyncRAT] can check if the current user of a compromised system is an administrator. ', ""[Grandoreiro] can collect the username from the victim's machine."", '[Tropic Trooper] used <code>letmein</code> to scan for saved usernames on the target system.', '[Threat Group-3390] has used `whoami` to collect system user information.', '[Chaes] has collected the username and UID from the infected machine.', '[Valak] can gather information regarding the user.', 'During [C0018] the threat actors collected `whoami` information via PowerShell scripts.', '[BADHATCH] can obtain logged user information from a compromised machine and can execute the command `whoami.exe`.', ""[PowerDuke] has commands to get the current user's name and SID."", '[Earth Lusca] collected information on user accounts via the <code>whoami</code> command.', '[QuasarRAT] can enumerate the username and account type.', '[RogueRobin] collects the victim’s username and whether that user is an admin.', '[HAWKBALL] can collect the user name of the system.', '[Kwampirs] collects registered owner details by using the commands <code>systeminfo</code> and <code>net config workstation</code>.', '[ZxShell] can collect the owner and organization information from the target workstation. ', '[Micropsia] collects the username from the victim’s machine.', '[Explosive] has collected the username from the infected host. ', '[Agent.btz] obtains the victim username and saves it to a file.', '[SVCReady] can collect the username from an infected host.', '[Crimson] can identify the user on a targeted system.', '[DownPaper] collects the victim username and sends it to the C2 server.', '[Okrum] can collect the victim username.', 'can collect the victim user name.', '[Lizar] can collect the username from the system. ', 'The OsInfo function in [Komplex] collects the current running username.', '[SombRAT] can execute <code>getinfo</code>  to identify the username on a compromised host.', '[Kazuar] gathers information on users.', 'During [Operation CuckooBees] the threat actors used the `query user` and `whoami` commands as part of their advanced reconnaissance.', '[WellMail] can identify the current username on the victim system.', '[BloodHound] can collect information on user sessions.', '[JPIN] can obtain the victim user name.', '[Magic Hound] malware has obtained the victim username and sent it to the C2 server.', '[ZIRCONIUM] has used a tool to capture the username on a compromised host in order to register it with C2.', '[STARWHALE] can gather the username from an infected host. ', '[Rifdoor] has the ability to identify the username on the compromised host.', ""[Neoichor] can collect the user name from a victim's machine."", ""[Goopy] has the ability to enumerate the infected system's user name."", '[MoonWind] obtains the victim username.', '[FunnyDream] has the ability to gather user information from the targeted system using `whoami/upn&whoami/fqdn&whoami/logonid&whoami/all`.', '[Small Sieve] can obtain the id of a logged in user.', '[Egregor] has used tools to gather information about users.', '[njRAT] enumerates the current user during the initial infection.', '[Chimera] has used the <code>quser</code> command to show currently logged on users. ', '[SMOKEDHAM] has used <code>whoami</code> commands to identify system owners.', '[yty] collects the victim’s username.', '[RCSession] can gather system owner information, including user and administrator privileges.', '[Patchwork] collected the victim username and whether it was running as admin, then sent the information to its C2 server.', '[Stealth Falcon] malware gathers the registered user and primary owner name via WMI.', '[DnsSystem] can use the Windows user name to create a unique identification for infected users and systems.', ' [Volt Typhoon] has executed the PowerShell command `Get-EventLog security -instanceid 4624` to identify associated user and computer account names.', ""[Linux Rabbit] opens a socket on port 22 and if it receives a response it attempts to obtain the machine's hostname and Top-Level Domain. "", '[Gelsemium] has the ability to distinguish between a standard user and an administrator on a compromised host.', '[LuminousMoth] has used a malicious DLL to collect the username from compromised hosts.', '[Spark] has run the whoami command and has a built-in command to identify the user logged in. ', '[NOKKI] can collect the username from the victim’s machine.', '[SDBbot] has the ability to identify the user on a compromised host.', '[Flagpro] has been used to run the <code>whoami</code> command on the system.', '[Mis-Type] runs tests to determine the privilege level of the compromised user.', '[Mafalda] can collect the username from a compromised host.', ""A [Gamaredon Group] file stealer can gather the victim's username to send to a C2 server."", '[T9000] gathers and beacons the username of the logged in account during installation. It will also gather the username of running processes to determine if it is running as SYSTEM.', '[GALLIUM] used <code>whoami</code> and <code>query user</code> to obtain information about the victim user.', '[RTM] can obtain the victim username and permissions.', '[ServHelper] will attempt to enumerate the username of the victim.', '[Wizard Spider] has used ""whoami"" to identify the local user and their privileges.', '[RGDoor] executes the <code>whoami</code> on the victim’s machine.', '[APT41] used the WMIEXEC utility to execute <code>whoami</code> commands on remote machines.', 'A Linux version of [Derusbi] checks if the victim user ID is anything other than zero (normally used for root), and the malware will not execute if it does not have root privileges. [Derusbi] also gathers the username of the victim.', '[WinMM] uses NetUser-GetInfo to identify that it is running under an “Admin” account on the local system.', '[OilRig] has run <code>whoami</code> on a victim.', '[Denis] enumerates and collects the username from the victim’s machine.', '[Bazar] can identify the username of the infected user.', ""[EVILNUM] can obtain the username from the victim's machine."", '[HEXANE] has run `whoami` on compromised machines to identify the current user.', '[zwShell] can obtain the name of the logged-in user on the victim.', '[RedLeaves] can obtain information about the logged on user both locally and for Remote Desktop sessions.', '[GravityRAT] collects the victim username along with other account information (account type, description, full name, SID and status).', '[HotCroissant] has the ability to collect the username on the infected host.', ""[Caterpillar WebShell] can obtain a list of user accounts from a victim's machine."", '[PyDCrypt] has probed victim machines with <code>whoami</code> and has collected the username from the machine.', '[PowerShower] has the ability to identify the current user on the infected host.', '[ROKRAT] can collect the username from a compromised host.', '[ObliqueRAT] can check for blocklisted usernames on infected endpoints.', '[Windshift] has used malware to identify the username on a compromised host.', '[MirageFox] can gather the username from the victim’s machine.', ""[Metamorfo] has collected the username from the victim's machine. "", '[Remsec] can obtain information about the current user.', '[MuddyWater] has used malware that can collect the victim’s username.', '[BoomBox] can enumerate the username on a compromised host.', ""[Gazer] obtains the current user's security identifier."", '[Backdoor.Oldrea] collects the current username from the victim.', '[LiteDuke] can enumerate the account name on a targeted system.', '[Get2] has the ability to identify the current username of an infected host.', '[SUNBURST] collected the username from a compromised host.', '[ZxxZ] can collect the username from a compromised host.', '[Amadey] has collected the user name from a compromised host using `GetUserNameA`.', '[FELIXROOT] collects the username from the victim’s machine.', '[Bonadan] has discovered the username of the user running the backdoor.', '[Clambling] can identify the username on a compromised host.', '[Ixeshe] collects the username from the victim’s machine.', '[Saint Bot] can collect the username from a compromised host.', ""[Reaver] collects the victim's username."", '[VERMIN] gathers the username from the victim’s machine.', '[Dragonfly] used the command <code>query user</code> on victim hosts.', '[Cryptoistic] can gather data on the user of a compromised host.', ' [Action RAT] has the ability to collect the username from an infected host.', '[Chrommme] can retrieve the username from a targeted system.', '[DarkComet] gathers the username from the victim’s machine.', '[BISCUIT] has a command to gather the username from the system.', '[SILENTTRINITY] can gather a list of logged on users. ', '[Sandworm Team] has collected the username from a compromised host.', '[CreepySnail] can execute `getUsername` on compromised systems.', ""[More_eggs] has the capability to gather the username from the victim's machine."", '[DarkWatchman] has collected the username from a victim machine.', 'During [Frankenstein] the threat actors used [Empire] to enumerate hosts and gather username, machine name, and administrative permissions information.', '[SHARPSTATS] has the ability to identify the username on the compromised host.', '[NanHaiShu] collects the username from the victim.', '[Empire] can enumerate the username on targeted hosts.', '[KOPILUWAK] can conduct basic network reconnaissance on the victim machine with `whoami`, to get user details.', '[BlackCat] can utilize `net use` commands to discover the user name on a compromised host.', '[Sidewinder] has used tools to identify the user of a compromised host.', '[QUADAGENT] gathers the victim username.', 'A module in [Prikormka] collects information from the victim about the current user name.', 'An [APT3] downloader uses the Windows command <code>""cmd.exe"" /C whoami</code> to verify that it is running with the elevated privileges of “System.”', '[Sys10] collects the account name of the logged-in user and sends it to the C2.', '[Frankenstein] has enumerated hosts, gathering username, machine name, and administrative permissions information.', '[Operation Wocao] has enumerated sessions and users on a remote host, and identified privileged users logged into a targeted system.', '[Dragonfly 2.0] used the command <code>query user</code> on victim hosts.', 'APT28 has queried information on machines to determine the current user or system owner .']"
T1592,Gather Victim Host Information,"Adversaries may gather information about the victim's hosts that can be used during targeting. Information about hosts may include a variety of details, including administrative data (ex: name, assigned IP, functionality, etc.) as well as specifics regarding its configuration (ex: operating system, language, etc.).  Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning] or [Phishing for Information] Adversaries may also compromise sites then include malicious content designed to collect host information from visitors. Information about hosts may also be exposed to adversaries via online or other accessible data sets (ex: [Social Media] or [Search Victim-Owned Websites] Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains] or [Search Open Technical Databases] establishing operational resources (ex: [Develop Capabilities] or [Obtain Capabilities] and/or initial access (ex: [Supply Chain Compromise] or [External Remote Services]",[]
T1003,OS Credential Dumping,"Adversaries may attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software. Credentials can then be used to perform [Lateral Movement] and access restricted information.  Several of the tools mentioned in associated sub-techniques may be used by both adversaries and professional security testers. Additional custom tools likely exist as well. ","['[APT39] has used different versions of Mimikatz to obtain credentials.', '[Carbanak] obtains Windows logon password details.', '[Revenge RAT] has a plugin for credential harvesting.', '[PinchDuke] steals credentials from compromised hosts. [PinchDuke] credential stealing functionality is believed to be based on the source code of the Pinch credential stealing malware (also known as LdPinch). Credentials targeted by [PinchDuke] include ones associated many sources such as WinInet Credential Cache, and Lightweight Directory Access Protocol (LDAP).', '[Poseidon Group] conducts credential dumping on victims, with a focus on obtaining credentials belonging to domain and database servers.', '[OnionDuke] steals credentials from its victims.', '[Tonto Team] has used a variety of credential dumping tools. ', '[APT32] used GetPassword_x64 to harvest credentials.', '[HOMEFRY] can perform credential dumping.', '[Suckfly] used a signed credential-dumping tool to obtain victim account credentials.', '[Trojan.Karagany] can dump passwords and save them into <code>\\ProgramData\\Mail\\MailAg\\pwds.txt</code>.', '[APT28] regularly deploys both publicly available (ex: [Mimikatz] and custom password retrieval tools on victims.\t', '[Sowbug] has used credential dumping tools.', '[Axiom] has been known to dump credentials.', '[Leviathan] has used publicly available tools to dump password hashes, including [HOMEFRY]', ""[Frankenstein] has harvested credentials from the victim's machine using [Empire]"", '[KONNI] can steal profiles (containing credential information) from Firefox, Chrome, and Opera.', '[Azorult] can dump credentials from victim browsers.', 'APT34 has dumped credentials from victims in several ways, including by using open source tools Mimikatz and Lazagne, or by harvesting credentials when users log into Outlook Web Access.', 'Dragonfly dropped and executed SecretsDump, a tool that dumps password hashes.']"
T1602,Data from Configuration Repository,"Adversaries may collect data related to managed devices from configuration repositories. Configuration repositories are used by management systems in order to configure, manage, and control data on remote systems. Configuration repositories may also facilitate remote access and administration of devices.  Adversaries may target these repositories in order to collect large quantities of sensitive system administration data. Data from configuration repositories may be exposed by various protocols and software and can store a wide variety of data, much of which may align with adversary Discovery objectives.",[]
T1014,Rootkit,"Adversaries may use rootkits to hide the presence of programs, files, network connections, services, drivers, and other system components. Rootkits are programs that hide the existence of malware by intercepting/hooking and modifying operating system API calls that supply system information.    Rootkits or rootkit enabling functionality may reside at the user or kernel level in the operating system or lower, to include a hypervisor, Master Boot Record, or [System Firmware]  Rootkits have been seen for Windows, Linux, and Mac OS X systems.  ","['[Ebury] has used user mode rootkit techniques to remain hidden on the system.', '[Winnti Group] used a rootkit to modify typical server functionality.', '[APT41] deployed rootkits on Linux systems.', '[Rocke] has modified /etc/ld.so.preload to hook libc functions in order to hide the installed dropper and mining software in process lists.', '[Carberp] has used user mode rootkit techniques to remain hidden on the system.', '[Ramsay] has included a rootkit to evade defenses.\t', '[Drovorub] has used a kernel module rootkit to hide processes, files, executables, and network artifacts from user space view.', '[HTRAN] can install a rootkit to hide network connections from the host OS.', '[HIDEDRV] is a rootkit that hides certain operating system artifacts.', '[TeamTNT] has used rootkits such as the open-source Diamorphine rootkit and their custom bots to hide cryptocurrency mining activities on the machine. ', '[Skidmap] is a kernel-mode rootkit that has the ability to hook system calls to hide specific files and fake network and CPU-related statistics to make the CPU load of the infected machine always appear low.', '[Umbreon] hides from defenders by hooking libc function calls, hiding artifacts that would reveal its presence, such as the user account it creates to provide access and undermining strace, a tool often used to identify malware.', '[Stuxnet] uses a Windows rootkit to mask its binaries and other relevant files.', '[Hacking Team UEFI Rootkit] is a UEFI BIOS rootkit developed by the company Hacking Team to persist remote access software on some targeted systems.', '[HiddenWasp] uses a rootkit to hook and implement functions on the system.', '[Hildegard] has modified /etc/ld.so.preload to overwrite readdir() and readdir64().', '[APT28] has used a UEFI (Unified Extensible Firmware Interface) rootkit known as [LoJax]', '[Hikit] is a [Rootkit] that has been used by [Axiom]  ', ""[Winnti for Linux] has used a modified copy of the open-source userland rootkit Azazel, named libxselinux.so, to hide the malware's operations and network activity."", '[Zeroaccess] is a kernel-mode rootkit.', '[LoJax] is a UEFI BIOS rootkit deployed to persist remote access software on some targeted systems.', ""[Uroburos] can use its kernel module to prevent its host components from being listed by the targeted system's OS and to mediate requests between user mode and concealed components."", '[WarzoneRAT] can include a rootkit to hide processes, files, and startup.', '[Caterpillar WebShell] has a module to use a rootkit on a system. ', '[PoisonIvy] starts a rootkit from a malicious file dropped to disk.', 'starts a rootkit from a malicious file dropped to disk.']"
T1543,Create or Modify System Process,"Adversaries may create or modify system-level processes to repeatedly execute malicious payloads as part of persistence. When operating systems boot up, they can start processes that perform background system functions. On Windows and Linux, these system processes are referred to as services. On macOS, launchd processes known as [Launch Daemon] and [Launch Agent] are run to finish system initialization and load user specific parameters.   Adversaries may install new services, daemons, or agents that can be configured to execute at startup or a repeatable interval in order to establish persistence. Similarly, adversaries may modify existing services, daemons, or agents to achieve the same effect.    Services, daemons, or agents may be created with administrator privileges but executed under root/SYSTEM privileges. Adversaries may leverage this functionality to create or modify system processes in order to escalate privileges.  ","['[Exaramel for Linux] has a hardcoded location that it uses to achieve persistence if the startup system is Upstart or System V and it is running as root.', '[MiniDuke] can create a process on a compromised host.', '[FatDuke] has the ability to create a process.']"
T1133,External Remote Services,"Adversaries may leverage external-facing remote services to initially access and/or persist within a network. Remote services such as VPNs, Citrix, and other access mechanisms allow users to connect to internal enterprise network resources from external locations. There are often remote service gateways that manage connections and credential authentication for these services. Services such as [Windows Remote Management] and [VNC] can also be used externally.  Access to [Valid Accounts] to use the service is often a requirement, which could be obtained through credential pharming or by obtaining the credentials from users after compromising the enterprise network. Access to remote services may be used as a redundant or persistent access mechanism during an operation.  Access may also be gained through an exposed service that doesn’t require authentication. In containerized environments, this may include an exposed Docker API, Kubernetes API server, kubelet, or web application such as the Kubernetes dashboard.","['[TeamTNT] has used open-source tools such as Weave Scope to target exposed Docker API ports and gain initial access to victim environments. [TeamTNT] has also targeted exposed kubelets for Kubernetes environments.', '[FIN13] has gained access to compromised environments via remote access services such as the corporate virtual private network (VPN).', 'During [Operation CuckooBees] the threat actors enabled WinRM over HTTP/HTTPS as a backup persistence mechanism using the following command: `cscript //nologo ""C:\\Windows\\System32\\winrm.vbs"" set winrm/config/service@{EnableCompatibilityHttpsListener=""true""}`.', '[Linux Rabbit] attempts to gain access to the server via SSH.', 'During [Night Dragon] threat actors used compromised VPN accounts to gain access to victim systems.', '[Mafalda] can establish an SSH connection from a compromised host to a server.', '[APT18] actors leverage legitimate credentials to log into external remote services.', '[TEMP.Veles] has used a VPN to persist in the victim environment.', ""[Sandworm Team] has used Dropbear SSH with a hardcoded backdoor password to maintain persistence within the target network. [Sandworm Team] has also used VPN tunnels established in legitimate software company infrastructure to gain access to internal networks of that software company's users."", '[Hildegard] was executed through an unsecure kubelet that allowed anonymous access to the victim environment.', '[Scattered Spider] has leveraged legitimate remote management tools to maintain persistent access.', '[APT41] compromised an online billing/payment service using VPN access between a third-party service provider and the targeted payment service. ', '[LAPSUS$] has gained access to internet-facing systems and applications, including virtual private network (VPN), remote desktop protocol (RDP), and virtual desktop infrastructure (VDI) including Citrix. ', '[OilRig] uses remote services such as VPN, Citrix, or OWA to persist in an environment.', '[GALLIUM] has used VPN services, including SoftEther VPN, to access and maintain persistence in victim environments.', '[Ke3chang] has gained access through VPNs including with compromised accounts and stolen VPN certificates.', 'During the [2015 Ukraine Electric Power Attack] [Sandworm Team] installed a modified Dropbear SSH client as the backdoor to target systems. ', '[Wizard Spider] has accessed victim networks by using stolen credentials to access the corporate VPN infrastructure.', '[APT29] has used compromised identities to access networks via VPNs and Citrix.', 'During [CostaRicto] the threat actors set up remote tunneling using an SSH tool to maintain access to a compromised environment.', '[Kimsuky] has used RDP to establish persistence.', '[FIN5] has used legitimate VPN, Citrix, or VNC credentials to maintain access to a victim environment.', 'For the [SolarWinds Compromise] [APT29] used compromised identities to access networks via SSH, VPNs, and other remote access tools.', '[Threat Group-3390] actors look for and use VPN profiles during an operation to access the network using external VPN services. [Threat Group-3390] has also obtained OWA account credentials during intrusions that it subsequently used to attempt to regain access when evicted from a victim network.', '[Kinsing] was executed in an Ubuntu container deployed via an open Docker daemon API.', 'During [C0027] [Scattered Spider] used Citrix and VPNs to persist in compromised environments.', '[GOLD SOUTHFIELD] has used publicly-accessible RDP and remote management and monitoring (RMM) servers to gain access to victim machines.\t', '[Chimera] has used legitimate credentials to login to an external VPN, Citrix, SSH, and other remote services.', '[Dragonfly] has used VPNs and Outlook Web Access (OWA) to maintain access to victim networks.', '[APT28] has used [Tor] and a variety of commercial VPN services to route brute force authentication attempts.', ""During [Operation Wocao] threat actors used stolen credentials to connect to the victim's network via VPN."", '[Doki] was executed through an open Docker daemon API port.', '[Leviathan] has used external remote services such as virtual private networks (VPN) to gain initial access.', '[UNC2452] has used compromised identities to access VPNs and remote access tools.', '[Night Dragon] has used compromised VPN accounts to gain access to victim systems.', ""[Operation Wocao] has used stolen credentials to connect to the victim's network via VPN."", '[Dragonfly 2.0] used VPNs and Outlook Web Access (OWA) to maintain access to victim networks.', 'Dragonfly used remote access services, including VPN and Outlook Web Access (OWA).', 'APT34 uses remote services such as VPN, Citrix, or OWA to persist in an environment.']"
T1539,Steal Web Session Cookie,"An adversary may steal web application or service session cookies and use them to gain access to web applications or Internet services as an authenticated user without needing credentials. Web applications and services often use session cookies as an authentication token after a user has authenticated to a website.  Cookies are often valid for an extended period of time, even if the web application is not actively used. Cookies can be found on disk, in the process memory of the browser, and in network traffic to remote systems. Additionally, other applications on the targets machine might store sensitive authentication cookies in memory (e.g. apps which authenticate to cloud services). Session cookies can be used to bypasses some multi-factor authentication protocols.  There are several examples of malware targeting cookies from web browsers on the local system. There are also open source frameworks such as `Evilginx2` and `Muraena` that can gather session cookies through a malicious proxy (ex: [Adversary-in-the-Middle] that can be set up by an adversary and used in phishing campaigns.  After an adversary acquires a valid cookie, they can then perform a [Web Session Cookie] technique to login to the corresponding web application.","['[LuminousMoth] has used an unnamed post-exploitation tool to steal cookies from the Chrome browser.', ""[Grandoreiro] can steal the victim's cookies to use for duplicating the active session from another device."", '[Evilnum] can steal cookies and session information from browsers.', '[CookieMiner] can steal Google Chrome and Apple Safari browser cookies from the victim’s machine. ', '[QakBot] has the ability to capture web session cookies.', '[EVILNUM] can harvest cookies and upload them to the C2 server.', '[Chaes] has used a script that extracts the web session cookie and sends it to the C2 server. ', '[BLUELIGHT] can harvest cookies from Internet Explorer, Edge, Chrome, and Naver Whale browsers.', 'During the [SolarWinds Compromise] [APT29] stole Chrome browser cookies by copying the Chrome profile directories of targeted users.', '[XCSSET] uses <code>scp</code> to access the <code>~/Library/Cookies/Cookies.binarycookies</code> file.', '[TajMahal] has the ability to steal web session cookies from Internet Explorer, Netscape Navigator, FireFox and RealNetworks applications.', '[APT29] has stolen Chrome browser cookies by copying the Chrome profile directories of targeted users.']"
T1069,Permission Groups Discovery,"Adversaries may attempt to discover group and permission settings. This information can help adversaries determine which user accounts and groups are available, the membership of users in particular groups, and which users and groups have elevated permissions.  Adversaries may attempt to discover group permission settings in many different ways. This data may provide the adversary with information about the compromised environment that can be used in follow-on activity and targeting.","['[IcedID] has the ability to identify Workgroup membership.', '[Carbon] uses the <code>net group</code> command.', 'During the [SolarWinds Compromise] [APT29] used the `Get-ManagementRoleAssignment` PowerShell cmdlet to enumerate Exchange management role assignments through an Exchange Management Shell.', '[TrickBot] can identify the groups the user on a compromised host belongs to.', '[MURKYTOP] has the capability to retrieve information about groups.', '[TA505] has used TinyMet to enumerate members of privileged groups. [TA505] has also run <code>net group /domain</code>.', '[ShimRatReporter] gathered the local privileges for the infected host.', '[APT3] has a tool that can enumerate the permissions associated with Windows groups.', '[Siloscape] checks for Kubernetes node permissions.', ""[FIN13] has enumerated all users and roles from a victim's main treasury system."", '[APT29] used the <code>Get-ManagementRoleAssignment</code> PowerShell cmdlet to enumerate Exchange management role assignments through an Exchange Management Shell.', '[UNC2452] used the <code>Get-ManagementRoleAssignment</code> PowerShell cmdlet to enumerate Exchange management role assignments through an Exchange Management Shell.', '[PUNCHBUGGY] can gather domain and workgroup information.\t']"
T1615,Group Policy Discovery,"Adversaries may gather information on Group Policy settings to identify paths for privilege escalation, security measures applied within a domain, and to discover patterns in domain objects that can be manipulated or used to blend in the environment. Group Policy allows for centralized management of user and computer settings in Active Directory (AD). Group policy objects (GPOs) are containers for group policy settings made up of files stored within a predictable network path `\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\`.  Adversaries may use commands such as <code>gpresult</code> or various publicly available PowerShell functions, such as <code>Get-DomainGPO</code> and <code>Get-DomainGPOLocalGroup</code>, to gather information on Group Policy settings. Adversaries may use this information to shape follow-on behaviors, including determining potential attack paths within the target network as well as opportunities to manipulate Group Policy settings (i.e. [Domain Policy Modification] for their benefit.","['[BloodHound] has the ability to collect local admin information via GPO.', '[Turla] surveys a system upon check-in to discover Group Policy details using the <code>gpresult</code> command.', '[Empire] includes various modules for enumerating Group Policy.', '[Emissary] has the capability to execute <code>gpresult</code>.']"
T1547,Boot or Logon Autostart Execution,"Adversaries may configure system settings to automatically execute a program during system boot or logon to maintain persistence or gain higher-level privileges on compromised systems. Operating systems may have mechanisms for automatically running a program on system boot or account logon. These mechanisms may include automatically executing programs that are placed in specially designated directories or are referenced by repositories that store configuration information, such as the Windows Registry. An adversary may achieve the same goal by modifying or extending features of the kernel.  Since some boot or logon autostart programs run with higher privileges, an adversary may leverage these to elevate privileges.","['[xCaon] has added persistence via the Registry key <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\load</code> which causes the malware to run each time any user logs in.', '[Dtrack] RAT makes a persistent target file with auto execution on the host start.', '[Mis-Type] has created registry keys for persistence, including `HKCU\\Software\\bkfouerioyou`, `HKLM\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{6afa8072-b2b1-31a8-b5c1-{Unique Identifier}`, and `HKLM\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{3BF41072-B2B1-31A8-B5C1-{Unique Identifier}`.', '[BoxCaon] established persistence by setting the <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\load</code> registry key to point to its executable.', '[Misdat] has created registry keys for persistence, including `HKCU\\Software\\dnimtsoleht\\StubPath`, `HKCU\\Software\\snimtsOleht\\StubPath`, `HKCU\\Software\\Backtsaleht\\StubPath`, `HKLM\\SOFTWARE\\Microsoft\\Active Setup\\Installed. Components\\{3bf41072-b2b1-21c8-b5c1-bd56d32fbda7}`, and `HKLM\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{3ef41072-a2f1-21c8-c5c1-70c2c3bc7905}`. ', '[LoudMiner] can automatically launch at startup if the AutoStart option is enabled in the VBoxVmService configuration file.']"
T1080,Taint Shared Content," Adversaries may deliver payloads to remote systems by adding content to shared storage locations, such as network drives or internal code repositories. Content stored on network drives or in other shared locations may be tainted by adding malicious programs, scripts, or exploit code to otherwise valid files. Once a user opens the shared tainted content, the malicious portion can be executed to run the adversary's code on a remote system. Adversaries may use tainted shared content to move laterally.  A directory share pivot is a variation on this technique that uses several other techniques to propagate malware when users access a shared network directory. It uses [Shortcut Modification] of directory .LNK files that use [Masquerading] to look like the real directories, which are hidden through [Hidden Files and Directories] The malicious .LNK-based directories have an embedded command that executes the hidden malware file in the directory and then opens the real intended directory so that the user's expected action still occurs. When used with frequently used network directories, the technique may result in frequent reinfections and broad access to systems and potentially to new and higher privileged accounts.   Adversaries may also compromise shared network directories through binary infections by appending or prepending its code to the healthy binary on the shared network directory. The malware may modify the original entry point (OEP) of the healthy binary to ensure that it is executed before the legitimate code. The infection could continue to spread via the newly infected file when it is executed by a remote system. These infections may target both binary and non-binary formats that end with extensions including, but not limited to, .EXE, .DLL, .SCR, .BAT, and/or .VBS.","['[H1N1] has functionality to copy itself to network shares.', '[Darkhotel] used a virus that propagates by infecting executables stored on shared drives.', '[Ramsay] can spread itself by infecting other portable executable files on networks shared drives.\t', '[Gamaredon Group] has injected malicious macros into all Word and Excel documents on mapped network drives.', '[BRONZE BUTLER] has placed malware on file shares and given it the same name as legitimate documents on the share.', '[InvisiMole] can replace legitimate software or documents in the compromised network with their trojanized versions, in an attempt to propagate itself within the network.', '[Conti] can spread itself by infecting other remote machines via network shared drives. ', '[Miner-C] copies itself into the public folder of Network Attached Storage (NAS) devices and infects new victims who open the file.', '[Stuxnet] infects remote servers via network shares and by infecting WinCC database views with malicious code.', '[Ursnif] has copied itself to and infected files in network drives for propagation.']"
T1119,Automated Collection,"Once established within a system or network, an adversary may use automated techniques for collecting internal data. Methods for performing this technique could include use of a [Command and Scripting Interpreter] to search for and copy information fitting set criteria such as file type, location, or name at specific time intervals. In cloud-based environments, adversaries may also use cloud APIs, command line interfaces, or extract, transform, and load (ETL) services to automatically collect data. This functionality could also be built into remote access tools.   This technique may incorporate use of other techniques such as [File and Directory Discovery] and [Lateral Tool Transfer] to identify and move files, as well as [Cloud Service Dashboard] and [Cloud Storage Object Discovery] to identify resources in cloud environments.","['[T9000] searches removable storage devices for files with a pre-defined list of file extensions (e.g. * .doc, *.ppt, *.xls, *.docx, *.pptx, *.xlsx). Any matching files are encrypted and written to a local user directory.', '[Rover] automatically collects files from the local system and removable drives based on a predefined list of file extensions on a regular timeframe.', '[Micropsia] executes an RAR tool to recursively archive files based on a predefined list of file extensions (*.xls, *.xlsx, *.csv, *.odt, *.doc, *.docx, *.ppt, *.pptx, *.pdf, *.mdb, *.accdb, *.accde, *.txt).', '[ccf32] can be used to automatically collect files from a compromised host.', '[Gamaredon Group] has deployed scripts on compromised systems that automatically scan for interesting documents.', '[Comnie] executes a batch script to store discovery information in %TEMP%\\info.dat and then uploads the temporarily file to the remote C2 server.', 'During [Operation Wocao] threat actors used a script to collect information about the infected system.', '[ROADTools] automatically gathers data from Azure AD environments using the Azure Graph API.', '[NETWIRE] can automatically archive collected data.', '[PoshC2] contains a module for recursively parsing through files and directories to gather valid credit card numbers.', '[PoetRAT] used file system monitoring to track modification and enable automatic exfiltration.', '[Empire] can automatically gather the username, domain name, machine name, and other information from a compromised system.', '[APT1] used a batch script to perform a series of discovery techniques and saves it to a text file.', '[Proxysvc] automatically collects data about the victim and sends it to the control server.', '[BADNEWS] monitors USB devices and copies files with certain extensions to a predefined directory.', '[TajMahal] has the ability to index and compress files into a send queue for exfiltration.', '[Ke3chang] has performed frequent and scheduled data collection from victim networks.', '[FIN5] scans processes on all victim systems in the environment and uses automated scripts to pull back the results.', '[VERMIN] saves each collected file with the automatically generated format {0:dd-MM-yyyy}.txt .', '[Metamorfo] has automatically collected mouse clicks, continuous screenshots on the machine, and set timers to collect the contents of the clipboard and website browsing. ', '[APT28] used a publicly available tool to gather and compress multiple documents on the DCCC and DNC networks.', '[WindTail] can identify and add files that possess specific file extensions to an array for archiving.', 'For all non-removable drives on a victim, [USBStealer] executes automated collection of certain files for later exfiltration.', '[AppleSeed] has automatically collected data from USB drives, keystrokes, and screen images before exfiltration.', '[Valak] can download a module to search for and build a report of harvested credential data.', '[OutSteel] can automatically scan for and collect files with specific extensions.', '[LightNeuron] can be configured to automatically collect files under a specified directory.', '[Bankshot] recursively generates a list of files within a directory and sends them back to the control server.', '[StrongPity] has a file searcher component that can automatically collect and archive files based on a predefined list of file extensions.', '[FunnyDream] can monitor files for changes and automatically collect them.', '[Attor] has automatically collected data about the compromised system.', '[Confucius] has used a file stealer to steal documents and images with the following extensions: txt, pdf, png, jpg, doc, xls, xlm, odp, ods, odt, rtf, ppt, xlsx, xlsm, docx, pptx, and jpeg.', '[OilRig] has used automated collection.', '[Ramsay] can conduct an initial scan for Microsoft Word documents on the local system, removable media, and connected network drives, before tagging and collecting them. It can continue tagging documents to collect with follow up scans.\t', '[RTM] monitors browsing activity and automatically captures screenshots if a victim browses to a URL matching one of a list of strings.', 'During [Frankenstein] the threat actors used [Empire] to automatically gather the username, domain name, machine name, and other system information.', '[FIN6] has used a script to iterate through a list of compromised PoS systems, copy and remove data to a log file, and to bind to events from the submit payment button.', '[Patchwork] developed a file stealer to search C:\\ and collect files with certain extensions. [Patchwork] also executed a script to enumerate all drives, store them as a list, and upload generated files to the C2 server.', ""[Tropic Trooper] has collected information automatically using the adversary's [USBferry] attack.\t"", '[Sidewinder] has used tools to automatically collect system and network configuration information.', '[Chimera] has used custom DLLs for continuous retrieval of data from memory.', '[GoldFinder] logged and stored information related to the route or hops a packet took from a compromised machine to a hardcoded C2 server, including the target C2 URL, HTTP response/status code, HTTP response headers and values, and data received from the C2 node.  ', ""[Threat Group-3390] ran a command to compile an archive of file types of interest from the victim user's directories."", '[Mythic] supports scripting of file downloads from agents.\t', '[Mustang Panda] used custom batch scripts to collect files automatically from a targeted system.', '[InvisiMole] can sort and collect specific documents as well as generate a list of all files on a newly inserted drive and store them in an encrypted file.', '[Crutch] can automatically monitor removable drives in a loop and copy interesting files.', 'A [Helminth] VBScript receives a batch script to execute a set of commands in a command prompt.', 'Depending on the Linux distribution, [RotaJakiro] executes a set of commands to collect device information and sends the collected information to the C2 server.', '[Pacu] can automatically collect data, such as CloudFormation templates, EC2 user data, AWS Inspector reports, and IAM credential reports.', '[Zebrocy] scans the system and automatically collects files with the following extensions: .doc, .docx, ,.xls, .xlsx, .pdf, .pptx, .rar, .zip, .jpg, .jpeg, .bmp, .tiff, .kum, .tlg, .sbx, .cr, .hse, .hsf, and .lhz.', '[menuPass] has used the Csvde tool to collect Active Directory files and data.', '[ShimRatReporter] gathered information automatically, without instruction from a C2, related to the user and host machine that is compiled into a report and sent to the operators.', '[MESSAGETAP] checks two files, keyword_parm.txt and parm.txt, for instructions on how to target and save data parsed and extracted from SMS message data from the network traffic. If an SMS message contained either a phone number, IMSI number, or keyword that matched the predefined list, it is saved to a CSV file for later theft by the threat actor.', '[Frankenstein] has enumerated hosts via [Empire] gathering the username, domain name, machine name, and other system information.', '[Operation Wocao] has used a script to collect information about the infected system.']"
T1007,System Service Discovery,"Adversaries may try to gather information about registered local system services. Adversaries may obtain information about services using tools as well as OS utility commands such as <code>sc query</code>, <code>tasklist /svc</code>, <code>systemctl --type=service</code>, and <code>net start</code>.  Adversaries may use the information from [System Service Discovery] during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.","['[Ursnif] has gathered information about running services.', '[BRONZE BUTLER] has used TROJ_GETVERSION to discover system services.', '[Sykipot] may use <code>net start</code> to display running services.', '[Comnie] runs the command: <code>net start >> %TEMP%\\info.dat</code> on a victim.', '[SysUpdate] can collect a list of services on a victim machine.', 'The <code>net start</code> command can be used in [Net] to find information about Windows services.', ""[TeamTNT] has searched for services such as Alibaba Cloud Security's aliyun service and BMC Helix Cloud Security's bmc-agent service in order to disable them."", '[Elise] executes <code>net start</code> after initial communication is made to the remote server.', '[PoshC2] can enumerate service and service permission information.', '[Indrik Spider] has used the win32_service WMI class to retrieve a list of services from the system. ', '[SLOTHFULMEDIA] has the capability to enumerate services.', '[Kwampirs] collects a list of running services with the command <code>tasklist /svc</code>.', '[Tasklist] can be used to discover services running on a system.', '[jRAT] can list local services.', '[RATANKBA] uses <code>tasklist /svc</code> to display running tasks.', '[OilRig] has used <code>sc query</code> on a victim to gather information about services.', '[Turla] surveys a system upon check-in to discover running services and associated processes using the <code>tasklist /svc</code> command.', '[BBSRAT] can query service configuration information.', '[RainyDay] can create and register a service for execution.', '[Cobalt Strike] can enumerate services on compromised hosts.', '[Volgmer] queries the system to identify existing services.', '[LookBack] can enumerate services on the victim machine.', '[Heyoka Backdoor] can check if it is running as a service on a compromised host.', '[Aquatic Panda] has attempted to discover services for third party EDR products.', 'After compromising a victim, [Poseidon Group] discovers all running services.', ""[Kimsuky] has used an instrumentor script to gather the names of all services running on a victim's system."", '[Caterpillar WebShell] can obtain a list of the services from a system. ', '[Chimera] has used <code>net start</code> and <code>net use</code> for system service discovery.', '[Ke3chang] performs service discovery using <code>net start</code> commands.', '[InvisiMole] can obtain running services on the victim.', '[GreyEnergy] enumerates all Windows services.', '[SUNBURST] collected a list of service names that were hashed using a FNV-1a + XOR algorithm to check against similarly-hashed hardcoded blocklists.', '[HyperBro] can list all services and their configurations.', '[Black Basta] can check whether the service name FAX is present.', '[Hydraq] creates a backdoor through which remote attackers can monitor services.', '[GravityRAT] has a feature to list the available services on the system.', '[REvil] can enumerate active services.', '[Cuba] can query service status using <code>QueryServiceStatusEx</code> function.', '[SynAck] enumerates all running services.', '[Sardonic] has the ability to execute the `net start` command.', '[HotCroissant] has the ability to retrieve a list of services on the infected host.', '[Earth Lusca] has used [Tasklist] to obtain information from a compromised host.', '[S-Type] runs the command <code>net start</code> on a victim.', '[GeminiDuke] collects information on programs and services on the victim that are configured to automatically run at startup.', 'During [Operation Wocao] threat actors used the `tasklist` command to search for one of its backdoors.', '[ZLib] has the ability to discover and manipulate Windows services.', ""[DarkTortilla] can retrieve information about a compromised system's running services."", '[Emissary] has the capability to execute the command <code>net start</code> to interact with services.', '[Babuk] can enumerate all services running on a compromised host.', '[Ixeshe] can list running services.', '[SombRAT] can enumerate services on a victim machine.', '[WINERACK] can enumerate services.', '[Epic] uses the <code>tasklist /svc</code> command to list the services on the system.', '[BitPaymer] can enumerate existing Windows services on the host that are configured to run as LocalSystem.', '[TrickBot] collects a list of install programs and services on the system’s machine.', '[JPIN] can list running services.', '[admin@338] actors used the following command following exploitation of a machine with [LOWBALL] malware to obtain information about services: <code>net start >> %temp%\\download</code>', 'During [Operation CuckooBees] the threat actors used the `net start` command as part of their initial reconnaissance.', '[Dyre] has the ability to identify running services on a compromised host.', '[APT1] used the commands <code>net start</code> and <code>tasklist</code> to get a listing of the services on the system.', '[ZxShell] can check the services on the system. ', '[SILENTTRINITY] can search for modifiable services that could be used for privilege escalation.', '[Operation Wocao] has used the <code>tasklist</code> command to search for one of its backdoors.']"
T1040,Network Sniffing,"Adversaries may sniff network traffic to capture information about an environment, including authentication material passed over the network. Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.  Data captured via this technique may include user credentials, especially those sent over an insecure, unencrypted protocol. Techniques for name service resolution poisoning, such as [LLMNR/NBT-NS Poisoning and SMB Relay] can also be used to capture credentials to websites, proxies, and internal systems by redirecting traffic to an adversary.  Network sniffing may also reveal configuration details, such as running services, version numbers, and other network characteristics (e.g. IP addresses, hostnames, VLAN IDs) necessary for subsequent Lateral Movement and/or Defense Evasion activities.  In cloud-based environments, adversaries may still be able to use traffic mirroring services to sniff network traffic from virtual machines. For example, AWS Traffic Mirroring, GCP Packet Mirroring, and Azure vTap allow users to define specified instances to collect traffic from and specified targets to send collected traffic to. Often, much of this traffic will be in cleartext due to the use of TLS termination at the load balancer level to reduce the strain of encrypting and decrypting traffic. The adversary can then use exfiltration techniques such as Transfer Data to Cloud Account in order to access the sniffed traffic.  On network devices, adversaries may perform network captures using [Network Device CLI] commands such as `monitor capture`.","['[Sandworm Team] has used intercepter-NG to sniff passwords in network traffic.\t', '[Kimsuky] has used the Nirsoft SniffPass network sniffer to obtain passwords sent over non-secure protocols.', '[Impacket] can be used to sniff network traffic via an interface or raw socket.', '[NBTscan] can dump and print whole packet content.\t', '[MESSAGETAP] uses the libpcap library to listen to all traffic and parses network protocols starting with Ethernet and IP layers. It continues parsing protocol layers including SCTP, SCCP, and TCAP and finally extracts SMS message data and routing metadata.  ', 'During the [2015 Ukraine Electric Power Attack] [Sandworm Team] used [BlackEnergy] network sniffer module to discover user credentials being sent over the network between the local LAN and the power grid’s industrial control systems. ', '[Penquin] can sniff network traffic to look for packets matching specific conditions.', '[FoggyWeb] can configure custom listeners to passively monitor all incoming HTTP GET and POST requests sent to the AD FS server from the intranet/internet and intercept HTTP requests that match the custom URI patterns defined by the actor.', '[Empire] can be used to conduct packet captures on target hosts.', '[Responder] captures hashes and credentials that are sent to the system after the name services have been poisoned.', '[Emotet] has been observed to hook network APIs to monitor network traffic. ', '[APT33] has used SniffPass to collect credentials by sniffing network traffic.', '[DarkVishnya] used network sniffing to obtain login data. ', '[APT28] deployed the open source tool Responder to conduct NetBIOS Name Service poisoning, which captured usernames and hashed passwords that allowed access to legitimate credentials. [APT28] close-access teams have used Wi-Fi pineapples to intercept Wi-Fi signals and user credentials.', '[PoshC2] contains a module for taking packet captures on compromised hosts.', '[Regin] appears to have functionality to sniff for credentials passed over HTTP, SMTP, and SMB.', '[Stolen Pencil] has a tool to sniff the network for passwords. ']"
T1530,Data from Cloud Storage,"Adversaries may access data from cloud storage.  Many IaaS providers offer solutions for online data object storage such as Amazon S3, Azure Storage, and Google Cloud Storage. Similarly, SaaS enterprise platforms such as Office 365 and Google Workspace provide cloud-based document storage to users through services such as OneDrive and Google Drive, while SaaS application providers such as Slack, Confluence, Salesforce, and Dropbox may provide cloud storage solutions as a peripheral or primary use case of their platform.   In some cases, as with IaaS-based cloud storage, there exists no overarching application (such as SQL or Elasticsearch) with which to interact with the stored objects: instead, data from these solutions is retrieved directly though the [Cloud API] In SaaS applications, adversaries may be able to collect this data directly from APIs or backend cloud storage objects, rather than through their front-end application or interface (i.e., [Data from Information Repositories]   Adversaries may collect sensitive data from these cloud storage solutions. Providers typically offer security guides to help end users configure systems, though misconfigurations are a common problem. There have been numerous incidents where cloud storage has been improperly secured, typically by unintentionally allowing public access to unauthenticated users, overly-broad access by all users, or even access for any anonymous person outside the control of the Identity Access Management system without even needing basic user permissions.  This open access may expose various types of sensitive data, such as credit cards, personally identifiable information, or medical records.  Adversaries may also obtain then abuse leaked credentials from source repositories, logs, or other means as a way to gain access to cloud storage objects.","[""[Fox Kitten] has obtained files from the victim's cloud storage instances."", '[Peirates] can dump the contents of AWS S3 buckets. It can also retrieve service account tokens from kOps buckets in Google Cloud Storage or S3.', '[Pacu] can enumerate and download files stored in AWS storage services, such as S3 buckets.', 'During [C0027] [Scattered Spider] accessed victim OneDrive environments to search for VPN and MFA enrollment information, help desk instructions, and new hire guides.', 'AADInternals can collect files from a user’s OneDrive.']"
T1135,Network Share Discovery,"Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement. Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network.   File sharing over a Windows network occurs over the SMB protocol.   [Net] can be used to query a remote system for available shared drives using the <code>net view \\\\remotesystem</code> command. It can also be used to query shared drives on the local system using <code>net share</code>. For macOS, the <code>sharing -l</code> command lists all shared points used for smb services.","[""[BADHATCH] can check a user's access to the C$ share on a compromised machine. "", '[Ramsay] can scan for network drives which may contain documents for collection.\t', 'During [C0015] the threat actors executed the PowerView ShareFinder module to identify open shares.', '[Conti] can enumerate remote open SMB network shares using <code>NetShareEnum()</code>.', '[Tonto Team] has used tools such as [NBTscan] to enumerate network shares.', '[Pupy] can list local and remote shared drives and folders over SMB.', '[Bazar] can enumerate shared drives on the domain.', '[Cuba] can discover shared resources using the <code>NetShareEnum</code> API call. ', '[Kwampirs] collects a list of network shares with the command <code>net share</code>.', '[QakBot] can use <code>net share</code> to identify network shares for use in lateral movement.', '[APT39] has used the post exploitation tool [CrackMapExec] to enumerate network shares.', '[SILENTTRINITY] can enumerate shares on a compromised host.', '[Diavol] has a `ENMDSKS` command to enumerates available network shares. ', '[DarkVishnya] scanned the network for public shared folders.', 'The <code>net view \\\\remotesystem</code> and <code>net share</code> commands in [Net] can be used to find shared drives and directories on remote and local systems respectively.', '[APT32] used the <code>net view</code> command to show all shares available, including the administrative shares such as <code>C$</code> and <code>ADMIN$</code>.', '[FIVEHANDS] can enumerate network shares and mounted drives on a network.', '[Emotet] has enumerated non-hidden network shares using `WNetEnumResourceW`. ', ' [APT41] used the <code>net share</code> command as part of network reconnaissance.', '[Sardonic] has the ability to execute the `net view` command.', '[PlugX] has a module to enumerate network shares.', '[CrackMapExec] can enumerate the shared folders and associated permissions for a targeted network.', '[BitPaymer] can search for network shares on the domain or workgroup using <code>net view <host></code>.', '[Empire] can find shared drives on the local system.', '[Chimera] has used <code>net share</code> and <code>net view</code> to identify network shares of interest.', '[Bad Rabbit] enumerates open SMB shares on internal victim networks.', '[TrickBot] module shareDll/mshareDll discovers network shares via the WNetOpenEnumA API.', 'During [Operation Wocao] threat actors discovered network disks mounted to the system using [netstat]', '[KOPILUWAK] can use [netstat] and [Net] to discover network shares.', '[APT38] has enumerated network shares on a compromised host.', '[Royal] can enumerate the shared resources of a given IP addresses using the API call `NetShareEnum`.', '[WhisperGate] can enumerate connected remote logical drives.', '[HELLOKITTY] has the ability to enumerate network resources.', '[Clambling] has the ability to enumerate network shares.', '[BlackCat] has the ability to discover network shares on compromised networks.', '[Cobalt Strike] can query shared drives on the local system.', '[Avaddon] has enumerated shared folders and mapped volumes.', '[Flagpro] has been used to execute `net view` to discover mapped network shares.', '[Clop] can enumerate network shares.', '[Babuk] has the ability to enumerate network shares.', '[FIN13] has executed net view commands for enumeration of open shares on compromised machines.', '[Tropic Trooper] used <code>netview</code> to scan target systems for shared resources.', '[WastedLocker] can identify network adjacent and accessible drives.', '[Olympic Destroyer] will attempt to enumerate mapped network shares to later attempt to wipe all files on those shares.', '[Sowbug] listed remote shared drives that were accessible from a victim.', '[MURKYTOP] has the capability to retrieve information about shares on remote hosts.', '[OSInfo] discovers shares on the network', '[Stuxnet] enumerates the directories of a network resource.', '[ShimRat] can enumerate connected drives for infected host machines.', '[Dragonfly] has identified and browsed file servers in the victim network, sometimes , viewing files pertaining to ICS or Supervisory Control and Data Acquisition (SCADA) systems.', '[AvosLocker] has enumerated shared drives on a compromised network.', 'During [Operation CuckooBees] the threat actors used the `net share` command as part of their advanced reconnaissance.', '[APT1] listed connected network shares.', '[InvisiMole] can gather network share information.', '[Zebrocy] identifies network drives when they are added to victim systems.', '[Wizard Spider] has used the “net view” command to locate mapped network shares.', '[Koadic] can scan local network for open SMB.', '[DEATHRANSOM] has the ability to use loop operations to enumerate network resources.', '[QuietSieve] can identify and search networked drives for specific file name extensions.', '[Operation Wocao] has discovered network disks mounted to the system using netstat.', '[Dragonfly 2.0] identified and browsed file servers in the victim network, sometimes , viewing files pertaining to ICS or Supervisory Control and Data Acquisition (SCADA) systems.', '[Cobalt Strike] can query shared drives on the local system.', 'Dragonfly identified and browsed file servers on the victim network, viewing files pertaining to ICS or Supervisory Control and Data Acquisition (SCADA) systems.']"
T1120,Peripheral Device Discovery,"Adversaries may attempt to gather information about attached peripheral devices and components connected to a computer system. Peripheral devices could include auxiliary resources that support a variety of functionalities such as keyboards, printers, cameras, smart card readers, or removable storage. The information may be used to enhance their awareness of the system and network environment or may be used for further actions.","['[Equation] has used tools with the functionality to search for specific information about the attached hard drive that could be used to identify and overwrite the firmware.', 'During [Operation CuckooBees] the threat actors used the `fsutil fsinfo drives` command as part of their advanced reconnaissance.', '[APT37] has a Bluetooth device harvester, which uses Windows Bluetooth APIs to find information on connected Bluetooth devices. ', '[jRAT] can map UPnP ports.', '[Crutch] can monitor for removable drives being plugged into the compromised machine.', 'The [FunnyDream] FilepakMonitor component can detect removable drive insertion.', '[njRAT] will attempt to detect if the victim system has a camera during the initial infection. [njRAT] can also detect any removable drives connected to the system.', '[Mongall] can identify removable media attached to compromised hosts. ', 'A module in [Prikormka] collects information on available printers and disk drives.', '[WannaCry] contains a thread that will attempt to scan for new attached drives every few seconds. If one is identified, it will encrypt the files on the attached device.', '[Zebrocy] enumerates information about connected storage devices.', '[RTM] can obtain a list of smart card readers attached to the victim.', '[ObliqueRAT] can discover pluggable/removable drives to extract files from.', '[Bandook] can detect USB devices.', '[Ramsay] can scan for removable media which may contain documents for collection.\t', '[APT28] uses a module to receive a notification every time a USB mass storage device is inserted into a victim.', '[USBferry] can check for connected USB devices.', '[MoonWind] obtains the number of removable drives from the victim.', '[DustySky] can detect connected USB devices.', '[Attor] has a plugin that collects information about inserted storage devices, modems, and phone devices.', '[SVCReady] can check for the number of devices plugged into an infected host.', '[Ferocious] can run <code>GET.WORKSPACE</code> in Microsoft Excel to check if a mouse is present.', '[BlackEnergy] can gather very specific information about attached USB devices, to include device instance ID and drive geometry.', '[Turla] has used <code>fsutil fsinfo drives</code> to list connected drives.', '[OilRig] has used tools to identify if a mouse is connected to a targeted system.', '[Crimson] has the ability to discover pluggable/removable drives to extract files from.', '[Stuxnet] enumerates removable drives for infection.', '[FlawedAmmyy] will attempt to detect if a usable smart card is current inserted into a card reader.', '[ADVSTORESHELL] can list connected devices.', '[WastedLocker] can enumerate removable drives prior to the encryption process.', '[QuietSieve] can identify and search removable drives for specific file name extensions.', '[QakBot] can identify peripheral devices on targeted systems.', 'During [Operation Wocao] threat actors discovered removable disks attached to a system.', '[Machete] detects the insertion of new devices by listening for the WM_DEVICECHANGE window message.  ', '[TeamTNT] has searched for attached VGA devices using lspci.', '[NightClub] has the ability to monitor removable drives.', '[Gamaredon Group] tools have contained an application to check performance of USB flash drives. [Gamaredon Group] has also used malware to scan for removable drives.', '[BackdoorDiplomacy] has used an executable to detect removable media, such as USB flash drives.', ""[Heyoka Backdoor] can identify removable media attached to victim's machines."", '[Cadelspy] has the ability to steal information about printers and the documents sent to printers.', '[Ragnar Locker] may attempt to connect to removable drives and mapped network drives.', '[T9000] searches through connected drives for removable storage devices.', '[TajMahal] has the ability to identify connected Apple devices.', '[SharpDisco] has dropped a plugin to monitor external drives to `C:\\Users\\Public\\It3.exe`.', '[Turian] can scan for removable media to collect data.', '[USBStealer] monitors victims for insertion of removable drives. When dropped onto a second victim, it also enumerates drives connected to the system.', '[BADNEWS] checks for new hard drives on the victim, such as USB devices, by listening for the WM_DEVICECHANGE window message.', '[DarkWatchman] can list signed PnP drivers for smartcard readers.', '[Operation Wocao] has discovered removable disks attached to a system.', '[XAgentOSX] contains the showBackupIosFolder function to check for IOS device backups by running <code>ls -la ~/Library/Application\\ Support/MobileSync/Backup/</code>.']"
T1082,System Information Discovery,"An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from [System Information Discovery] during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.  Tools such as [Systeminfo] can be used to gather detailed system information. If running with privileged access, a breakdown of system data can be gathered through the <code>systemsetup</code> configuration tool on macOS. As an example, adversaries with user-level access can execute the <code>df -aH</code> command to obtain currently mounted disks and associated freely available space. Adversaries may also leverage a [Network Device CLI] on network devices to gather detailed system information (e.g. <code>show version</code>). [System Information Discovery] combined with information gathered from other forms of discovery and reconnaissance can drive payload development and concealment.  Infrastructure as a Service (IaaS) cloud providers such as AWS, GCP, and Azure allow access to instance and virtual machine information via APIs. Successful authenticated API calls can return data such as the operating system platform and status of a particular instance or the model view of a virtual machine.","['[Micropsia] gathers the hostname and OS version from the victim’s machine.', '[njRAT] enumerates the victim operating system and computer name during the initial infection.', '[TrickBot] gathers the OS version, machine name, CPU type, amount of RAM available, and UEFI/BIOS firmware information from the victim’s machine.', '[MoleNet] can collect information about the about the system.', '[YAHOYAH] checks for the system’s Windows OS version and hostname.', '[SYSCON] has the ability to use [Systeminfo] to identify system information.', '[Unknown Logger] can obtain information about the victim computer name, physical memory, country, and date.', '[Bumblebee] can enumerate the OS version and domain on a targeted system.', '[GravityRAT] collects the MAC address, computer name, and CPU information.', '[Linfo] creates a backdoor through which remote attackers can retrieve system information.', '[Koadic] can obtain the OS version and build, computer name, and processor architecture from a compromised host.', '[EnvyScout] can determine whether the ISO payload was received by a Windows or iOS device.', '[CharmPower] can enumerate the OS version and computer name on a targeted system.', '[Cuba] can enumerate local drives, disk type, and disk free space.', '[Stuxnet] collects system information including computer and domain names, OS version, and S7P paths.', '[Windigo] has used a script to detect which Linux distribution and version is currently installed on the system.', '[PLAINTEE] collects general system enumeration data about the infected machine and checks the OS version.', '[ADVSTORESHELL] can run [Systeminfo] to gather information about the victim.', '[SpeakUp] uses the <code>cat /proc/cpuinfo | grep -c “cpu family” 2>&1</code> command to gather system information. ', '[CARROTBAT] has the ability to determine the operating system of the compromised host and whether Windows is being run with x86 or x64 architecture.', '[Torisma] can use `GetlogicalDrives` to get a bitmask of all drives available on a compromised system. It can also use `GetDriveType` to determine if a new drive is a CD-ROM drive.', '[KeyBoy] can gather extended system information, such as information about the operating system, disks, and memory.', '[OilRig] has run <code>hostname</code> and <code>systeminfo</code> on a victim.\t', '[Maze] has checked the language of the infected system using the ""GetUSerDefaultUILanguage"" function.', '[Rifdoor] has the ability to identify the Windows version on the compromised host.', ""[FlawedAmmyy] can collect the victim's operating system and computer name during the initial infection."", '[ZIRCONIUM] has used a tool to capture the processor architecture of a compromised host in order to register it with C2.', '[Black Basta] can enumerate volumes and collect system boot configuration and CPU information.', '[Brave Prince] collects hard drive content and system configuration information.', '[Squirrelwaffle] has gathered victim computer information and configurations.', '[More_eggs] has the capability to gather the OS version and computer name.', 'During [C0017] [APT41] issued `ping -n 1 ((cmd /c dir c:\\|findstr Number).split()[-1]+` commands to find the volume serial number of compromised systems. ', '[BlackMould] can enumerate local drives on a compromised host.', '[BLINDINGCAN] has collected from a victim machine the system name, processor information, OS version, and disk information, including type and free space available.', '[STARWHALE] can gather the computer name of an infected host.', '[SLOWDRIFT] collects and sends system information to its C2.', '[Sardonic] has the ability to collect the computer name, CPU manufacturer name, and C:\\ drive serial number from a compromised machine. [Sardonic] also has the ability to execute the `ver` and `systeminfo` commands.', '[Bundlore] will enumerate the macOS version to determine which follow-on behaviors to execute using <code>/usr/bin/sw_vers -productVersion</code>.', '[LiteDuke] can enumerate the CPUID and BIOS version on a compromised system.', '[Elise] executes <code>systeminfo</code> after initial communication is made to the remote server.', '[SUNBURST] collected hostname, OS version, and device uptime.', '[GoldenSpy] has gathered operating system information.\t', '[down_new] has the ability to identify the system volume information of a compromised host.', '[MacMa] can collect information about a compromised computer, including: Hardware UUID, Mac serial number, macOS version, and disk sizes.', 'A system info module in [CozyCar] gathers information on the victim host’s configuration.', 'During its initial execution, [BACKSPACE] extracts operating system information from the infected host.', '[ZxxZ] has collected the host name and operating system product name from a compromised machine. ', '[KONNI] can gather the OS version, architecture information, connected drives, hostname, RAM size, and disk space information from the victim’s machine and has used <code>cmd /c systeminfo</code> command to get a snapshot of the current system state of the target machine.', '[PowerShower] has collected system information on the infected host.', '[TajMahal] has the ability to identify hardware information, the computer name, and OS information on an infected host.', ""During [Frankenstein] the threat actors used [Empire] to obtain the compromised machine's name."", ""[Dtrack] can collect the victim's computer name, hostname and adapter information to create a unique identifier."", ""[Blue Mockingbird] has collected hardware details for the victim's system, including CPU and memory information."", '[Netwalker] can determine the system architecture it is running on to choose which version of the DLL to use.', '[BLUELIGHT] has collected the computer name and OS version from victim machines.', ""[Milan] can enumerate the targeted machine's name and GUID."", '[HEXANE] has collected the hostname of a compromised machine.', ""[PowerDuke] has commands to get information about the victim's name, build, version, serial number, and memory usage."", 'During [Operation CuckooBees] the threat actors used the `systeminfo` command to gather details about a compromised system.', '[ZxShell] can collect the local hostname, operating system details, CPU speed, and total physical memory. ', ' [Royal] can use `GetNativeSystemInfo` and `GetLogicalDrives` to enumerate system processors and logical drives.', '[Shark] can collect the GUID of a targeted machine.', '[Nebulae] can discover logical drive information including the drive type, free space, and volume information.', '[KillDisk] retrieves the hard disk name by calling the <code>CreateFileA to \\\\.\\PHYSICALDRIVE0</code> API.', '[MURKYTOP] has the capability to retrieve information about the OS.', '[Anchor] can determine the hostname and linux version on a compromised host.', '[Orz] can gather the victim OS version and whether it is 64 or 32 bit.', '[PipeMon] can collect and send OS version and computer name as a part of its C2 beacon.', ""[Shamoon] obtains the victim's operating system version and keyboard layout and sends the information to the C2 server."", '[4H RAT] sends an OS version identifier in its beacons.', '[Denis] collects OS information and the computer name from the victim’s machine.', '[Astaroth] collects the machine name and keyboard language from the system. ', '[Kevin] can enumerate the OS version and hostname of a targeted machine.', '[Darkhotel] has collected the hostname, OS version, service pack version, and the processor architecture from the victim’s machine.', '[BADHATCH] can obtain current system information from a compromised machine such as the `SHELL PID`, `PSVERSION`, `HOSTNAME`, `LOGONSERVER`, `LASTBOOTUP`, `UPTIME`, drive information, OS type/version, bitness, and hostname. ', '[WinMM] collects the system name, OS version including service pack, and system install date and sends the information to the C2 server.', ""[DEADEYE] can enumerate a victim computer's volume serial number and host name."", '[TA2541] has collected system information prior to downloading malware on the targeted host.', '[Woody RAT] can retrieve the following information from an infected machine: OS, architecture, computer name, OS build version, environment variables, and storage drives.', '[MiniDuke] can gather the hostname on a compromised machine.', '[FIN13] has collected local host information by utilizing Windows commands `systeminfo`, `fsutil`, and `fsinfo`. [FIN13] has also utilized a compromised Symantex Altiris console and LanDesk account to retrieve host information.', '[ZLib] has the ability to enumerate system information.', ""[Rocke] has used uname -m to collect the name and information about the infected system's kernel."", '[InnaputRAT] gathers volume drive information and system information.', '[Bonadan] has discovered the OS version, CPU model, and RAM size of the system it has been installed on.', '[Cyclops Blink] has the ability to query device information.', ""[Volgmer] can gather system information, the computer name, OS version, drive and serial information from the victim's machine."", ""A [Gamaredon Group] file stealer can gather the victim's computer name and drive serial numbers to send to a C2 server."", '[WarzoneRAT] can collect compromised host information, including OS version, PC name, RAM size, and CPU details.', '[DownPaper] collects the victim host name and serial number, and then sends the information to the C2 server.', '[Empire] can enumerate host system information like OS, architecture, domain name, applied patches, and more.', '[BlackCat] can obtain the computer name and UUID, and enumerate local drives.', '[HAWKBALL] can collect the OS version, architecture information, and computer name.', '[SynAck] gathers computer names, OS version info, and also checks installed keyboard layouts to estimate if it has been launched from a certain list of countries.', '[APT37] collects the computer name, the BIOS model, and execution path.', ""[EVILNUM] can obtain the computer name from the victim's system."", '[SHUTTERSPEED] can collect system information.', '[KOMPROGO] is capable of retrieving information about the infected system.', ""[APT32] has collected the OS version and computer name from victims. One of the group's backdoors can also query the Windows Registry to gather system information, and another macOS backdoor performs a fingerprint of the machine on its first connection to the C&C server. [APT32] executed shellcode to identify the name of the infected host."", '[AsyncRAT] can check the disk size through the values obtained with `DeviceInfo.`', '[SpicyOmelette] can identify the system name of a compromised host.', '[MirageFox] can collect CPU and architecture information from the victim’s machine.', '[QuasarRAT] can gather system information from the victim’s machine including the OS type.', '[T9000] gathers and beacons the operating system build number and CPU Architecture (32-bit/64-bit) during installation.', '[DarkTortilla] can obtain system information by querying the `Win32_ComputerSystem`, `Win32_BIOS`, `Win32_MotherboardDevice`, `Win32_PnPEntity`, and `Win32_DiskDrive` WMI objects.', '[Green Lambert] can use `uname` to identify the operating system name, version, and processor type.  ', ""[Kasidet] has the ability to obtain a victim's system name and operating system version."", '[Emissary] has the capability to execute ver and systeminfo commands.', '[SMOKEDHAM] has used the <code>systeminfo</code> command on a compromised host.', '[Inception] has used a reconnaissance module to gather information about the operating system and hardware on the infected host.', '[FELIXROOT] collects the victim’s computer name, processor architecture, OS version, volume serial number, and system type.', '[Hydraq] creates a backdoor through which remote attackers can retrieve information such as computer name, OS version, processor speed, memory size, and CPU speed.', '[Crimson] contains a command to collect the victim PC name, disk drive information, and operating system.', '[PingPull] can retrieve the hostname of a compromised host.', '[jRAT] collects information about the OS (version, build type, install date) as well as system up-time upon receiving a connection from a backdoor.', '[POWERSTATS] can retrieve OS name/architecture and computer/domain name information from compromised hosts.', ""[Saint Bot] can identify the OS version, CPU, and other details from a victim's machine."", 'Several [Lazarus Group] malware families collect information on the type and version of the victim OS, as well as the victim computer name and CPU information. A Destover-like variant used by [Lazarus Group] also collects disk space information and sends it to its C2 server.', '[FatDuke] can collect the user name, Windows version, computer name, and available space on discs from a compromised host.', '[Volt Typhoon] has discovered file system types, drive names, size, and free space on compromised systems.', '[BadPatch] collects the OS system, OS version, MAC address, and the computer name from the victim’s machine.', '[Chrommme] has the ability to list drives and obtain the computer name of a compromised host.', '[CORESHELL] collects hostname, volume serial number and OS version data from the victim and sends the information to its C2 server.', '[Moses Staff] collected information about the infected host, including the machine names and OS architecture. ', '[ThreatNeedle] can collect system profile information from a compromised host.', '[Sys10] collects the computer name, OS versioning information, and OS install date and sends the information to the C2.', '[Bankshot] gathers system information, network addresses, disk type, disk free space, and the operation system version.', '[KOCTOPUS] has checked the OS version using `wmic.exe` and the `find` command.', '[KEYMARBLE] has the capability to collect the computer name, language settings, the OS version, CPU information, disk devices, and time elapsed since system start.', '[OSX_OCEANLOTUS.D] collects processor information, memory information, computer name, hardware UUID, serial number, and operating system version. [OSX_OCEANLOTUS.D] has used the <code>ioreg</code> command to gather some of this information.', '[REvil] can identify the username, machine name, system language, keyboard layout, OS version, and system drive information on a compromised host.', '[PoshC2] contains modules, such as <code>Get-ComputerInfo</code>, for enumerating common system information.', ""[Trojan.Karagany] can capture information regarding the victim's OS, security, and hardware configuration."", '[Rising Sun] can detect the computer name, operating system, and drive information, including drive type, total number of bytes on disk, total number of free bytes on disk, and name of a specified volume.\t', '[SOUNDBITE] is capable of gathering system information.', '[Derusbi] gathers the name of the local host, version of GNU Compiler Collection (GCC), and the system information about the CPU, machine, and operating system.', '[FALLCHILL] can collect operating system (OS) version information, processor information, system name, and information about installed disks from the victim.', '[WellMess] can identify the computer name of a compromised host.', ""[Ixeshe] collects the computer name of the victim's system during the initial infection."", '[zwShell] can obtain the victim PC name and OS version.', '[ServHelper] will attempt to enumerate Windows version and system architecture.', '[Aria-body] has the ability to identify the hostname, computer name, Windows version, processor speed, machine GUID, and disk information on a compromised host.', '[Zebrocy] collects the OS version, computer name and serial number for the storage volume C:\\. [Zebrocy] also runs the <code>systeminfo</code> command to gather system information. ', '[DarkComet] can collect the computer name, RAM used, and operating system version from the victim’s machine.', '[BADFLICK] has captured victim computer name, memory space, and CPU details.', '[Higaisa] collected the system volume serial number, GUID, and computer name.', '[Epic] collects the OS version, hardware information, computer name, available system memory status, disk space information, and system and user language settings.', ""[GRIFFON] has used a reconnaissance module that can be used to retrieve information about a victim's computer, including the resolution of the workstation ."", '[Revenge RAT] collects the CPU information, OS information, and system language.', 'can collect system information, including computer name, system manufacturer, IsDebuggerPresent state, and execution path.', '[Grandoreiro] can collect the computer name and OS version from a compromised host.', '[Heyoka Backdoor] can enumerate drives on a compromised host.', '[SodaMaster] can enumerate the host name and OS version on a target system.', '[BISCUIT] has a command to collect the processor type, operation system, computer name, uptime, and whether the system is a laptop or PC.', '[OopsIE] checks for information on the CPU fan, temperature, mouse, hard disk, and motherboard as part of its anti-VM checks.', '[CaddyWiper] can use `DsRoleGetPrimaryDomainInformation` to determine the role of the infected machine. [CaddyWiper] can also halt execution if the compromised host is identified as a domain controller.', '[Snip3] has the ability to query `Win32_ComputerSystem` for system information.  ', '[Kessel] has collected the system architecture, OS version, and MAC address information.', '[Okrum] can collect computer name, locale information, and information about the OS and architecture.', '[Skidmap] has the ability to check whether the infected system’s OS is Debian or RHEL/CentOS to determine which cryptocurrency miner it should use.', '[AppleJeus] has collected the victim host information after infection.', '[Naid] collects a unique identifier (UID) from a compromised host.', '[LightNeuron] gathers the victim computer name using the Win32 API call <code>GetComputerName</code>.', '[macOS.OSAMiner] can gather the device serial number and has checked to ensure there is enough disk space using the Unix utility `df`.', '[MoonWind] can obtain the victim hostname, Windows version, RAM amount, number of drives, and screen resolution.', '[WINDSHIELD] can gather the victim computer name.', '[cmd] can be used to find information about the operating system.', '[OSInfo] discovers information about the infected machine.', '[Octopus] can collect system drive information, the computer name, the size of the disk, OS version, and OS architecture information.', '[SoreFang] can collect the hostname, operating system configuration, product ID, and disk space on victim machines by executing [Systeminfo]', '[Kerrdown] has the ability to determine if the compromised host is running a 32 or 64 bit OS architecture.', '[BoomBox] can enumerate the hostname, domain, and IP of a compromised host.', '[PoetRAT] has the ability to gather information about the compromised host.', '[StreamEx] has the ability to enumerate system information.', '[AppleSeed] can identify the OS version of a targeted system.', '[ObliqueRAT] has the ability to check for blocklisted computer names on infected endpoints.', '[NDiskMonitor] obtains the victim computer name and encrypts the information to send over its C2 channel.', '[MarkiRAT] can obtain the computer name from a compromised host.', 'A module in [Prikormka] collects information from the victim about Windows OS version, computer name, battery info, and physical memory.', '[HOPLIGHT] has been observed collecting victim machine information like OS version, volume information, and more.', '[PinchDuke] gathers system configuration information.', '[Valak] can determine the Windows version and computer name on a compromised host.', ""[ZeroT] gathers the victim's computer name, Windows version, and system language, and then sends it to its C2 server."", '[Pupy] can grab a system’s information including the OS version, architecture, etc.', '[Spark] can collect the hostname, keyboard layout, and language from the system. ', 'The initial beacon packet for [S-Type] contains the operating system version and file system of the victim.', ""[Hildegard] has collected the host's OS, CPU, and memory information."", '[Confucius] has used a file stealer that can examine system drives, including those other than the C drive.', '[Ramsay] can detect system information--including disk names, total space, and remaining space--to create a hardware profile GUID which acts as a system identifier for operators.\t', '[Fysbis] has used the command <code>ls /etc | egrep -e""fedora\\*|debian\\*|gentoo\\*|mandriva\\*|mandrake\\*|meego\\*|redhat\\*|lsb-\\*|sun-\\*|SUSE\\*|release""</code> to determine which Linux OS version is running.', '[Final1stspy] obtains victim Microsoft Windows version information and CPU architecture.', '[SDBbot] has the ability to identify the OS version, OS bit information and computer name.', '[Pay2Key] has the ability to gather the hostname of the victim machine.', '[Gelsemium] can determine the operating system and whether a targeted machine has a 32 or 64 bit architecture.', '[APT38] has attempted to get detailed information about a compromised host, including the operating system, version, patches, hotfixes, and service packs.', '[KARAE] can collect system information.', ""[BackConfig] has the ability to gather the victim's computer name."", '[HermeticWiper] can determine the OS version, bitness, and enumerate physical drives on a targeted host.', 'The initial beacon packet for [Misdat] contains the operating system version of the victim.', '[RotaJakiro] executes a set of commands to collect device information, including `uname`.  Another example is the `cat /etc/*release | uniq` command used to collect the current OS distribution.', '[Mustang Panda] has gathered system information using <code>systeminfo</code>.', '[BADCALL] collects the computer name and host name on the compromised system.', '[OceanSalt] can collect the computer name from the system.', ""[SysUpdate] can collect a system's architecture, operating system version, hostname, and drive information."", '[NavRAT] uses <code>systeminfo</code> on a victim’s machine.', '[Metamorfo] has collected the hostname and operating system version from the compromised host.', '[Clambling] can discover the hostname, computer name, and Windows version of a targeted machine.', 'During [Operation Honeybee] the threat actors collected the computer name, OS, and other system information using `cmd /c systeminfo > %temp%\\ temp.ini`.', '[Kazuar] gathers information on the system and local drives.', '[Pony] has collected the Service Pack, language, and region information to send to the C2.\t', '[UPPERCUT] has the capability to gather the system’s hostname and OS version.', '[Winnti for Windows] can determine if the OS on a compromised host is newer than Windows XP.', '[BabyShark] has executed the <code>ver</code> command.\t', '[InvisiMole] can gather information on the mapped drives, OS version, computer name, DEP policy, memory size, and system volume serial number.', '[Mafalda] can collect the computer name and enumerate all drives on a compromised host.', '[StoneDrill] has the capability to discover the system OS, Windows version, architecture and environment.\t', '[Proxysvc] collects the OS version, country name, MAC address, computer name, physical memory statistics, and volume information for all drives on the system.', '[Kimsuky] has enumerated drives, OS type, OS version, and other information using a script or the ""systeminfo"" command.', '[AuTo Stealer] has the ability to collect the hostname and OS information from an infected host.', '[HELLOKITTY] can enumerate logical drives on a target system.', '[Remsec] can obtain the OS version information, computer name, processor architecture, machine role, and OS edition.', '[StrifeWater] can collect the OS version, architecture, and machine name to create a unique token for the infected host.', '[Get2] has the ability to identify the computer name and Windows version of an infected host.', '[MuddyWater] has used malware that can collect the victim’s OS version and machine name.', '[Ryuk] has called <code>GetLogicalDrives</code> to emumerate all mounted drives, and <code>GetDriveTypeW</code> to determine the drive type.', '[OSX/Shlayer] has collected the IOPlatformUUID, session UID, and the OS version using the command <code>sw_vers -productVersion</code>.', '[Dridex] has collected the computer name and OS architecture information from the system.', '[LoudMiner] has monitored CPU usage.\t', '[SharpStage] has checked the system settings to see if Arabic is the configured language.', '[TURNEDUP] is capable of gathering system information.', '[Felismus] collects the system information, including hostname and OS version, and sends it to the C2 server.', '[MobileOrder] has a command to upload to its C2 server victim mobile device information, including IMEI, IMSI, SIM card serial number, phone number, Android version, and other information.', '[ChChes] collects the victim hostname, window resolution, and Microsoft Windows version.', '[Uroburos] has the ability to gather basic system information and run the POSIX API `gethostbyname`.', '[TeamTNT] has searched for system version, architecture, disk partition, logical volume, and hostname information.', '[Amadey] has collected the computer name and OS version from a compromised machine.', '[StrongPity] can identify the hard disk volume serial number on a compromised host.', '[build_downer] has the ability to send system volume information to C2.', '[POWRUNER] may collect information about the system by running <code>hostname</code> and <code>systeminfo</code> on a victim.', '[Kwampirs] collects OS version information such as registered owner details, manufacturer details, processor type, available storage, installed patches, hostname, version info, system date, and other system information by using the commands <code>systeminfo</code>, <code>net config workstation</code>, <code>hostname</code>, <code>ver</code>, <code>set</code>, and <code>date /t</code>.', '[RedLeaves] can gather extended system information including the hostname, OS version number, platform, memory information, time elapsed since system startup, and CPU information.', '[Lokibot] has the ability to discover the computer name and Windows product name/version.', '[Lizar] can collect the computer name from the machine,. ', '[yty] gathers the computer name, the serial number of the main disk volume, CPU information, Microsoft Windows version, and runs the command <code>systeminfo</code>.', '[JPIN] can obtain system information such as OS version and disk space.', '[Lucifer] can collect the computer name, system architecture, default language, and processor frequency of a compromised host.', 'The initial beacon packet for [Mis-Type] contains the operating system version and file system of the victim.', '[gh0st RAT] has gathered system architecture, processor, OS configuration, and installed hardware information.', '[APT3] has a tool that can obtain information about the local system.', 'During the [SolarWinds Compromise] [APT29] used `fsutil` to check available free space before executing actions that might create large files on disk.', '[RunningRAT] gathers the OS version, logical drives information, processor information, and volume information.', '[Comnie] collects the hostname of the victim machine.', '[Sidewinder] has used tools to collect the computer name, OS version, installed hotfixes, as well as information regarding the memory and processor on a compromised host.', '[KOPILUWAK] can discover logical drive information on compromised hosts.', '[Bandook] can collect information about the drives available on the system. ', ""[Agent Tesla] can collect the system's computer name and also has the capability to collect information on the processor, memory, OS, and video card from the system."", '[WhisperGate] has the ability to enumerate fixed logical drives on a targeted system.', '[Magic Hound] malware has used a PowerShell command to check the victim system architecture to determine if it is an x64 machine. Other malware has obtained the OS version, UUID, and computer/host name to send to the C2 server.', '[Caterpillar WebShell] has a module to gather information from the compromrised asset, including the computer version, computer name, IIS version, and more. ', '[Ursnif] has used [Systeminfo] to gather system information.', 'During [Operation Wocao] threat actors discovered the local disks attached to the system and their hardware information including manufacturer and model, as well as the OS versions of systems connected to a targeted network.', '[Zox] can enumerate attached drives.', '[SVCReady] has the ability to collect information such as computer name, computer manufacturer, BIOS, operating system, and firmware, including through the use of `systeminfo.exe`.', '[DustySky] extracts basic information about the operating system.', '[Explosive] has collected the computer name from the infected host. ', '[Systeminfo] can be used to gather information about the operating system.', '[Neoichor] can collect the OS version and computer name from a compromised host.', '[SharpDisco] can use a plugin to enumerate system drives.', '[Gold Dragon] collects endpoint information using the <code>systeminfo</code> command.', '[Dyre] has the ability to identify the computer name, OS version, and hardware configuration on a compromised host.', '[SideCopy] has identified the OS version of a compromised host.', '[Chimera] has used `fsutil fsinfo drives`, `systeminfo`, and `vssadmin list shadows` for system information including shadow volumes and drive information.', '[Meteor] has the ability to discover the hostname of a compromised host.', '[APT19] collected system architecture information. [APT19] used an HTTP malware variant and a Port 22 malware variant to gather the hostname and CPU information from the victim’s machine.', '[CrackMapExec] can enumerate the system drives and associated system name.', '[APT18] can collect system information from the victim’s machine.', '[Pasam] creates a backdoor through which remote attackers can retrieve information such as hostname and free disk space.', '[Cardinal RAT] can collect the hostname, Microsoft Windows version, and processor architecture from a victim machine.', '[Ferocious] can use <code>GET.WORKSPACE</code> in Microsoft Excel to determine the OS version of the compromised host.', '[ShimRatReporter] gathered the operating system name and specific Windows version of an infected machine.', '[RTM] can obtain the computer name, OS version, and default language identifier.', '[Action RAT] has the ability to collect the hostname, OS version, and OS architecture of an infected host.', '[FIN8] has used PowerShell Scripts to check the architecture of a compromised machine before the selection of a 32-bit or 64-bit version of a malicious .NET loader.', 'The [IceApple] Server Variable Dumper module iterates over all server variables present for the current request and returns them to the adversary.', '[XCSSET] identifies the macOS version and uses <code>ioreg</code> to determine serial number.', '[Diavol] can collect the computer name and OS version from the system.', '[Tropic Trooper] has detected a target system’s OS version and system volume information.', '[Bisonal] has used commands and API calls to gather system information.', '[Aquatic Panda] has used native OS commands to understand privilege levels and system details.', '[ROKRAT] can gather the hostname and the OS version to ensure it doesn’t run on a Windows XP or Windows Server 2003 systems.', '[Industroyer] collects the victim machine’s Windows GUID.', '[TYPEFRAME] can gather the disk volume information.', '[ShadowPad] has discovered system information including memory status, CPU frequency, OS versions, and volume serial numbers.', '[Mongall] can identify drives on compromised hosts and retrieve the hostname via `gethostbyname`. ', '[QakBot] can collect system information including the OS version and domain on a compromised host.', '[HALFBAKED] can obtain information about the OS, processor, and BIOS.', '[SideTwist] can collect the computer name of a targeted system.', '[RCSession] can gather system information from a compromised host.', '[Cadelspy] has the ability to discover information about the compromised host.', '[Machete] collects the hostname of the target computer. ', '[RogueRobin] gathers BIOS versions and manufacturers, the number of CPU cores, the total physical memory, and the computer name.', '[Turian] can retrieve system information including OS version, memory usage, local hostname, and system adapter information.', '[Zeus Panda] collects the OS version, system architecture, computer name, product ID, install date, and information on the keyboard mapping to determine the language used on the system.', '[Carberp] has collected the operating system version from the infected system.', '[FinFisher] checks if the victim OS is 32 or 64-bit.', '[KGH_SPY] can collect drive information from a compromised host.', '[SHARPSTATS] has the ability to identify the IP address, machine name, and OS of the compromised host.', '[Babuk] can enumerate disk volumes, get disk information, and query service status.', ""[DropBook] has checked for the presence of Arabic language in the infected machine's settings. "", '[JHUHUGIT] obtains a build identifier as well as victim hard drive information from Windows registry key <code>HKLM\\SYSTEM\\CurrentControlSet\\Services\\Disk\\Enum</code>. Another [JHUHUGIT] variant gathers the victim storage volume serial number and the storage device name.', '[TAINTEDSCRIBE] can use <code>DriveList</code> to retrieve drive information.', '[Sowbug] obtained OS version and hardware configuration from a victim.', ""[Wizard Spider] has used [Systeminfo] and similar commands to acquire detailed configuration information of a victim's machine. [Wizard Spider] has also utilized the PowerShell cmdlet `Get-ADComputer` to collect DNS hostnames, last logon dates, and operating system information from Active Directory."", '[Turla] surveys a system upon check-in to discover operating system configuration details using the <code>systeminfo</code> and <code>set</code> commands.', '[Penquin] can report the file system type and disk space of a compromised host to C2.', '[NETWIRE] can discover and collect victim system information.', '[HotCroissant] has the ability to determine if the current user is an administrator, Windows product name, processor name, screen resolution, and physical RAM of the infected host.', '[Azorult] can collect the machine information, system architecture, the OS version, computer name, Windows product name, the number of CPU cores, video card information, and the system language.', '[DEATHRANSOM] can enumerate logical drives on a target system.', ""[Patchwork] collected the victim computer name, OS version, and architecture type and sent the information to its C2 server. [Patchwork] also enumerated all available drives on the victim's machine."", '[Windshift] has used malware to identify the computer name of a compromised host.', '[BUBBLEWRAP] collects system information, including the operating system version and hostname.', '[VERMIN] collects the OS name, machine name, and architecture information.', '[admin@338] actors used the following commands after exploiting a machine with [LOWBALL] malware to obtain information about the OS: <code>ver >> %temp%\\download</code> <code>systeminfo >> %temp%\\download</code>', '[XAgentOSX] contains the getInstalledAPP function to run <code>ls -la /Applications</code> to gather what applications are installed.', '[NanHaiShu] can gather the victim computer name and serial number.', '[PUNCHBUGGY] can gather system information such as computer names.\t', '[DarkWatchman] can collect the OS version, system architecture, uptime, and computer name.', '[WINERACK] can gather information about the host.', '[Pisloader] has a command to collect victim system information, including the system name and OS version.', '[Reaver] collects system information from the victim, including CPU speed, computer name, volume serial number, ANSI code page, OEM code page identifier for the OS, Microsoft Windows version, and memory information.', '[Chaes] has collected system information, including the machine name and OS version.', '[GrimAgent] can collect the OS, and build version on a compromised host.', '[NOKKI] can gather information on drives and the operating system on the victim’s machine.', '[BlackEnergy] has used [Systeminfo] to gather the OS version, as well as information on the system configuration, BIOS, the motherboard, and the processor.', '[Stealth Falcon] malware gathers system information via WMI, including the system directory, build number, serial number, version, manufacturer, model, and total physical memory.', '[Kobalos] can record the hostname and kernel version of the target machine.', '[Egregor] can perform a language check of the infected system and can query the CPU information (cupid).', '[FunnyDream] can enumerate all logical drives on a targeted machine.', '[POORAIM] can identify system information, including battery status.', '[Backdoor.Oldrea] collects information about the OS and computer name.', '[IcedID] has the ability to identify the computer name and OS version on a compromised host.', '[RATANKBA] gathers information about the OS architecture, OS name, and OS version/Service pack.', '[Bazar] can fingerprint architecture, computer name, and OS version on the compromised host. [Bazar] can also check if the Russian language is installed on the infected machine and terminate if it is found.', ""[Sandworm Team] used a backdoor to enumerate information about the infected system's operating system.\t"", '[Ke3chang] performs operating system information discovery using <code>systeminfo</code> and has used implants to identify the system language and computer name.', '[SLOTHFULMEDIA] has collected system name, OS version, adapter information, memory usage, and disk information from a victim machine.', '[LitePower] has the ability to list local drives and enumerate the OS architecture.', '[Cannon] can gather system information from the victim’s machine such as the OS version, machine name, and drive information.', '[dsquery] has the ability to enumerate various information, such as the operating system and host name, for systems within a domain.', '[Attor] monitors the free disk space on the system.', '[SILENTTRINITY] can collect information related to a compromised host, including OS version and a list of drives.', '[SslMM] sends information to its hard-coded C2, including OS version, service pack information, processor speed, system name, and OS install date.', '[Avenger] has the ability to identify the host volume ID and the OS architecture on a compromised host.', '[metaMain] can collect the computer name from a compromised host.', 'During [FunnyDream] the threat actors used [Systeminfo] to collect information on targeted hosts.', '[Wingbird] checks the victim OS version after executing to determine where to drop files based on whether the victim is 32-bit or 64-bit.', '[SombRAT] can execute <code>getinfo</code> to enumerate the computer name and OS version of a compromised system.', '[APT29] used <code>fsutil</code> to check available free space before executing actions that might create large files on disk.', '[UNC2452] used <code>fsutil</code> to check available free space before executing actions that might create large files on disk.', '[Honeybee] gathers computer name and information using the <code>systeminfo</code> command.', '[Operation Wocao] has discovered the local disks attached to the system and their hardware information including manufacturer and model, as well as the OS versions of systems connected to a targeted network.', ""[Frankenstein] has enumerated hosts, looking for the system's machine name."", '[Tropic Trooper] has detected a target system’s OS version.', 'APT28 has enumerated installed applications on macOS devices with built-in utilities such as <code>ls -al /Applications</code>.']"
T1005,Data from Local System,"Adversaries may search local system sources, such as file systems and configuration files or local databases, to find files of interest and sensitive data prior to Exfiltration.  Adversaries may do this using a [Command and Scripting Interpreter] such as [cmd] as well as a [Network Device CLI] which have functionality to interact with the file system to gather information. Adversaries may also use [Automated Collection] on the local system. ","['[Kimsuky] has collected Office, PDF, and HWP documents from its victims.', '[BRONZE BUTLER] has exfiltrated files stolen from local systems.', '[Proxysvc] searches the local system and gathers data.', '[Drovorub] can transfer files from the victim machine.', '[Cryptoistic] can retrieve files from the local file system.', ""[xCaon] has uploaded files from victims' machines."", '[LAPSUS$] uploaded sensitive files, information, and credentials from a targeted organization for extortion or public release.', '[APT39] has used various tools to steal files from the compromised host.', '[QakBot] can use a variety of commands, including esentutl.exe to steal sensitive data from Internet Explorer and Microsoft Edge, to acquire information that is subsequently exfiltrated.', '[ccf32] can collect files from a compromised host.', '[Dtrack] can collect a variety of information from victim machines.', '[Bankshot] collects files from the local system.', ""When it first starts, [BADNEWS] crawls the victim's local drives and collects documents with the following extensions: .doc, .docx, .pdf, .ppt, .pptx, and .txt."", '[HAFNIUM] has collected data and files from a compromised machine.', '[SVCReady] can collect data from an infected host.', '[Rising Sun] has collected data and files from a compromised host.', '[PUNCHTRACK] scrapes memory for properly formatted payment card data.', '[China Chopper] server component can upload local files.', '[Axiom] has collected data from a compromised network.', '[Uroburos] can use its `Get` command to exfiltrate specified files from the compromised system.', '[Octopus] can exfiltrate files from the system using a documents collector tool.', '[FLASHFLOOD] searches for interesting files (either a default or customized set of file extensions) on the local system. [FLASHFLOOD] will scan the My Recent Documents, Desktop, Temporary Internet Files, and TEMP directories. [FLASHFLOOD] also collects information stored in the Windows Address Book.', '[P.A.S. Webshell] has the ability to copy files on a compromised host.', '[Cobalt Strike] can collect data from a local system.', '[Windigo] has used a script to gather credentials in files left on disk by OpenSSH backdoors.', '[GrimAgent] can collect data and files from a compromised host.', '[NightClub] can use a file monitor to steal specific files from targeted systems.', '[Nebulae] has the capability to upload collected files to C2.', '[KONNI] has stored collected information and discovered processes in a tmp file.', '[WarzoneRAT] can collect data from a compromised host.', '[PingPull] can collect data from a compromised host.', '[PowerSploit] contains a collection of Exfiltration modules that can access data from local files, volumes, and processes.', 'During [Night Dragon] the threat actors collected files and other data from compromised systems.', '[Fox Kitten] has searched local system resources to access sensitive documents.', '[Caterpillar WebShell] has a module to collect information from the local database. ', '[Andariel] has collected large numbers of files from compromised network systems for later extraction.', '[Amadey] can collect information from a compromised host.', ' [BLINDINGCAN] has uploaded files from victim machines.', '[APT1] has collected files from a local victim.', ""[GALLIUM] collected data from the victim's local system, including password hashes from the SAM hive in the Registry."", '[SombRAT] has collected data and files from a compromised host.', '[APT29] has stolen data from compromised hosts.', '[Lazarus Group] has collected data and files from compromised networks.', ""[Ramsay] can collect Microsoft Word documents from the target's file system, as well as <code>.txt</code>, <code>.doc</code>, and <code>.xls</code> files from the Internet Explorer cache.\t"", ""[MarkiRAT] can upload data from the victim's machine to the C2 server."", '[Gamaredon Group] has collected files from infected systems and uploaded them to a C2 server.', '[OutSteel] can collect information from a compromised host.', '[WellMess] can send files from the victim machine to C2.', '[FIN6] has collected and exfiltrated payment card data from compromised systems.', '[Mafalda] can collect files and information from a compromised host.', '[SysUpdate] can collect information and files from a compromised host.', '[yty] collects files with the following extensions: .ppt, .pptx, .pdf, .doc, .docx, .xls, .xlsx, .docm, .rtf, .inp, .xlsm, .csv, .odt, .pps, .vcf and sends them back to the C2 server.', '[Bumblebee] can capture and compress stolen credentials from the Registry and volume shadow copies.', '[EnvyScout] can collect sensitive NTLM material from a compromised host.', 'During [Operation Wocao] threat actors exfiltrated files and directories of interest from the targeted system.', '[Turla] RPC backdoors can upload files from victim machines.', '[Hydraq] creates a backdoor through which remote attackers can read data from files.', '[SUNBURST] collected information from a compromised host.', '[FoggyWeb] can retrieve configuration data from a compromised AD FS server.', '[Cyclops Blink] can upload files from a compromised host.', '[PowerLess] has the ability to exfiltrate data, including Chrome and Edge browser database files, from compromised machines. ', '[APT41] has uploaded files and data from a compromised host.', '[DRATzarus] can collect information from a compromised host.', 'During [C0015] the threat actors obtained files and data from the compromised network.', '[Sardonic] has the ability to collect data from a compromised machine to deliver to the attacker. ', '[BlackMould] can copy files on a compromised host.', '[MobileOrder] exfiltrates data collected from the victim mobile device.', '[ZxShell] can transfer files from a compromised host.', '[Bazar] can retrieve information from the infected machine.', '[SpicyOmelette] has collected data and other information from a compromised host.', '[SharpDisco] has dropped a recent-files stealer plugin to `C:\\Users\\Public\\WinSrcNT\\It11.exe`.', 'During [Operation Dream Job] [Lazarus Group] used malicious Trojans and DLL files to exfiltrate data from an infected host.', '[DanBot] can upload files from compromised hosts.', '[InvisiMole] can collect data from the system, and can monitor changes in specified directories.', '[Crimson] can collect information from a compromised host.', '[SLOTHFULMEDIA] has uploaded files and information from victim machines.', '[AppleSeed] can collect data on a compromised host.', '[MacMa] can collect then exfiltrate files from the compromised system.', '[LuminousMoth] has collected files and data from compromised machines.', ""[APT37] has collected data from victims' local systems."", '[Flagpro] can collect data from a compromised host, including Windows authentication information.', ""[Taidoor] can upload data and files from a victim's machine."", '[IceApple] can collect files, passwords, and other data from a compromised host.', '[Misdat] has collected files and data from a compromised host.', '[Tomiris] has the ability to collect recent files matching a hardcoded list of extensions prior to exfiltration.', '[Dragonfly] has collected data from local victim systems.', '[CURIUM] has exfiltrated data from a compromised machine.', '[Shark] can upload files to its C2.', '[Woody RAT] can collect information from a compromised host.', '[XCSSET] collects contacts and application data from files in Desktop, Documents, Downloads, Dropbox, and WeChat folders.', 'During the [SolarWinds Compromise] [APT29] extracted files from compromised networks.', '[APT28] has retrieved internal documents from machines inside victim environments, including by using [Forfiles] to stage documents before exfiltration.', '[BoxCaon] can upload files from a compromised host.', ' [Brute Ratel C4] has the ability to upload files from a compromised system.', '[AuTo Stealer] can collect data such as PowerPoint files, Word documents, Excel files, PDF files, text files, database files, and image files from an infected machine.', '[SDBbot] has the ability to access the file system on a compromised host.', '[QuasarRAT] can retrieve files from compromised client machines.', '[Ursnif] has collected files from victim machines, including certificates and cookies.', '[Rover] searches for files on local drives based on a predefined list of file extensions.', '[FrameworkPOS] can collect elements related to credit card data from process memory.', 'During [C0017] [APT41] collected information related to compromised machines as well as Personal Identifiable Information (PII) from victim networks. ', '[Calisto] can collect data from user directories.', '[TrickBot] collects local files and information from the victim’s local machine.', '[Bisonal] has collected information from a compromised host. ', '[Inception] used a file hunting plugin to collect .txt, .pdf, .xls or .doc files from the infected host.', '[PcShare] can collect files and information from a compromised host.', ""[Mongall] has the ability to upload files from victim's machines."", '[Ke3chang] gathered information and files from local directories for exfiltration.', '[Patchwork] collected and exfiltrated files from the infected system.', '[ThreatNeedle] can collect data and files from a compromised host.', ""[APT3] will identify Microsoft Office documents on the victim's computer."", '[LightNeuron] can collect files from a local system.', '[RawPOS] dumps memory from specific processes on a victim system, parses the dumped files, and scrapes them for credit card data.', '[DnsSystem] can upload files from infected machines after receiving a command with `uploaddd` in the string.', '[Forfiles] can be used to act on (ex: copy, move, etc.) files/directories in a system during (ex: copy files into a staging area before).', '[FatDuke] can copy files and directories from a compromised host.', '[Kevin] can upload logs and other data from a compromised host.', '[Wevtutil] can be used to export events from a specific log.', '[POWERSTATS] can upload files from compromised hosts.', '[SideTwist] has the ability to upload files from a compromised host.', '[Green Lambert] can collect data from a compromised host.', '[metaMain] can collect files and system information from a compromised host.', ""[Neoichor] can upload files from a victim's machine."", '[Zox] has the ability to upload files from a targeted system.', '[DarkWatchman] can collect files from a compromised host.', '[Gelsemium] can collect data from a compromised host.', '[Milan] can upload files from a compromised host.', 'During [Operation Honeybee] the threat actors collected data from compromised hosts.', ""[BADFLICK] has uploaded files from victims' machines."", '[CharmPower] can collect data and files from a compromised host.', '[Mis-Type] has collected files and data from a compromised host.', '[Out1] can copy files and Registry data from compromised hosts.', ""[Threat Group-3390] ran a command to compile an archive of file types of interest from the victim user's directories."", '[CreepyDrive] can upload files to C2 from victim machines.', '[GravityRAT] steals files with the following extensions: .docx, .doc, .pptx, .ppt, .xlsx, .xls, .rtf, and .pdf.', '[CookieMiner] has retrieved iPhone text messages from iTunes phone backup files.', '[QuietSieve] can collect files from a compromised host.', '[USBferry] can collect information from an air-gapped host machine.\t', '[TinyTurla] can upload files from a compromised host.', '[Machete] searches the File system for files of interest. ', 'During [Frankenstein] the threat actors used [Empire] to gather various local system information.', '[FIN7] has collected files and other sensitive information from a compromised network.', '[Pillowmint] has collected credit card data using native API functions.', '[Goopy] has the ability to exfiltrate documents from infected systems.\t', '[PoisonIvy] creates a backdoor through which remote attackers can steal system information.', '[MCMD] has the ability to upload files from an infected device.', 'During [CostaRicto] the threat actors collected data and files from compromised networks.', '[RCSession] can collect data from a compromised host.', ""[FunnyDream] can upload files from victims' machines."", '[Ixeshe] can collect data from a local system.', '[OSX_OCEANLOTUS.D] has the ability to upload files from a compromised host.', '[Crutch] can exfiltrate files from compromised systems.', '[Koadic] can download files off the target system to send back to the server.', '[Stealth Falcon] malware gathers data from the local victim system.', '[ROKRAT] can collect host data and specific file types.', '[APT38] has collected data from a compromised host.', '[FlawedAmmyy] has collected information and files from a compromised machine.', '[Volt Typhoon] has stolen the Active Directory database from targeted environments and used [Wevtutil] to extract event log information.', '[Linfo] creates a backdoor through which remote attackers can obtain data from local systems.', '[ShimRat] has the capability to upload collected files to a C2.\t', '[PinchDuke] collects user files from the compromised host based on predefined file extensions.', '[Chrommme] can collect data from a local system.', '[CosmicDuke] steals user files from local hard drives with file extensions that match a predefined list.', '[BadPatch] collects files from the local system that have the following extensions, then prepares them for exfiltration: .xls, .xlsx, .pdf, .mdb, .rar, .zip, .doc, .docx.', '[esentutl] can be used to collect data from local file systems.', '[Hikit] can upload files from compromised machines.', '[ZxxZ] can collect data from a compromised host.', '[menuPass] has collected various files from the compromised computers. ', '[Wizard Spider] has collected data from a compromised host prior to exfiltration.', '[Kazuar] uploads files from a specified directory to the C2 server.', '[Pasam] creates a backdoor through which remote attackers can retrieve files.', '[KGH_SPY] can send a file containing victim system information to C2.', '[Magic Hound] has used a web shell to exfiltrate a ZIP file containing a dump of LSASS memory on a compromised machine.', '[TajMahal] has the ability to steal documents from the local system including the print spooler queue.', 'During [Operation CuckooBees] the threat actors collected data, files, and other information from compromised networks.', ""[Dark Caracal] collected complete contents of the 'Pictures' folder from compromised Windows systems."", '[STARWHALE] can collect data from an infected local host.', '[KOPILUWAK] can gather information from compromised hosts.', '[Clambling] can collect information from a compromised host.', '[WellMail] can exfiltrate files from the victim machine.', '[RainyDay] can use a file exfiltration tool to collect recently changed files on a compromised host.', '[StrifeWater] can collect data from a compromised host.', '[Bandook] can collect local files from the system . ', '[Sandworm Team] has exfiltrated internal documents, files, and other data from compromised hosts.', '[Action RAT] can collect local data from an infected machine.', '[FIN13] has gathered stolen credentials, sensitive data such as point-of-sale (POS), and ATM data from a compromised network before exfiltration.', '[njRAT] can collect data from a local system.', '[Saint Bot] can collect files and information from a compromised host.', 'During [C0026] the threat actors collected documents from compromised hosts.', '[APT29] has extracted files from compromised networks. ', '[UNC2452] extracted files from compromised networks. ', '[Frankenstein] has enumerated hosts via [Empire] gathering various local system information.', '[Operation Wocao] has exfiltrated files and directories of interest from the targeted system.', '[Dust Storm] has used Android backdoors capable of exfiltrating specific files directly from the infected devices.', '[Honeybee] collects data from the local victim system.', '[Dragonfly 2.0] collected data from local victim systems.', '[Cobalt Strike] can collect data from a local system.', 'creates a backdoor through which remote attackers can steal system information.']"
T1558,Steal or Forge Kerberos Tickets,"Adversaries may attempt to subvert Kerberos authentication by stealing or forging Kerberos tickets to enable [Pass the Ticket] Kerberos is an authentication protocol widely used in modern Windows domain environments. In Kerberos environments, referred to as “realms”, there are three basic participants: client, service, and Key Distribution Center (KDC). Clients request access to a service and through the exchange of Kerberos tickets, originating from KDC, they are granted access after having successfully authenticated. The KDC is responsible for both authentication and ticket granting.  Adversaries may attempt to abuse Kerberos by stealing tickets or forging tickets to enable unauthorized access.  On Windows, the built-in <code>klist</code> utility can be used to list and analyze cached Kerberos tickets.  Linux systems on Active Directory domains store Kerberos credentials locally in the credential cache file referred to as the ""ccache"". The credentials are stored in the ccache file while they remain valid and generally while a user's session lasts. On modern Redhat Enterprise Linux systems, and derivative distributions, the System Security Services Daemon (SSSD) handles Kerberos tickets. By default SSSD maintains a copy of the ticket database that can be found in <code>/var/lib/sss/secrets/secrets.ldb</code> as well as the corresponding key located in <code>/var/lib/sss/secrets/.secrets.mkey</code>. Both files require root access to read. If an adversary is able to access the database and key, the credential cache Kerberos blob can be extracted and converted into a usable Kerberos ccache file that adversaries may use for [Pass the Ticket] The ccache file may also be converted into a Windows format using tools such as Kekeo.   Kerberos tickets on macOS are stored in a standard ccache format, similar to Linux. By default, access to these ccache entries is federated through the KCM daemon process via the Mach RPC protocol, which uses the caller's environment to determine access. The storage location for these ccache entries is influenced by the <code>/etc/krb5.conf</code> configuration file and the <code>KRB5CCNAME</code> environment variable which can specify to save them to disk or keep them protected via the KCM daemon. Users can interact with ticket storage using <code>kinit</code>, <code>klist</code>, <code>ktutil</code>, and <code>kcc</code> built-in binaries or via Apple's native Kerberos framework. Adversaries can use open source tools to interact with the ccache files directly or to use the Kerberos framework to call lower-level APIs for extracting the user's TGT or Service Tickets. ",[]
T1555,Credentials from Password Stores,"Adversaries may search for common password storage locations to obtain user credentials. Passwords are stored in several places on a system, depending on the operating system or application holding the credentials. There are also specific applications and services that store passwords to make them easier for users to manage and maintain, such as password managers and cloud secrets vaults. Once credentials are obtained, they can be used to perform lateral movement and access restricted information.","['[HEXANE] has run `cmdkey` on victim machines to identify stored credentials.', '[Carberp] passw.plug plugin can gather account information from multiple instant messaging, email, and social media services, as well as FTP, VNC, and VPN clients.', '[Mimikatz] performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from the credential vault and DPAPI.\t', '[Lokibot] has stolen credentials from multiple applications and data sources including Windows OS credentials, email clients, FTP, and SFTP clients.', '[Volt Typhoon] has attempted to obtain credentials from OpenSSH, realvnc, and PuTTY.', '[Leafminer] used several tools for retrieving login and password information, including LaZagne.', '[Matryoshka] is capable of stealing Outlook passwords.', '[Stealth Falcon] malware gathers passwords from multiple sources, including Windows Credential Vault and Outlook.', '[CosmicDuke] collects user credentials, including passwords, for various programs including popular instant messaging applications and email clients as well as WLAN keys.', 'A module in [Prikormka] collects passwords stored in applications installed on the victim.', '[PLEAD] has the ability to steal saved passwords from Microsoft Outlook.', '[APT39] has used the Smartftp Password Decryptor tool to decrypt FTP passwords.', '[Evilnum] can collect email credentials from victims.', '[NETWIRE] can retrieve passwords from messaging and mail client applications.', '[APT33] has used a variety of publicly available tools like [LaZagne] to gather credentials.', '[MuddyWater] has performed credential dumping with [LaZagne] and other tools, including by dumping passwords saved in victim email.', '[QuasarRAT] can obtain passwords from common FTP clients.', '[Astaroth] uses an external software known as NetPass to recover passwords. ', '[Agent Tesla] has the ability to steal credentials from FTP clients and wireless profiles.', '[LaZagne] can obtain credentials from databases, mail, and WiFi across multiple platforms.', '[OLDBAIT] collects credentials from several email clients.', '[PinchDuke] steals credentials from compromised hosts. [PinchDuke] credential stealing functionality is believed to be based on the source code of the Pinch credential stealing malware (also known as LdPinch). Credentials targeted by [PinchDuke] include ones associated with many sources such as The Bat!, Yahoo!, Mail.ru, Passport.Net, Google Talk, and Microsoft Outlook.', '[OilRig] has used credential dumping tools such as [LaZagne] to steal credentials to accounts logged into the compromised system and to Outlook Web Access.', '[FIN6] has used the Stealer One credential stealer to target e-mail and file transfer utilities including FTP.', 'During the [SolarWinds Compromise] [APT29] used account credentials they obtained to attempt access to Group Managed Service Account (gMSA) passwords. ', '[Pupy] can use Lazagne for harvesting credentials.', '[PoshC2] can decrypt passwords stored in the RDCMan configuration file.', '[KGH_SPY] can collect credentials from WINSCP.', '[APT29] used account credentials they obtained to attempt access to Group Managed Service Account (gMSA) passwords.', '[UNC2452] used account credentials they obtained to attempt access to Group Managed Service Account (gMSA) passwords.']"
T1589,Gather Victim Identity Information,"Adversaries may gather information about the victim's identity that can be used during targeting. Information about identities may include a variety of details, including personal data (ex: employee names, email addresses, etc.) as well as sensitive details such as credentials.  Adversaries may gather this information in various ways, such as direct elicitation via [Phishing for Information] Information about users could also be enumerated via other active means (i.e. [Active Scanning] such as probing and analyzing responses from authentication services that may reveal valid usernames in a system. Information about victims may also be exposed to adversaries via online or other accessible data sets (ex: [Social Media] or [Search Victim-Owned Websites]  Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains] or [Phishing for Information] establishing operational resources (ex: [Compromise Accounts] and/or initial access (ex: [Phishing] or [Valid Accounts]","['[LAPSUS$] has gathered detailed information of target employees to enhance their social engineering lures.', '[HEXANE] has identified specific potential victims at targeted organizations.', '[FIN13] has researched employees to target for social engineering attacks.', 'For [Operation Dream Job] [Lazarus Group] conducted extensive reconnaissance research on potential targets.', '[APT32] has conducted targeted surveillance against activists and bloggers.', 'During [Operation Wocao] threat actors targeted people based on their organizational roles and privileges.', '[Magic Hound] has acquired mobile phone numbers of potential targets, possibly for mobile malware or additional phishing operations.']"
T1185,Browser Session Hijacking,"Adversaries may take advantage of security vulnerabilities and inherent functionality in browser software to change content, modify user-behaviors, and intercept information as part of various browser session hijacking techniques.  A specific example is when an adversary injects software into a browser that allows them to inherit cookies, HTTP sessions, and SSL client certificates of a user then use the browser as a way to pivot into an authenticated intranet. Executing browser-based behaviors such as pivoting may require specific process permissions, such as <code>SeDebugPrivilege</code> and/or high-integrity/administrator rights.  Another example involves pivoting browser traffic from the adversary's browser through the user's browser by setting up a proxy which will redirect web traffic. This does not alter the user's traffic in any way, and the proxy connection can be severed as soon as the browser is closed. The adversary assumes the security context of whichever browser process the proxy is injected into. Browsers typically create a new process for each tab that is opened and permissions and certificates are separated accordingly. With these permissions, an adversary could potentially browse to any resource on an intranet, such as [Sharepoint] or webmail, that is accessible through the browser and which the browser has sufficient permissions. Browser pivoting may also bypass security provided by 2-factor authentication.","['[TrickBot] uses web injects and browser redirection to trick the user into providing their login credentials on a fake or modified web page.', '[Dridex] can perform browser attacks via web injects to steal information such as credentials, certificates, and cookies.', '[Carberp] has captured credentials when a user performs login through a SSL session.', ""[Melcoz] can monitor the victim's browser for online banking sessions and display an overlay window to manipulate the session in the background."", '[Agent Tesla] has the ability to use form-grabbing to extract data from web data forms.', '[Grandoreiro] can monitor browser activity for online banking actions and display full-screen overlay images to block user access to the intended site or present additional data fields.', '[QakBot] can use advanced web injects to steal web banking credentials.', ""[Cobalt Strike] can perform browser pivoting and inject into a user's browser to inherit cookies, authenticated HTTP sessions, and client SSL certificates."", '[IcedID] has used web injection attacks to redirect victims to spoofed sites designed to harvest banking and other credentials.  [IcedID] can use a self signed TLS certificate in connection with the spoofed site and simultaneously maintains a live connection with the legitimate site to display the correct URL and certificates in the browser.', '[Chaes] has used the Puppeteer module to hook and monitor the Chrome web browser to collect user information from infected hosts.', '[Ursnif] has injected HTML codes into banking sites to steal sensitive online banking information (ex: usernames and passwords).', ""[Cobalt Strike] can perform browser pivoting and inject into a user's browser to inherit cookies, authenticated HTTP sessions, and client SSL certificates.""]"
T1021,Remote Services,"Adversaries may use [Valid Accounts] to log into a service that accepts remote connections, such as telnet, SSH, and VNC. The adversary may then perform actions as the logged-on user.  In an enterprise environment, servers and workstations can be organized into domains. Domains provide centralized identity management, allowing users to login using one set of credentials across the entire network. If an adversary is able to obtain a set of valid domain credentials, they could login to many different machines using remote access protocols such as secure shell (SSH) or remote desktop protocol (RDP). They could also login to accessible SaaS or IaaS services, such as those that federate their identities to the domain.   Legitimate applications (such as [Software Deployment Tools] and other administrative programs) may utilize [Remote Services] to access remote hosts. For example, Apple Remote Desktop (ARD) on macOS is native software used for remote management. ARD leverages a blend of protocols, including [VNC] to send the screen and control buffers and [SSH] for secure file transfer. Adversaries can abuse applications such as ARD to gain remote code execution and perform lateral movement. In versions of macOS prior to 10.14, an adversary can escalate an SSH session to an ARD session which enables an adversary to accept TCC (Transparency, Consent, and Control) prompts without user interaction and gain access to data.","['[Wizard Spider] has used the WebDAV protocol to execute [Ryuk] payloads hosted on network file shares.', '[MacMa] can manage remote screen sessions.', '[Brute Ratel C4] has the ability to use RPC for lateral movement.', '[Kivars] has the ability to remotely trigger keyboard input and mouse clicks. ', '[Stuxnet] can propagate via peer-to-peer communication and updates using RPC.', 'RemoteCMD can execute commands remotely by creating a new service on the remote system .']"
T1112,Modify Registry,"Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove information as part of cleaning up, or as part of other techniques to aid in persistence and execution.  Access to specific areas of the Registry depends on account permissions, some requiring administrator-level access. The built-in Windows command-line utility [Reg] may be used for local or remote Registry modification.  Other tools may also be used, such as a remote access tool, which may contain functionality to interact with the Registry through the Windows API.  Registry modifications may also include actions to hide keys, such as prepending key names with a null character, which will cause an error and/or be ignored when read via [Reg] or other utilities using the Win32 API.  Adversaries may abuse these pseudo-hidden keys to conceal payloads/commands used to maintain persistence.    The Registry of a remote system may be modified to aid in execution of files as part of lateral movement. It requires the remote Registry service to be running on the target system.  Often [Valid Accounts] are required, along with access to the remote system's [SMB/Windows Admin Shares] for RPC communication.","['[CharmPower] can remove persistence-related artifacts from the Registry.', 'During the [2015 Ukraine Electric Power Attack] [Sandworm Team] modified in-registry Internet settings to lower internet security before launching `rundll32.exe`, which in-turn launches the malware and communicates with C2 servers over the Internet. .', '[Turla] has modify Registry values to store payloads.', '[PlugX] has a module to create, delete, or modify Registry keys.', '[ShadowPad] can modify the Registry to store and maintain a configuration block and virtual file system.', '[Netwalker] can add the following registry entry: <code>HKEY_CURRENT_USER\\SOFTWARE\\{8 random characters}</code>.', '[Valak] has the ability to modify the Registry key <code>HKCU\\Software\\ApplicationContainer\\Appsw64</code> to store information regarding the C2 server and downloads.', '[ROKRAT] can modify the `HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\` registry key so it can bypass the VB object model (VBOM) on a compromised host.', '[APT38] uses a tool called CLEANTOAD that has the capability to modify Registry keys.', '[HOPLIGHT] has modified Managed Object Format (MOF) files within the Registry to run specific commands and create persistence on the system.\t', '[Catchamas] creates three Registry keys to establish persistence by adding a [Windows Service]', '[gh0st RAT] has altered the InstallTime subkey.', '[SynAck] can manipulate Registry keys.', '[SLOTHFULMEDIA] can add, modify, and/or delete registry keys. It has changed the proxy configuration of a victim system by modifying the <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap</code> registry.', '[Conficker] adds keys to the Registry at <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services</code> and various other Registry locations.', '[DCSrv] has created Registry keys for persistence.', '[SUNBURST] had commands that allow an attacker to write or delete registry keys, and was observed stopping services by setting their <code>HKLM\\SYSTEM\\CurrentControlSet\\services\\\\[service_name]\\\\Start</code> registry entries to value 4. It also deleted previously-created Image File Execution Options (IFEO) Debugger registry values and registry keys related to HTTP proxy to clean up traces of its activity.', 'A [Patchwork] payload deletes Resiliency Registry keys created by Microsoft Office applications in an apparent effort to trick users into thinking there were no issues during application runs.', '[Explosive] has a function to write itself to Registry values. ', '[PolyglotDuke] can write encrypted JSON configuration files to the Registry.', '[PoisonIvy] creates a Registry subkey that registers a new system device.', '[KOCTOPUS] has added and deleted keys from the Registry.', '[LoJax] has modified the Registry key <code>‘HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\BootExecute’</code> from <code>‘autocheck autochk *’</code> to <code>‘autocheck autoche *’</code>.', '[PHOREAL] is capable of manipulating the Registry.', '[PoetRAT] has made registry modifications to alter its behavior upon execution.', '[REvil] can modify the Registry to save encryption parameters and system information.', '[BACKSPACE] is capable of deleting Registry keys, sub-keys, and values on a victim system.', '[DarkWatchman] can modify Registry values to store configuration strings, keylogger, and output of components.', '[Grandoreiro] can modify the Registry to store its configuration at `HKCU\\Software\\` under frequently changing names including <code>%USERNAME%</code> and <code>ToolTech-RM</code>.', '[Taidoor] has the ability to modify the Registry on compromised hosts using <code>RegDeleteValueA</code> and <code>RegCreateKeyExA</code>.', '[Stuxnet] can create registry keys to load driver files.', '[TinyTurla] can set its configuration parameters in the Registry.', '[FELIXROOT] deletes the Registry key <code>HKCU\\Software\\Classes\\Applications\\rundll32.exe\\shell\\open</code>.', '[SMOKEDHAM] has modified registry keys for persistence, to enable credential caching for credential access, and to facilitate lateral movement via RDP.', '[Pillowmint] has modified the Registry key <code>HKLM\\SOFTWARE\\Microsoft\\DRM</code> to store a malicious payload.', '[PipeMon] has modified the Registry to store its encrypted payload.', '[Mafalda] can manipulate the system registry on a compromised host.', '[Ember Bear] has used an open source batch script to modify Windows Defender registry keys.', '[Silence] can create, delete, or modify a specified Registry key or value.', '[TA505] has used malware to disable Windows Defender through modification of the Registry.', '[CHOPSTICK] may modify Registry keys to store RC4 encrypted configuration information.', '[HermeticWiper] has the ability to modify Registry keys to disable crash dumps, colors for compressed files, and pop-up information about folders and desktop items.', '[WarzoneRAT] can create `HKCU\\Software\\Classes\\Folder\\shell\\open\\command` as a new registry key during privilege escalation. ', '[Cobalt Strike] can modify Registry values within <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\<Excel Version>\\Excel\\Security\\AccessVBOM\\</code> to enable the execution of additional code.', '[APT19] uses a Port 22 malware variant to modify several Registry keys.', '[CSPY Downloader] can write to the Registry under the <code>%windir%</code> variable to execute tasks.', '[Gelsemium] can modify the Registry to store its components.', '[WastedLocker] can modify registry values within the <code>Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap</code> registry key.', '[metaMain] can write the process ID of a target process into the `HKEY_LOCAL_MACHINE\\SOFTWARE\\DDE\\tpid` Registry value as part of its reflective loading activity.', '[QuasarRAT] has a command to edit the Registry on the victim’s machine.', '[Hydraq] creates a Registry subkey to register its created service, and can also uninstall itself later by deleting this value. [Hydraq] backdoor also enables remote attackers to modify and delete subkeys.', '[BlackCat] has the ability to add the following registry key on compromised networks to maintain persistence: `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services \\LanmanServer\\Paramenters`', '[Black Basta] can modify the Registry to enable itself to run in safe mode and to modify the icons and file extensions for encrypted files.', '[PLAINTEE] uses <code>reg add</code> to add a Registry Run key for persistence.', '[Gamaredon Group] has removed security settings for VBA macro execution by changing registry values <code>HKCU\\Software\\Microsoft\\Office\\&lt;version&gt;\\&lt;product&gt;\\Security\\VBAWarnings</code> and <code>HKCU\\Software\\Microsoft\\Office\\&lt;version&gt;\\&lt;product&gt;\\Security\\AccessVBOM</code>.', '[SILENTTRINITY] can modify registry keys, including to enable or disable Remote Desktop Protocol (RDP).', '[Uroburos] can store configuration information in the Registry including the initialization vector and AES key needed to find and decrypt other [Uroburos] components.', '[Waterbear] has deleted certain values from the Registry to load a malicious DLL. ', '[SOUNDBITE] is capable of modifying the Registry.', 'During [Night Dragon] threat actors used [zwShell] to establish full remote control of the connected machine and manipulate the Registry.', '[Remcos] has full control of the Registry, including the ability to modify it.', '[InvisiMole] has a command to create, set, copy, or delete a specified Registry key or value.', '[Metamorfo] has written process names to the Registry, disabled IE browser features, deleted Registry keys, and changed the ExtendedUIHoverTime key.', '[Mosquito] can modify Registry keys under <code>HKCU\\Software\\Microsoft\\[dllname]</code> to store configuration values. [Mosquito] also modifies Registry keys under <code>HKCR\\CLSID\\...\\InprocServer32</code> with a path to the launcher.', '[TEARDROP] modified the Registry to create a Windows service for itself on a compromised host.', '[StreamEx] has the ability to modify the Registry.', '[Attor] dispatcher can modify the Run registry key.', '[Lokibot] has modified the Registry as part of its UAC bypass process. ', '[ZxShell] can create Registry entries to enable services to run.', '[KONNI] has modified registry keys of ComSysApp, Svchost, and xmlProv on the machine to gain persistence. ', '[Wizard Spider] has modified the Registry key <code>HKLM\\System\\CurrentControlSet\\Control\\SecurityProviders\\WDigest</code> by setting the <code>UseLogonCredential</code> registry value to <code>1</code> in order to force credentials to be stored in clear text in memory. [Wizard Spider] has also modified the WDigest registry key to allow plaintext credentials to be cached in memory.', ""[APT32] backdoor has modified the Windows Registry to store the backdoor's configuration. \t"", '[Pysa] has modified the registry key “SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System” and added the ransom note. ', 'During [Operation Honeybee] the threat actors used batch files that modified registry keys.', '[BADCALL] modifies the firewall Registry key <code>SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfileGloballyOpenPorts\\\\List</code>.', '[Earth Lusca] modified the registry using the command <code>reg add “HKEY_CURRENT_USER\\Environment” /v UserInitMprLogonScript /t REG_SZ /d “[file path]”</code> for persistence.', '[MegaCortex] has added entries to the Registry for ransom contact information.', '[Prestige] has the ability to register new registry keys for a new extension handler via `HKCR\\.enc` and `HKCR\\enc\\shell\\open\\command`.', '[RegDuke] can create seemingly legitimate Registry key to store its encryption key.', '[Blue Mockingbird] has used Windows Registry modifications to specify a DLL payload.\t', '[Neoichor] has the ability to configure browser settings by modifying Registry entries under `HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer`.', '[Tarrask] is able to delete the Security Descriptor (`SD`) registry subkey in order to “hide” scheduled tasks.', '[Caterpillar WebShell] has a command to modify a Registry key.', '[Bisonal] has deleted Registry keys to clean up its prior activity. ', '[TajMahal] can set the <code>KeepPrintedJobs</code> attribute for configured printers in <code>SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Print\\\\Printers</code> to enable document stealing.', '[HyperStack] can add the name of its communication pipe to <code>HKLM\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\lanmanserver\\\\parameters\\NullSessionPipes</code>.', '[Crimson] can set a Registry key to determine how long it has been installed and possibly to indicate the version number.', '[Orz] can perform Registry operations.', '[RTM] can delete all Registry entries created during its execution.', 'During [Operation Wocao] the threat actors enabled Wdigest by changing the `HKLM\\SYSTEM\\\\ControlSet001\\\\Control\\\\SecurityProviders\\\\WDigest` registry value from 0 (disabled) to 1 (enabled).', '[Dragonfly] has modified the Registry to perform multiple techniques through the use of [Reg]', '[CrackMapExec] can create a registry key using wdigest.', '[Gorgon Group] malware can deactivate security mechanisms in Microsoft Office by editing several keys and values under <code>HKCU\\Software\\Microsoft\\Office\\</code>.', '[zwShell] can modify the Registry.', '[Chaes] can modify Registry values to stored information and establish persistence. ', '[NanoCore] has the capability to edit the Registry.', '[Clop] can make modifications to Registry keys. ', '[ThreatNeedle] can modify the Registry to save its configuration data as the following RC4-encrypted Registry key: `HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\GameCon`.', '[Ursnif] has used Registry modifications as part of its installation routine.', '[PowerShower] has added a registry key so future powershell.exe instances are spawned off-screen by default, and has removed all registry entries that are left behind during the dropper process.', '[ADVSTORESHELL] is capable of setting and deleting Registry values.', '[EVILNUM] can make modifications to the Regsitry for persistence.', '[Zeus Panda] modifies several Registry keys under <code>HKCU\\Software\\Microsoft\\Internet Explorer\\ PhishingFilter\\</code> to disable phishing filters.', '[Exaramel for Windows] adds the configuration to the Registry in XML format.', '[Naid] creates Registry entries that store information about a created service and point to a malicious DLL dropped to disk.', 'Once [Shamoon] has access to a network share, it enables the RemoteRegistry service on the target system. It will then connect to the system with RegConnectRegistryW and modify the Registry to disable UAC remote restrictions by setting <code>SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy</code> to 1.', '[SysUpdate] can write its configuration file to <code>Software\\Classes\\scConfig</code> in either <code>HKEY_LOCAL_MACHINE</code> or <code>HKEY_CURRENT_USER</code>.', '[LuminousMoth] has used malware that adds Registry keys for persistence.', '[njRAT] can create, delete, or modify a specified Registry key or value.', '[Mori] can write data to `HKLM\\Software\\NFC\\IPA` and `HKLM\\Software\\NFC\\` and delete Registry values.', '[GreyEnergy] modifies conditions in the Registry and adds keys.', '[Reg] may be used to interact with and modify the Windows Registry of a local or remote system at the command-line interface.', '[Rover] has functionality to remove Registry Run key persistence as a cleanup procedure.', '[Volgmer] modifies the Registry to store an encoded configuration file in <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Security</code>.', '[Clambling] can set and delete Registry keys.', '[QakBot] can modify the Registry to store its configuration information in a randomly named subkey under <code>HKCU\\Software\\Microsoft</code>.', '[Bankshot] writes data into the Registry key <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Pniumj</code>.', '[Kimsuky] has modified Registry settings for default file associations to enable all macros and for persistence.', '[ComRAT] has modified Registry values to store encrypted orchestrator code and payloads. ', '[Avaddon] modifies several registry keys for persistence and UAC bypass.', '[Amadey] has overwritten registry keys for persistence.', '[TrickBot] can modify registry entries.', '[APT41] used a malware variant called GOODLUCK to modify the registry in order to steal credentials.', '[DarkComet] adds a Registry value for its installation routine to the Registry Key <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System Enable LUA=”0”</code> and <code>HKEY_CURRENT_USER\\Software\\DC3_FEXEC</code>.', '[Magic Hound] has modified Registry settings for security tools.', '[TYPEFRAME] can install encrypted configuration data under the Registry key <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ShellCompatibility\\Applications\\laxhost.dll</code> and <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\PrintConfigs</code>.', '[PcShare] can delete its persistence mechanisms from the registry.', '[KEYMARBLE] has a command to create Registry entries for storing data under <code>HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\WABE\\DataPath</code>.', '[Ferocious] has the ability to add a Class ID in the current user Registry hive to enable persistence mechanisms.', '[DarkTortilla] has modified registry keys for persistence.', '[Cardinal RAT] sets <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Load</code> to point to its executable.', '[Agent Tesla] can achieve persistence by modifying Registry key entries. ', '[NightClub] can modify the Registry to set the ServiceDLL for a service created by the malware for persistence. ', '[QUADAGENT] modifies an HKCU Registry key to store a session identifier unique to the compromised system as well as a pre-shared key used for encrypting and decrypting C2 communications.', '[NETWIRE] can modify the Registry to store its configuration information.', '[Sibot] has modified the Registry to install a second-stage script in the <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\sibot</code>.', '[BitPaymer] can set values in the Registry to help in execution. ', '[RCSession] can write its configuration file to the Registry.', '[Nerex] creates a Registry subkey that registers a new service.', '[ShimRat] has registered two registry keys for shim databases.', 'A [Threat Group-3390] tool has created new Registry keys under `HKEY_CURRENT_USER\\Software\\Classes\\` and `HKLM\\SYSTEM\\CurrentControlSet\\services`.', '[FIN8] has deleted Registry keys during post compromise cleanup activities.', '[AADInternals] can modify registry keys as part of setting a new pass-through authentication agent.', '[Regin] appears to have functionality to modify remote Registry information.', '[Pandora] can write an encrypted token to the Registry to enable processing of remote commands.', '[Honeybee] uses a batch file that modifies Registry keys to launch a DLL into the svchost.exe process.', '[Operation Wocao] has enabled Wdigest by changing the registry value from 0 to 1.', '[Dragonfly 2.0] modified the Registry to perform multiple techniques through the use of [Reg]', '[Lazarus Group] has modified registry keys using the reg windows utility for its custom backdoor implants.', 'creates a Registry subkey that registers a new system device.']"
T1491,Defacement,"Adversaries may modify visual content available internally or externally to an enterprise network, thus affecting the integrity of the original content. Reasons for [Defacement] include delivering messaging, intimidation, or claiming (possibly false) credit for an intrusion. Disturbing or offensive images may be used as a part of [Defacement] in order to cause user discomfort, or to pressure compliance with accompanying messages.  ",[]
T1563,Remote Service Session Hijacking,"Adversaries may take control of preexisting sessions with remote services to move laterally in an environment. Users may use valid credentials to log into a service specifically designed to accept remote connections, such as telnet, SSH, and RDP. When a user logs into a service, a session will be established that will allow them to maintain a continuous interaction with that service.  Adversaries may commandeer these sessions to carry out actions on remote systems. [Remote Service Session Hijacking] differs from use of [Remote Services] because it hijacks an existing session rather than creating a new session using [Valid Accounts]",[]
T1217,Browser Information Discovery,"Adversaries may enumerate information about browsers to learn more about compromised environments. Data saved by browsers (such as bookmarks, accounts, and browsing history) may reveal a variety of personal information about users (e.g., banking sites, relationships/interests, social media, etc.) as well as details about internal network resources such as servers, tools/dashboards, or other related infrastructure.  Browser information may also highlight additional targets after an adversary has access to valid credentials, especially [Credentials In Files] associated with logins cached by a browser.  Specific storage locations vary based on platform and/or application, but browser information is typically stored in local files and databases (e.g., `%APPDATA%/Google/Chrome`).","['[Calisto] collects information on bookmarks from Google Chrome.', '[Lizar] can retrieve browser history and database files. ', '[Machete] retrieves the user profile data (e.g., browsers) from Chrome and Firefox browsers. ', '[PowerLess] has a browser info stealer module that can read Chrome and Edge browser database files.', '[Dtrack] can retrieve browser history.', '[Fox Kitten] has used Google Chrome bookmarks to identify internal resources and assets.', '[APT38] has collected browser bookmark information to learn more about compromised hosts, obtain personal information about users, and acquire details about internal network resources.', '[DarkWatchman] can retrieve browser history.', '[Mafalda] can collect the contents of the `%USERPROFILE%\\AppData\\Local\\Google\\Chrome\\User Data\\LocalState` file. ', '[Empire] has the ability to gather browser data such as bookmarks and visited sites.', '[SUGARDUMP] has collected browser bookmark and history information.', '[MobileOrder] has a command to upload to its C2 server victim browser bookmarks.', '[Chimera] has used <code>type \\\\<hostname>\\c$\\Users\\<username>\\Favorites\\Links\\Bookmarks bar\\Imported From IE\\*citrix*</code> for bookmark discovery.']"
T1595,Active Scanning,"Adversaries may execute active reconnaissance scans to gather information that can be used during targeting. Active scans are those where the adversary probes victim infrastructure via network traffic, as opposed to other forms of reconnaissance that do not involve direct interaction.  Adversaries may perform different forms of active scanning depending on what information they seek to gather. These scans can also be performed in various ways, including using native features of network protocols such as ICMP. Information from these scans may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains] or [Search Open Technical Databases] establishing operational resources (ex: [Develop Capabilities] or [Obtain Capabilities] and/or initial access (ex: [External Remote Services] or [Exploit Public-Facing Application]",[]
T1548,Abuse Elevation Control Mechanism,Adversaries may circumvent mechanisms designed to control elevate privileges to gain higher-level permissions. Most modern systems contain native elevation control mechanisms that are intended to limit privileges that a user can perform on a machine. Authorization has to be granted to specific users in order to perform tasks that can be considered of higher risk. An adversary can perform several methods to take advantage of built-in control mechanisms in order to escalate privileges on a system.,[]
T1016,System Network Configuration Discovery,"Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include [Arp] [ipconfig] [nbtstat] and [route]  Adversaries may also leverage a [Network Device CLI] on network devices to gather information about configurations and settings, such as IP addresses of configured interfaces and static/dynamic routes (e.g. <code>show ip route</code>, <code>show ip interface</code>).  Adversaries may use the information from [System Network Configuration Discovery] during automated discovery to shape follow-on behaviors, including determining certain access within the target network and what actions to do next. ","["" [Explosive] has collected the MAC address from the victim's machine. "", '[Chrommme] can enumerate the IP address of a compromised host.', '[ifconfig] can be used to display adapter configuration on Unix systems, including information for TCP/IP, DNS, and DHCP.', '[HEXANE] has used [Ping] and `tracert` for network discovery.', '[Stuxnet] collects the IP address of a compromised system.', '[Mustang Panda] has used <code>ipconfig</code> and <code>arp</code> to determine network configuration information.', '[Dyre] has the ability to identify network settings on a compromised host.', ""[Olympic Destroyer] uses API calls to enumerate the infected system's ARP table."", '[Koadic] can retrieve the contents of the IP routing table as well as information about the Windows domain.', '[T9000] gathers and beacons the MAC and IP addresses during installation.', '[Lucifer] can collect the IP address of a compromised host.', 'The [IceApple] [ifconfig] module can iterate over all network interfaces on the host and retrieve the name, description, MAC address, DNS suffix, DNS servers, gateways, IPv4 addresses, and subnet masks.', '[BLUELIGHT] can collect IP information from the victim’s machine.', '[Empire] can acquire network configuration information like DNS servers, public IP, and network proxies used by a host.', '[VERMIN] gathers the local IP address.', '[PoshC2] can enumerate network adapter information.', '[KeyBoy] can determine the public or WAN IP address for the system.', '[POWRUNER] may collect network configuration data by running <code>ipconfig /all</code> on a victim.', ""[PowerDuke] has a command to get the victim's domain and NetBIOS name."", '[KEYMARBLE] gathers the MAC address of the victim’s machine.', '[Cobalt Strike] can determine the NetBios name and  the IP addresses of targets machines including domain controllers.', '[NanoCore] gathers the IP address from the victim’s machine.', '[Pysa] can perform network reconnaissance using the Advanced IP Scanner tool.', '[Ramsay] can use [ipconfig] and [Arp] to collect network configuration information, including routing information and ARP tables.', '[Sardonic] has the ability to execute the `ipconfig` command.', '[GravityRAT] collects the victim IP address, MAC address, as well as the victim account domain name.', 'A [JHUHUGIT] variant gathers network interface card information.', '[Dragonfly] has used batch scripts to enumerate network information, including information about trusts, zones, and the domain.', '[admin@338] actors used the following command after exploiting a machine with [LOWBALL] malware to acquire information about local networks: <code>ipconfig /all >> %temp%\\download</code>', '[iKitten] will look for the current IP address.', '[Emissary] has the capability to execute the command <code>ipconfig /all</code>.', '[NBTscan] can be used to collect MAC addresses.\t', '[Kevin] can collect the MAC address and other information from a victim machine using `ipconfig/all`.', '[Moses Staff] has collected the domain name of a compromised network.', '[Saint Bot] can collect the IP address of a victim machine.', '[OSX_OCEANLOTUS.D] can collect the network interface MAC address on the infected host.', '[KONNI] can collect the IP address from the victim’s machine.', '[Rifdoor] has the ability to identify the IP address of the compromised host.', '[JPIN] can obtain network information, including DNS, IP, and proxies.', '[PcShare] can obtain the proxy settings of a compromised machine using `InternetQueryOptionA` and its IP address by running `nslookup myip.opendns.comresolver1.opendns.com\\r\\n`.', '[OceanSalt] can collect the victim’s IP address.', '[AppleSeed] can identify the IP of a targeted system.', 'During [Operation CuckooBees] the threat actors used `ipconfig`, `nbtstat`, `tracert`, `route print`, and `cat /etc/hosts` commands.', '[Agent Tesla] can collect the IP address of the victim machine and spawn instances of netsh.exe to enumerate wireless settings. ', 'During [C0017] [APT41] used `cmd.exe /c ping %userdomain%` for discovery.', '[Milan] can run `C:\\Windows\\system32\\cmd.exe /c cmd /c ipconfig /all 2>&1` to discover network settings.', '[APT19] used an HTTP malware variant and a Port 22 malware variant to collect the MAC address and IP address from the victim’s machine.', '[LiteDuke] has the ability to discover the proxy configuration of Firefox and/or Opera.', '[Elise] executes <code>ipconfig /all</code> after initial communication is made to the remote server.', '[FIN13] has used `nslookup` and `ipconfig` for network reconnaissance efforts. [FIN13] has also utilized a compromised Symantec Altiris console and LanDesk account to retrieve network information.', '[Calisto] runs the <code>ifconfig</code> command to obtain the IP address from the victim’s machine.', '[StrongPity] can identify the IP address of a compromised host.', ""[Caterpillar WebShell] can gather the IP address from the victim's machine using the IP config command. "", '[Okrum] can collect network information, including the host IP address, DNS, and proxy information.', '[Mis-Type] may create a file containing the results of the command <code>cmd.exe /c ipconfig /all</code>.', '[Aria-body] has the ability to identify the location, public IP address, and domain name on a compromised host.', '[RogueRobin] gathers the IP address and domain from the victim’s machine.', '[FatDuke] can identify the MAC address on the target computer.', '[MacMa] can collect IP addresses from a compromised host.', '[NanHaiShu] can gather information about the victim proxy server.', '[Hydraq] creates a backdoor through which remote attackers can retrieve IP addresses of compromised machines.', 'A module in [Prikormka] collects information from the victim about its IP addresses and MAC addresses.', '[Volt Typhoon] has executed multiple commands to enumerate network topology and settings including  `ipconfig`, `netsh interface firewall show all`, and `netsh interface portproxy show all`.', '[Comnie] uses <code>ipconfig /all</code> and <code>route PRINT</code> to identify network adapter and interface information.', '[Lazarus Group] malware IndiaIndia obtains and sends to its C2 server information about the first network interface card’s configuration, including IP address, gateways, subnet mask, DHCP information, and whether WINS is available.', '[Naid] collects the domain name from a compromised host.', '[Sibot] checked if the compromised system is configured to use proxies.', '[Backdoor.Oldrea] collects information about the Internet adapter configuration.', '[Carbon] can collect the IP address of the victims and other computers on the network using the commands: <code>ipconfig -all</code> <code>nbtstat -n</code>, and <code>nbtstat -s</code>.', 'A keylogging tool used by [APT3] gathers network information from the victim, including the MAC address, IP address, WINS, DHCP server, and gateway.', '[Penquin] can report the IP of the compromised host to attacker controlled infrastructure.', '[MuddyWater] has used malware to collect the victim’s IP address and domain name.', '[GrimAgent] can enumerate the IP and domain of a target system.', '[Denis] uses <code>ipconfig</code> to gather the IP address from the system.', '[menuPass] has used several tools to scan for open NetBIOS nameservers and enumerate NetBIOS sessions.', '[Pupy] has built in commands to identify a host’s IP address and find out other network configuration settings by viewing connected sessions.', '[SideCopy] has identified the IP address of a compromised host.', '[Taidoor] has collected the MAC address of a compromised host; it can also use <code>GetAdaptersInfo</code> to identify network adapters.', '[Stealth Falcon] malware gathers the Address Resolution Protocol (ARP) table from the victim.', ""[Shamoon] obtains the target's IP address and local network segment."", '[Bonadan] can find the external IP address of the infected host.', ""[Pisloader] has a command to collect the victim's IP address."", '[AdFind] can extract subnet information from Active Directory.', ""[GoldMax] retrieved a list of the system's network interface after execution."", '[Kessel] has collected the DNS address of the infected host.', '[PingPull] can retrieve the IP address of a compromised host.', ""[ZeroT] gathers the victim's IP address and domain information, and then sends it to its C2 server."", '[PLAINTEE] uses the <code>ipconfig /all</code> command to gather the victim’s IP address.', '[Action RAT] has the ability to collect the MAC address of an infected host.', '[APT1] used the <code>ipconfig /all</code> command to gather network configuration information.', ""[Tropic Trooper] has used scripts to collect the host's network topology.\t"", '[Small Sieve] can obtain the IP address of a victim host.', ""[Ixeshe] enumerates the IP address, network proxy settings, and domain name from a victim's system."", '[Threat Group-3390] actors use [NBTscan] to discover vulnerable systems.', '[Kobalos] can record the IP address of the target machine.', '[Machete] collects the MAC address of the target computer and other network configuration information.', '[Octopus] can collect the host IP address from the victim’s machine.', '[QUADAGENT] gathers the current domain the victim system belongs to.', '[SUNBURST] collected all network interface MAC addresses that are up and not loopback devices, as well as IP address, DHCP configuration, and domain information.', '[Ke3chang] has performed local network configuration discovery using <code>ipconfig</code>.', '[Naikon] uses commands such as <code>netsh interface show</code> to discover network interface settings.', '[SpeakUp] uses the <code>ifconfig -a</code> command. ', ""[USBferry] can detect the infected machine's network topology using <code>ipconfig</code> and <code>arp</code>.\t"", '[QakBot] can use <code>net config workstation</code>, <code>arp -a</code>, `nslookup`, and <code>ipconfig /all</code> to gather network configuration information.', '[zwShell] can obtain the victim IP address.', '[FELIXROOT] collects information about the network including the IP address and DHCP server.', '[FALLCHILL] collects MAC address and local IP address information from the victim.', '[Conti] can retrieve the ARP cache from the local system by using the <code>GetIpNetTable()</code> API call and check to ensure IP addresses it connects to are for local, non-Internet, systems. ', '[EKANS] can determine the domain of a compromised host.', ""[Unknown Logger] can obtain information about the victim's IP address."", ""[xCaon] has used the GetAdaptersInfo() API call to get the victim's MAC address."", '[Cuba] can retrieve the ARP cache from the local system by using <code>GetIpNetTable</code>. ', 'During [FunnyDream] the threat actors used [ipconfig] for discovery on remote systems.', '[Zebrocy] runs the <code>ipconfig /all</code> command.', '[SHARPSTATS] has the ability to identify the domain of the compromised host.', '[FunnyDream] can parse the `ProxyServer` string in the Registry to discover http proxies.', '[InvisiMole] gathers information on the IP forwarding table, MAC address, configured proxy, and network SSID.', '[Avenger] can identify the domain of the compromised host.', ""[UPPERCUT] has the capability to gather the victim's proxy information."", '[Industroyer] 61850 payload component enumerates connected network adapters and their corresponding IP addresses.', '[Chimera] has used [ipconfig] [Ping] and <code>tracert</code> to enumerate the IP address and network environment and settings of the local host.', '[WellMail] can identify the IP address of the victim system.', '[SpicyOmelette] can identify the IP of a compromised system.', '[GeminiDuke] collects information on network settings and Internet proxy settings from the victim.', ""[BLINDINGCAN] has collected the victim machine's local IP address information and MAC address."", '[Royal] can enumerate IP addresses using `GetIpAddrTable`.', '[CreepySnail] can use `getmac` and `Get-NetIPAddress` to enumerate network settings.', '[Astaroth] collects the external IP address from the system. ', '[ShadowPad] has collected the domain name of the victim system.', ""[Magic Hound] malware gathers the victim's local IP address, MAC address, and external IP address."", '[LoudMiner] used a script to gather the IP address of the infected machine before sending to the C2.', '[Sliver] has the ability to gather network configuration information.', '[Cyclops Blink] can use the Linux API `if_nameindex` to gather network interface names.', '[QUIETCANARY] can identify the default proxy setting on a compromised host.', ""[Green Lambert] can obtain proxy information from a victim's machine using system environment variables. "", '[RATANKBA] gathers the victim’s IP address via the <code>ipconfig -all</code> command.', '[Crimson] contains a command to collect the victim MAC address and LAN IP.', '[POWERSTATS] can retrieve IP, network adapter configuration information, and domain from compromised hosts.', ""[KOPILUWAK] can use [Arp] to discover a target's network configuration setttings."", '[nbtstat] can be used to discover local NetBIOS domain names.', '[Valak] has the ability to identify the domain and the MAC and IP addresses of an infected machine.', '[Revenge RAT] collects the IP address and MAC address from the system.', '[TajMahal] has the ability to identify the MAC address on an infected host.', '[SideTwist] has the ability to collect the domain name on a compromised host.', '[LightNeuron] gathers information about network adapters using the Win32 API call <code>GetAdaptersInfo</code>.', '[QuasarRAT] has the ability to enumerate the Wide Area Network (WAN) IP through requests to ip-api[.]com, freegeoip[.]net, or api[.]ipify[.]org observed with user-agent string `Mozilla/5.0 (Windows NT 6.3; rv:48.0) Gecko/20100101 Firefox/48.0`.', '[Sykipot] may use <code>ipconfig /all</code> to gather system network configuration details.', '[RedLeaves] can obtain information about network parameters.', '[Mafalda] can use the `GetAdaptersInfo` function to retrieve information about network adapters and the `GetIpNetTable` function to retrieve the IPv4 to physical network address mapping table.', '[SDBbot] has the ability to determine the domain name and whether a proxy is configured on a compromised host.', '[SoreFang] can collect the TCP/IP, DNS, DHCP, and network adapter configuration on a compromised host via <code>ipconfig.exe /all</code>.', ""[Volgmer] can gather the IP address from the victim's machine."", '[Bazar] can collect the IP address and NetBIOS name of an infected machine.', '[Sidewinder] has used malware to collect information on network interfaces, including the MAC address.', '[Turla] surveys a system upon check-in to discover network configuration details using the <code>arp -a</code>, <code>nbtstat -n</code>, <code>net config</code>, <code>ipconfig /all</code>, and <code>route</code> commands, as well as [NBTscan] [Turla] RPC backdoors have also retrieved registered RPC interface information from process memory.', ""[Dtrack] can collect the host's IP addresses using the <code>ipconfig</code> command."", '[Wizard Spider] has used [ipconfig] to identify the network configuration of a victim machine. [Wizard Spider] has also used the PowerShell cmdlet `Get-ADComputer` to collect IP address data from Active Directory.', '[Turian] can retrieve the internal IP address of a compromised host.', '[Catchamas] gathers the Mac address, IP address, and the network adapter information from the victim’s machine.', ""[Diavol] can enumerate victims' local and external IPs when registering with C2."", '[S-Type] has used `ipconfig /all` on a compromised host.', ""[More_eggs] has the capability to gather the IP address from the victim's machine."", '[TeamTNT] has enumerated the host machine’s IP address.', '[Anchor] can determine the public IP and location of a compromised host.', '[Mosquito] uses the <code>ipconfig</code> command.', '[PowerShower] has the ability to identify the current Windows domain of the infected host.', '[APT41] collected MAC addresses from victim machines. ', '[WellMess] can identify the IP address and user domain on the target machine.', '[GALLIUM] used <code>ipconfig /all</code> to obtain information about the victim network configuration. The group also ran a modified version of [NBTscan] to identify available NetBIOS name servers.', '[DEADEYE] can discover the DNS domain name of a targeted system.', '[Bandook] has a command to get the public IP address from a system. ', '[Kimsuky] has used `ipconfig/all` to gather network configuration information.', '[WannaCry] will attempt to determine the local network segment it is a part of.', '[STARWHALE] has the ability to collect the IP address of an infected host.', '[ipconfig] can be used to display adapter configuration on Windows systems, including information for TCP/IP, DNS, and DHCP.', '[Flagpro] has been used to execute the <code>ipconfig /all</code> command on a victim system.', '[Darkhotel] has collected the IP address and network adapter information from the victim’s machine.', '[Sys10] collects the local IP address of the victim and sends it to the C2.', 'During [C0018] the threat actors ran `nslookup` and Advanced IP Scanner on the target network.', '[BADFLICK] has captured victim IP address details.', '[Remsec] can obtain information about network configuration, including the routing table, ARP cache, and DNS cache.', '[HAFNIUM] has collected IP information via IPInfo.', '[Neoichor] can gather the IP address from an infected host.  ', '[Brave Prince] gathers network configuration information as well as the ARP cache.', '[Trojan.Karagany] can gather information on the network configuration of a compromised host.', '[ShimRatReporter] gathered the local proxy, domain, IP, routing tables, mac address, gateway, DNS servers, and DHCP status information from an infected host.', '[MoonWind] obtains the victim IP address.', '[Orz] can gather victim proxy information.', '[Felismus] collects the victim LAN IP address and sends it to the C2 server.', '[CharmPower] has the ability to use <code>ipconfig</code> to enumerate system network settings.', '[route] can be used to discover routing configuration information.', '[Woody RAT] can retrieve network interface and proxy information.', ""[BoxCaon] can collect the victim's MAC address by using the <code>GetAdaptersInfo</code> API."", '[APT32] used the <code>ipconfig /all</code> command to gather the IP address from the system.', '[Epic] uses the <code>nbtstat -n</code> and <code>nbtstat -s</code> commands on the victim’s machine.', '[TSCookie] has the ability to identify the IP of the infected host.', '[Grandoreiro] can determine the IP and physical location of the compromised host via IPinfo.', '[BabyShark] has executed the <code>ipconfig /all</code> command.\t', ""[Kwampirs] collects network adapter and interface information by using the commands <code>ipconfig /all</code>, <code>arp -a</code> and <code>route print</code>. It also collects the system's MAC address with <code>getmac</code> and domain configuration with <code>net config workstation</code>."", '[NETWIRE] can collect the IP address of a compromised host.', '[Lokibot] has the ability to discover the domain name of the infected host.', '[Higaisa] used <code>ipconfig</code> to gather network configuration information.', '[Proxysvc] collects the network adapter information and domain/username information based on current remote sessions.', '[Arp] can be used to display ARP configuration information on the host.', 'During [Frankenstein] the threat actors used [Empire] to find the public IP address of a compromised system.', '[OSInfo] discovers the current domain information.', '[Azorult] can collect host IP information from the victim’s machine.', '[Nltest] may be used to enumerate the parent domain of a local machine using <code>/parentdomain</code>.', '[SysUpdate] can collected the IP address and domain name of a compromised host. ', 'The reconnaissance modules used with [Duqu] can collect information on network configuration.', '[Agent.btz] collects the network adapter’s IP and MAC address as well as IP addresses of the network adapter’s default gateway, primary/secondary WINS, DHCP, and DNS servers, and saves them into a log file.', '[down_new] has the ability to identify the MAC address of a compromised host.', '[Lizar] can retrieve network information from a compromised host.', '[BlackEnergy] has gathered information about network IP configurations using [ipconfig] and about routing tables using [route]', '[CrackMapExec] can collect DNS information from the targeted system.', '[Avaddon] can collect the external IP address of the victim.', 'During [Operation Wocao] threat actors discovered the local network configuration with `ipconfig`.', '[OilRig] has run <code>ipconfig /all</code> on a victim.', '[Pay2Key] can identify the IP and MAC addresses of the compromised host.', '[Earth Lusca] used the command <code>ipconfig</code> to obtain information about network configurations.', '[NOKKI] can gather information on the victim IP address.', '[Bisonal] can execute <code>ipconfig</code> on the victim’s machine. ', '[Kazuar] gathers information about network adapters.', '[Clambling] can enumerate the IP address of a compromised machine.', 'During [C0015] the threat actors used code to obtain the external public-facing IPv4 address of the compromised host. ', '[PipeMon] can collect and send the local IP address, RDP information, and the network adapter physical address as a part of its C2 beacon.', '[Ryuk] has called <code>GetIpNetTable</code> in attempt to identify all mounted drives and hosts that have Address Resolution Protocol (ARP) entries. ', '[jRAT] can gather victim internal and external IPs.', '[ZIRCONIUM] has used a tool to enumerate proxy settings in the target environment.', '[HotCroissant] has the ability to identify the IP address of the compromised machine.', '[Xbash] can collect IP addresses and local intranet information from a victim’s machine.', ""[Torisma] can collect the local MAC address using `GetAdaptersInfo` as well as the system's IP address."", ""[Reaver] collects the victim's IP address."", '[TrickBot] obtains the IP address, location, and other relevant network information from the victim’s machine.', '[Rising Sun] can detect network adapter and IP address information.\t', '[BADCALL] collects the network adapter information.', '[yty] runs <code>ipconfig /all</code> and collects the domain name.', '[Squirrelwaffle] has collected the victim’s external IP address.', '[Amadey] can identify the IP address of a victim machine.', '[Sandworm Team] checks for connectivity to other resources in the network. ', '[Operation Wocao] has discovered the local network configuration with ipconfig.', '[Frankenstein] has enumerated hosts, looking for the public IP address of the system.', '[Dragonfly 2.0] used batch scripts to enumerate network information, including information about trusts, zones, and the domain.', '[Cobalt Strike] can determine the IP addresses of domain controllers.']"
T1087,Account Discovery,"Adversaries may attempt to get a listing of valid accounts, usernames, or email addresses on a system or within a compromised environment. This information can help adversaries determine which accounts exist, which can aid in follow-on behavior such as brute-forcing, spear-phishing attacks, or account takeovers (e.g., [Valid Accounts]  Adversaries may use several methods to enumerate accounts, including abuse of existing tools, built-in commands, and potential misconfigurations that leak account names and roles or permissions in the targeted environment.  For examples, cloud environments typically provide easily accessible interfaces to obtain user lists. On hosts, adversaries can use default [PowerShell] and other command line functionality to identify accounts. Information about email addresses and accounts may also be extracted by searching an infected system’s files.","['[ShimRatReporter] listed all non-privileged and privileged accounts available on the machine.', '[Woody RAT] can identify administrator accounts on an infected machine.', ""[XCSSET] attempts to discover accounts from various locations such as a user's Evernote, AppleID, Telegram, Skype, and WeChat data."", 'During the [SolarWinds Compromise] [APT29] obtained a list of users and their roles from an Exchange server using `Get-ManagementRoleAssignment`.', ""[FIN13] has enumerated all users and their roles from a victim's main treasury system."", '[APT29] obtained a list of users and their roles from an Exchange server using <code>Get-ManagementRoleAssignment</code>.', '[UNC2452] obtained a list of users and their roles from an Exchange server using <code>Get-ManagementRoleAssignment</code>.', '[APT32] enumerated administrative users and DC servers using the commands <code>net localgroup administrators</code> and <code>net group ""Domain Controllers"" /domain</code>.']"
T1070,Indicator Removal,"Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses. Various artifacts may be created by an adversary or something that can be attributed to an adversary’s actions. Typically these artifacts are used as defensive indicators related to monitored events, such as strings from downloaded files, logs that are generated from user actions, and other data analyzed by defenders. Location, format, and type of artifact (such as command or login history) are often specific to each platform.  Removal of these indicators may interfere with event collection, reporting, or other processes used to detect intrusion activity. This may compromise the integrity of security solutions by causing notable events to go unreported. This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.","['[Donut] can erase file references to payloads in-memory after being reflectively loaded and executed.', '[SDBbot] has the ability to clean up and remove data structures from a compromised host.', '[ShadowPad] has deleted arbitrary Registry values.', '[BlackEnergy] has removed the watermark associated with enabling the <code>TESTSIGNING</code> boot configuration option by removing the relevant strings in the <code>user32.dll.mui</code> of the system.', '[EVILNUM] has a function called ""DeleteLeftovers"" to remove certain artifacts of the attack.', '[SILENTTRINITY] can remove artifacts from the compromised host, including created Registry keys.', '[Orz] can overwrite Registry settings to reduce its visibility on the victim.', '[HermeticWiper] can disable pop-up information about folders and desktop items and delete Registry keys to hide malicious services.', '[Metamorfo] has a command to delete a Registry key it uses, <code>\\Software\\Microsoft\\Internet Explorer\\notes</code>.', '[Stuxnet] can delete OLE Automation and SQL stored procedures used to store malicious payloads.', '[Rising Sun] can clear a memory blog in the process by overwriting it with junk bytes.\t', '[FunnyDream] has the ability to clean traces of malware deployment.', '[Sardonic] has the ability to delete created WMI objects to evade detections.', 'During the [SolarWinds Compromise] [APT29] temporarily replaced legitimate utilities with their own, executed their payload, and then restored the original file.', '[Lazarus Group] has restored malicious [KernelCallbackTable] code to its original state after the process execution flow has been hijacked.', '[Maze] has used the “Wow64RevertWow64FsRedirection” function following attempts to delete the shadow volumes, in order to leave the system in the same state as it was prior to redirection.\t', '[Sibot] will delete an associated registry key if a certain server response is received.', '[CSPY Downloader] has the ability to remove values it writes to the Registry.', '[Bankshot] deletes all artifacts associated with the malware from the infected machine.', '[Flagpro] can close specific Windows Security and Internet Explorer dialog boxes to mask external connections.', '[DarkWatchman] can uninstall malicious components from the Registry, stop processes, and clear the browser history.', '[SUNBURST] removed HTTP proxy registry values to clean up traces of execution.', '[Neoichor] can clear the browser history on a compromised host by changing the `ClearBrowsingHistoryOnExit` value to 1 in the `HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Privacy` Registry key.  ', '[S-Type] has deleted accounts it has created.', '[APT29] temporarily replaced legitimate utilities with their own, executed their payload, and then restored the original file.', '[UNC2452] removed evidence of email export requests using <code>Remove-MailboxExportRequest</code>. They temporarily replaced legitimate utilities with their own, executed their payload, and then restored the original file.', '[KOCTOPUS] can delete created registry keys as part of its cleanup procedure.', '[Metamorfo] has a command to delete a Registry key it uses, <code>\\Software\\Microsoft\\Internet Explorer\\notes</code>. ', '[GrimAgent] can delete previously created tasks on a compromised host.', '[MCMD] has the ability to remove set Registry Keys.', '[Goopy] has the ability to delete emails used for C2 once the content has been copied.\t', '[CSPY Downloader] has the ability to remove values it writes to the Registry.', '[ShadowPad] has deleted arbitrary Registry values.', '[Bazar] loader can delete scheduled tasks created by a previous instance of the malware.\t', '[RTM] has the ability to remove Registry entries that it created during execution.', '[Sibot] will delete an associated registry key if a certain server response is received.', '[Pillowmint] can uninstall the malicious service from an infected machine.', '[Misdat] is capable of deleting Registry keys used for persistence.', '[njRAT] is capable of manipulating and deleting registry keys.', '[Stuxnet] removes itself from the system through a DLL export by deleting specific files and stored procedures.', '[Zeus Panda] can uninstall scripts and delete files to cover its track.', '[APT29] used [SDelete] to remove artifacts from victims.', 'Dragonfly deleted system, security, terminal services, remote services, and audit logs from a victim.']"
T1083,File and Directory Discovery,"Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system. Adversaries may use the information from [File and Directory Discovery] during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.  Many command shell utilities can be used to obtain this information. Examples include <code>dir</code>, <code>tree</code>, <code>ls</code>, <code>find</code>, and <code>locate</code>. Custom tools may also be used to gather file and directory information and interact with the [Native API] Adversaries may also leverage a [Network Device CLI] on network devices to gather file and directory information (e.g. <code>dir</code>, <code>show flash</code>, and/or <code>nvram</code>).","['[BLACKCOFFEE] has the capability to enumerate files.', '[Orz] can gather victim drive information.', '[Attor] has a plugin that enumerates files with specific extensions on all hard disk drives and stores file information in encrypted log files.', '[USBStealer] searches victim drives for files matching certain extensions (“.skr”,“.pkr” or “.key”) or names.', '[SDBbot] has the ability to get directory listings or drive information on a compromised host.', '[Kinsing] has used the find command to search for specific files.', '[Amadey] has searched for folders associated with antivirus software.', '[Woody RAT] can list all files and their associated attributes, including filename, type, owner, creation time, last access time, last write time, size, and permissions. ', '[Ebury] can list directory entries. ', '[PlugX] has a module to enumerate drives and find files recursively.', '[Volgmer] can list directories on a victim.', '[P.A.S. Webshell] has the ability to list files and file characteristics including extension, size, ownership, and permissions.', ""[Bazar] can enumerate the victim's desktop."", '[Crimson] contains commands to list files and directories, as well as search for files matching certain extensions from a defined list.', '[SynAck] checks its directory location in an attempt to avoid launching in a sandbox.', 'A [Patchwork] payload has searched all fixed drives on the victim for files matching a specified list of extensions.', '[Sowbug] identified and extracted all Word documents on a server by using a command containing * .doc and *.docx. The actors also searched for documents based on a specific date range and attempted to identify all installed software on a victim.', '[yty] gathers information on victim’s drives and has a plugin for document listing.', '[TAINTEDSCRIBE] can use <code>DirectoryList</code> to enumerate files in a specified directory.', '[ELMER] is capable of performing directory listings.', '[SUGARDUMP] can search for and collect data from specific Chrome, Opera, Microsoft Edge, and Firefox files, including any folders that have the string `Profile` in its name.', 'During [C0015] the threat actors conducted a file listing discovery against multiple hosts to ensure locker encryption was successful.', '[Fysbis] has the ability to search for files. ', '[Remsec] is capable of listing contents of folders on the victim. [Remsec] also searches for custom network encryption software on victims.', '[KillDisk] has used the <code>FindNextFile</code> command as part of its file deletion process.', 'During [Operation Honeybee] the threat actors used a malicious DLL to search for files with specific keywords.', '[WinMM] sets a WH_CBT Windows hook to search for and capture files on the victim.', '[Gamaredon Group] macros can scan for Microsoft Word and Excel files to inject with additional malicious macros. [Gamaredon Group] has also used its backdoors to automatically list interesting files (such as Office documents) found on a system.\t', '[Turian] can search for specific files and list directories.', '[POORAIM] can conduct file browsing.', ""[Micropsia] can perform a recursive directory listing for all volume drives available on the victim's machine and can also fetch specific files by their paths."", '[Misdat] is capable of running commands to obtain a list of files and directories, as well as enumerating logical drives.', '[Winnti for Windows] can check for the presence of specific files prior to moving to the next phase of execution.', ""[GeminiDuke] collects information from the victim, including installed drivers, programs previously executed by users, programs and services configured to automatically run at startup, files and folders present in any user's home folder, files and folders present in any user's My Documents, programs installed to the Program Files folder, and recently accessed files, folders, and programs."", '[BoxCaon] has searched for files on the system, such as documents located in the desktop folder.', 'During [Operation CuckooBees] the threat actors used `dir c:\\\\` to search for files.', '[njRAT] can browse file systems using a file manager module.', '[PinchDuke] searches for files created within a certain timeframe and whose file extension matches a predefined list.', '[WindTail] has the ability to enumerate the users home directory and the path to its own application bundle.', '[Dragonfly] has used a batch script to gather folder and file names from victim hosts.', '[AuditCred] can search through folders and files on the system.', '[Diavol] has a command to traverse the files and directories in a given path. ', '[Sliver] can enumerate files on a target system.', '[PowerDuke] has commands to get the current directory name as well as the size of a file. It also has commands to obtain information about logical drives, drive type, and free space.', '[BackConfig] has the ability to identify folders and files related to previous infections.\t', ""[Bankshot] searches for files on the victim's machine."", '[PingPull] can enumerate storage volumes and folder contents of a compromised host.', '[4H RAT] has the capability to obtain file and directory listings.', '[FALLCHILL] can search files on a victim.', '[MarkiRAT] can look for files carrying specific extensions such as: .rtf, .doc, .docx, .xls, .xlsx, .ppt, .pptx, .pps, .ppsx, .txt, .gpg, .pkr, .kdbx, .key, and .jpb.', '[Epic] recursively searches for all .doc files on the system and collects a directory listing of the Desktop, %TEMP%, and %WINDOWS%\\Temp directories.', '[Clambling] can browse directories on a compromised host.', '[down_new] has the ability to list the directories on a compromised host.', '[Ryuk] has enumerated files and folders on all mounted drives.\t', '[QakBot] can identify whether it has been run previously on a host by checking for a specified folder.', '[PoetRAT] has the ability to list files upon receiving the <code>ls</code> command from C2.', '[WhisperGate] can locate files based on hardcoded file extensions.', '[cmd] can be used to find files and directories with native functionality such as <code>dir</code> commands.', '[Seasalt] has the capability to identify the drive type on a victim.', '[APT38] have enumerated files and directories, or searched in specific locations within a compromised host.', '[APT28] has used [Forfiles] to locate PDF, Excel, and Word documents during collection. The group also searched a compromised DCCC computer for specific terms.', '[KEYMARBLE] has a command to search for files on the victim’s machine.', '[SHOTPUT] has a command to obtain a directory listing.', '[WINERACK] can enumerate files and directories.', '[Cardinal RAT] checks its current working directory upon execution and also contains watchdog functionality that ensures its executable is located in the correct path (else it will rewrite the payload).', '[OwaAuth] has a command to list its directory and logical drives.', '[RARSTONE] obtains installer properties from Uninstall Registry Key entries to obtain information about installed applications and how to uninstall certain applications.', '[Kivars] has the ability to list drives on the infected host.', '[BlackEnergy] gathers a list of installed apps from the uninstall program Registry. It also gathers registered mail, browser, and instant messaging clients from the Registry. [BlackEnergy] has searched for given file types.', '[NightClub] can use a file monitor to identify .lnk, .doc, .docx, .xls, .xslx, and .pdf files.', '[WannaCry] searches for variety of user files by file extension before encrypting them using RSA and AES, including Office, PDF, image, audio, video, source code, archive/compression format, and key and certificate files.', '[SoreFang] has the ability to list directories.', '[AutoIt backdoor] is capable of identifying documents on the victim with the following extensions: .doc; .pdf, .csv, .ppt, .docx, .pst, .xls, .xlsx, .pptx, and .jpeg.', '[Caterpillar WebShell] can search for files in directories. ', '[Inception] used a file listing plugin to collect information about file and directories both on local and remote drives.', ""[USBferry] can detect the victim's file or folder list.\t"", '[Avaddon] has searched for specific files prior to encryption.', '[Rclone] can list files and directories with the `ls`, `lsd`, and `lsl` commands.', '[SideTwist] has the ability to search for specific files.', '[GrimAgent] has the ability to enumerate files and directories on a compromised host.', '[Skidmap] has checked for the existence of specific files including <code>/usr/sbin/setenforce</code> and <code> /etc/selinux/config</code>. It also has the ability to monitor the cryptocurrency miner file and process.  ', '[zwShell] can browse the file system.', '[ZxShell] has a command to open a file manager and explorer on the system. ', '[DropBook] can collect the names of all files and folders in the Program Files directories. ', '[TSCookie] has the ability to discover drive information on the infected host.', '[Kwampirs] collects a list of files and directories in C:\\ with the command <code>dir /s /a c:\\ >> ""C:\\windows\\TEMP\\[RANDOM].tmp""</code>.', '[JPIN] can enumerate drives and their types. It can also change file permissions using cacls.exe.', '[ZLib] has the ability to enumerate files and drives.', '[FLASHFLOOD] searches for interesting files (either a default or customized set of file extensions) on the local system and removable media.', '[Lokibot] can search for specific files on an infected host.', '[HOPLIGHT] has been observed enumerating system drives and partitions.\t', '[Chimera] has utilized multiple commands to identify data of interest in file and directory listings.', '[BadPatch] searches for files with specific file extensions.', ""[NETEAGLE] allows adversaries to enumerate and modify the infected host's file system. It supports searching for directories, creating directories, listing directory contents, reading and writing to files, retrieving file attributes, and retrieving volume information."", '[SysUpdate] can search files on a compromised host.', '[BabyShark] has used <code>dir</code> to search for ""programfiles"" and ""appdata"".\t', '[admin@338] actors used the following commands after exploiting a machine with [LOWBALL] malware to obtain information about files and directories: <code>dir c:\\ >> %temp%\\download</code> <code>dir ""c:\\Documents and Settings"" >> %temp%\\download</code> <code>dir ""c:\\Program Files\\"" >> %temp%\\download</code> <code>dir d:\\ >> %temp%\\download</code>', '[MoonWind] has a command to return a directory listing for a specified directory.', '[Ke3chang] uses command-line interaction to search files and directories.', '[MegaCortex] can parse the available drives and directories to determine which files to encrypt. ', '[Pteranodon] identifies files matching certain file extension and copies them to subdirectories it created.', '[CookieMiner] has looked for files in the user\'s home directory with ""wallet"" in their name using <code>find</code>.', '[CrossRAT] can list all files on a system.', '[DEATHRANSOM] can use loop operations to enumerate directories on a compromised host.', '[InnaputRAT] enumerates directories and obtains file attributes on a system.', '[SUNBURST] had commands to enumerate files and directories.', '[Cuba] can enumerate files by using a variety of functions.', '[Linfo] creates a backdoor through which remote attackers can list contents of drives and search for files.', '[CosmicDuke] searches attached and mounted drives for file extensions and keywords that match a predefined list.', '[Sandworm Team] has enumerated files on a compromised host.', '[Kazuar] finds a specified directory, lists the files and metadata about those files.', '[XAgentOSX] contains the readFiles function to return a detailed listing (sometimes recursive) of a specified directory. [XAgentOSX] contains the showBackupIosFolder function to check for IOS device backups by running <code>ls -la ~/Library/Application\\ Support/MobileSync/Backup/</code>.', '[HermeticWiper] can enumerate common folders such as My Documents, Desktop, and AppData.', '[Cyclops Blink] can use the Linux API `statvfs` to enumerate the current working directory.', '[FIVEHANDS] has the ability to enumerate files on a compromised host in order to encrypt files with specific extensions.', '[Black Basta] can enumerate specific files for encryption.', '[Cobalt Strike] can explore files on a compromised system.', '[DarkWatchman] has the ability to enumerate file and folder names.', '[Industroyer] data wiper component enumerates specific files on all the Windows drives.', '[Brave Prince] gathers file and directory information from the victim’s machine.', '[OceanSalt] can extract drive information from the endpoint and search files on the system.', '[NETWIRE] has the ability to search for files on the compromised host.', '[Sidewinder] has used malware to collect information on files and directories.', '[TINYTYPHON] searches through the drive containing the OS, then all drive letters C through to Z, for documents matching certain extensions.', '[Octopus] can collect information on the Windows directory and searches for compressed RAR files on the host.', '[SUNSPOT] enumerated the Orion software Visual Studio solution directory path.', '[Zox] can enumerate files on a compromised host.', 'A variant of [Elise] executes <code>dir C:\\progra~1</code> when initially run.', '[Bisonal] can retrieve a file listing from the system. ', '[MiniDuke] can enumerate local drives.', '[Conti] can discover files on a local system.', '[SLOTHFULMEDIA] can enumerate files and directories.', '[ADVSTORESHELL] can list files and directories.', '[FinFisher] enumerates directories and scans for certain files.', '[Avenger] has the ability to browse files in directories such as Program Files and the Desktop. ', ""[CharmPower] can enumerate drives and list the contents of the C: drive on a victim's computer."", '[REvil] has the ability to identify specific files and directories that are not to be encrypted.', 'During the [SolarWinds Compromise] [APT29] obtained information about the configured Exchange virtual directory using `Get-WebServicesVirtualDirectory`.', '[Empire] includes various modules for finding files of interest on hosts and network shares.', '[Pupy] can walk through directories and recursively search for strings in files.', '[Gelsemium] can retrieve data from specific Windows directories, as well as open random files as part of [Virtualization/Sandbox Evasion]', '[Aoqin Dragon] has run scripts to identify file formats including Microsoft Word.', '[Proxysvc] lists files in directories.', ""[Tropic Trooper] has monitored files' modified time.\t"", '[Dark Caracal] collected file listings of all default Windows directories.', '[GravityRAT] collects the volumes mapped on the system, and also steals files with the following extensions: .docx, .doc, .pptx, .ppt, .xlsx, .xls, .rtf, and .pdf.', '[Bandook] has a command to list files on a system.', '[MuddyWater] has used malware that checked if the ProgramData folder had folders or files with the keywords ""Kasper,"" ""Panda,"" or ""ESET.""', '[Trojan.Karagany] can enumerate files and directories on a compromised host.', '[PoshC2] can enumerate files on the local file system and includes a module for enumerating recently accessed files.', '[3PARA RAT] has a command to retrieve metadata for files on disk as well as a command to list the current working directory.', '[NotPetya] searches for files ending with dozens of different file extensions prior to encryption.', '[ThreatNeedle] can obtain file and directory information.', '[BoomBox] can search for specific files and directories on a machine.', '[jRAT] can browse file systems.', '[Clop] has searched folders and subfolders for files to encrypt.', '[GoldenSpy] has included a program ""ExeProtector"", which monitors for the existence of [GoldenSpy] on the infected system and redownloads if necessary.\t', '[OutSteel] can search for specific file extensions, including zipped files.', '[FYAnti] can search the <code>C:\\Windows\\Microsoft.NET\\</code> directory for files of a specified size.', '[BADFLICK] has searched for files on the infected host.', '[CaddyWiper] can enumerate all files and directories on a compromised host.', '[Stuxnet] uses a driver to scan for specific filesystem driver objects.', 'An older version of [CHOPSTICK] has a module that monitors all mounted volumes for files with the extensions .doc, .docx, .pgp, .gpg, .m2f, or .m2o.', '[Zebrocy] searches for files that are 60mb and less and contain the following extensions: .doc, .docx, .xls, .xlsx, .ppt, .pptx, .exe, .zip, and .rar. [Zebrocy] also runs the <code>echo %APPDATA%</code> command to list the contents of the directory. [Zebrocy] can obtain the current execution path as well as perform drive enumeration. ', '[AvosLocker] has searched for files and directories on a compromised network.', ""[Magic Hound] malware can list a victim's logical drives and the type, as well the total/free space of the fixed devices. Other malware can list a directory's contents."", '[PLEAD] has the ability to list drives and files on the compromised host.', '[Okrum] has used DriveLetterView to enumerate drive information.', '[ObliqueRAT] has the ability to recursively enumerate files on an infected endpoint.', '[BBSRAT] can list file and directory information.', '[StrongPity] can parse the hard drive on a compromised host to identify specific file extensions.', '[QuietSieve] can search files on the target host by extension, including doc, docx, xls, rtf, odt, txt, jpg, pdf, rar, zip, and 7z. ', '[ROKRAT] has the ability to gather a list of files and directories on the infected system.', '[TeamTNT] has used a script that checks `/proc/*/environ` for environment variables related to AWS.', '[HotCroissant] has the ability to retrieve a list of files in a given directory as well as drives and drive types.', '[Peppy] can identify specific files for exfiltration.', '[Psylo] has commands to enumerate all storage devices and to find all files that start with a particular string.', '[Doki] has resolved the path of a process PID to use as a script argument.', '[Koadic] can obtain a list of directories.', '[BlackMould] has the ability to find files on the targeted system.', '[CreepyDrive] can specify the local file path to upload files from.', '[LuminousMoth] has used malware that scans for files in the Documents, Desktop, and Download folders and in other drives.', 'During [Operation Wocao] threat actors gathered a recursive directory listing to find files and directories of interest.', '[POWRUNER] may enumerate user directories on a victim.', '[KeyBoy] has a command to launch a file browser or explorer on the system.', '[Dtrack] can list files on available disk volumes.', '[BACKSPACE] allows adversaries to search for files.', '[DDKONG] lists files on the victim’s machine.', '[Denis] has several commands to search directories for files.', '[OSX/Shlayer] has used the command <code>appDir=""$(dirname $(dirname ""$currentDir""))""</code> and <code>$(dirname ""$(pwd -P)"")</code> to construct installation paths.', '[Heyoka Backdoor] has the ability to search the compromised host for files.', '[Forfiles] can be used to locate certain types of files/directories in a system.(ex: locate all files with a specific extension, name, and/or age)', '[Cryptoistic] can scan a directory to identify files for deletion.', '[CORALDECK] searches for specified files.', '[HTTPBrowser] is capable of listing files, folders, and drives on a victim.', 'During [Operation Dream Job] [Lazarus Group] conducted word searches within documents on a compromised host in search of security and financial matters.', ""[ChChes] collects the victim's %TEMP% directory path and version of Internet Explorer."", '[APT3] has a tool that looks for files and directories on the local file system.', '[APT32] backdoor possesses the capability to list files and directories on a machine. \t ', '[Mustang Panda] has searched the entire target system for DOC, DOCX, PPT, PPTX, XLS, XLSX, and PDF files.', '[Pasam] creates a backdoor through which remote attackers can retrieve lists of files.', '[metaMain] can recursively enumerate files in an operator-provided directory.', '[RainyDay] can use a file exfiltration tool to collect recently changed files with specific extensions.', '[InvisiMole] can list information about files in a directory and recently opened or used documents. [InvisiMole] can also search for specific files by supplied file mask.', 'During [Night Dragon] threat actors used [zwShell] to establish full remote control of the connected machine and browse the victim file system.', '[Gold Dragon] lists the directories for Desktop, program files, and the user’s recently accessed files.', '[AppleSeed] has the ability to search for .txt, .ppt, .hwp, .pdf, and .doc files in specified directories.', '[CrackMapExec] can discover specified filetypes and log files on a targeted system.', '[FoggyWeb] loader can check for the [FoggyWeb] backdoor .pri file on a compromised AD FS server.', '[Cannon] can obtain victim drive information as well as a list of folders in C:\\Program Files.', '[KGH_SPY] can enumerate files and directories on a compromised host.', '[WastedLocker] can enumerate files and directories just prior to encryption.', '[NDiskMonitor] can obtain a list of all files and directories as well as logical drives.', '[Ixeshe] can list file and directory information.', '[Backdoor.Oldrea] collects information about available drives, default browser, desktop file list, My Documents, Internet history, program files, and root of available drives. It also searches for ICS-related software files.', '[Derusbi] is capable of obtaining directory, file, and drive listings.', ' [Siloscape] searches for the Kubernetes config file and other related files using a regular expression. ', '[APT39] has used tools with the ability to search for files on a compromised host.', '[StrifeWater] can enumerate files on a compromised host.', '[MobileOrder] has a command to upload to its C2 server information about files on the victim mobile device, including SD card size, installed app list, SMS content, contacts, and calling history.', '[BLUELIGHT] can enumerate files and collect associated metadata.', '[ccf32] can parse collected files to identify specific file extensions.', '[Lazarus Group] malware can use a common function to identify target files by their extension, and some also enumerate files and directories, including a Destover-like variant that lists files and gathers information for all drives.', '[SILENTTRINITY] has several modules, such as `ls.py`, `pwd.py`, and `recentFiles.py`, to enumerate directories and files. ', '[Darkhotel] has used malware that searched for files with specific patterns.', '[TajMahal] has the ability to index files from drives, user profiles, and removable drives.', '[Prestige] can traverse the file system to discover files to encrypt by identifying specific extensions defined in a hardcoded list.', '[SOUNDBITE] is capable of enumerating and manipulating files and directories.', '[RemoteUtilities] can enumerate files and directories on a target machine.', '[Hydraq] creates a backdoor through which remote attackers can check for the existence of files, including its own components, as well as retrieve a list of logical drives.', '[StreamEx] has the ability to enumerate drive types.', '[Taidoor] can search for specific files.', '[menuPass] has searched compromised systems for folders of interest including those related to HR, audit and expense, and meeting memos.', '[BLINDINGCAN] can search, read, write, move, and execute files.', '[TrickBot] searches the system for all of the following file extensions: .avi, .mov, .mkv, .mpeg, .mpeg4, .mp4, .mp3, .wav, .ogg, .jpeg, .jpg, .png, .bmp, .gif, .tiff, .ico, .xlsx, and .zip. It can also obtain browsing history, cookies, and plug-in information.', '[Remcos] can search for files on the infected machine.', '[Mafalda] can search for files and directories.', '[LookBack] can retrieve file listings from the victim machine.', '[Aria-body] has the ability to gather metadata from a file and to search for file and directory names.', '[Kasidet] has the ability to search for a given filename on a victim.', '[Kimsuky] has the ability to enumerate all files and directories on an infected system.', '[Ramsay] can collect directory and file lists.\t', 'The [IceApple] Directory Lister module can list information about files and directories including creation time, last write time, name, and size.', '[Action RAT] has the ability to collect drive and file information on an infected machine.', '[HAFNIUM] has searched file contents on a compromised host.', '[Rising Sun] can enumerate information about files from the infected system, including file size, attributes, creation time, last access time, and write time. [Rising Sun] can enumerate the compilation timestamp of Windows executable files.\t', '[SPACESHIP] identifies files and directories for collection by searching for specific file extensions or file modification time.', '[Penquin] can use the command code <code>do_vslist</code> to send file names, size, and status to C2.', '[Machete] produces file listings in order to search for files to be exfiltrated.', '[RTM] can check for specific files and directories associated with virtualization and malware analysis.', 'A version of [KONNI] searches for filenames created with a previous version of the malware, suggesting different versions targeted the same victims and the versions may work together.', '[RedLeaves] can enumerate and search for files and directories.', '[Confucius] has used a file stealer that checks the Document, Downloads, Desktop, and Picture folders for documents and images with specific extensions.', '[WarzoneRAT] can enumerate directories on a compromise host.', '[APT41] has executed <code>file /bin/pwd</code> on exploited victims, perhaps to return architecture related information.', '[Winnti Group] has used a program named ff.exe to search for specific documents on compromised hosts.', '[Saint Bot] can search a compromised host for specific files.', '[Nebulae] can list files and directories on a compromised host.', '[FruitFly] looks for specific files and file types.', '[XCSSET] has used `mdfind` to enumerate a list of apps known to grant screen sharing permissions.', '[Azorult] can recursively search for files in folders and collects files from the desktop with certain extensions.', '[Remexi] searches for files on the system. ', '[Windigo] has used a script to check for the presence of files created by OpenSSH backdoors.', '[SombRAT] can execute <code>enum</code> to enumerate files in storage on a compromised system.', '[APT18] can list files information for specific directories.', 'A module in [Prikormka] collects information about the paths, size, and creation time of files with specific file extensions, but not the actual content of the file.', '[Dacls] can scan directories on a compromised host.', '[Imminent Monitor] has a dynamic debugging feature to check whether it is located in the %TEMP% directory, otherwise it copies itself there.', '[Zeus Panda] searches for specific directories on the victim’s machine.', '[Rover] automatically searches for files on local drives based on a predefined list of file extensions.', '[FatDuke] can enumerate directories on target machines.', '[ShimRat] can list directories.', '[Pisloader] has commands to list drives on the victim machine and to list file information for a given directory.', '[Fox Kitten] has used WizTree to obtain network files and directory listings.', '[MacMa] can search for a specific file on the compromised computer and can enumerate files in Desktop, Downloads, and Documents folders.', '[Royal] can identify specific files and directories to exclude from the encryption process.', '[Metamorfo] has searched the Program Files directories for specific folders and has searched for strings related to its mutexes. ', '[SharpDisco] can identify recently opened files by using an LNK format parser to extract the original file path from LNK files found in either `%USERPROFILE%\\Recent` (Windows XP) or `%APPDATA%\\Microsoft\\Windows\\Recent` (newer Windows versions) .', '[BlackCat] can enumerate files for encryption.', '[Smoke Loader] recursively searches through directories for files.', ""[UPPERCUT] has the capability to gather the victim's current directory."", '[BADNEWS] identifies files with certain extensions from USB devices, then copies them to a predefined directory.', '[Leafminer] used a tool called MailSniper to search for files on the desktop and another utility called Sobolsoft to extract attachments from EML files.', '[DustySky] scans the victim for files that contain certain keywords and document types including PDF, DOC, DOCX, XLS, and XLSX, from a list that is obtained from the C2 as a text file. It can also identify logical drives for the infected machine.', ""[FIN13] has used the Windows `dir` command to enumerate files and directories in a victim's network."", '[MESSAGETAP] checks for the existence of two configuration files (keyword_parm.txt and parm.txt) and attempts to read the files every 30 seconds.', ""[Turla] surveys a system upon check-in to discover files in specific locations on the hard disk %TEMP% directory, the current user's desktop, the Program Files directory, and Recent. [Turla] RPC backdoors have also searched for files matching the <code>lPH*.dll</code> pattern."", '[Babuk] has the ability to enumerate files on a targeted system.', '[China Chopper] server component can list directory contents.', '[FunnyDream] can identify files with .doc, .docx, .ppt, .pptx, .xls, .xlsx, and .pdf extensions and specific timestamps for collection.', '[BRONZE BUTLER] has collected a list of files from the victim and uploaded it to its C2 server, and then created a new list of specific files to steal.', '[Uroburos] can search for specific files on a compromised system.', '[TYPEFRAME] can search directories for files on the victim’s machine.', '[UNC2452] obtained information about the configured Exchange virtual directory using <code>Get-WebServicesVirtualDirectory</code>.', '[APT29] obtained information about the configured Exchange virtual directory using <code>Get-WebServicesVirtualDirectory</code>.', '[Operation Wocao] has gathered a recursive directory listing to find files and directories of interest.', '[Honeybee] service-based DLL implant traverses the FTP server’s directories looking for files with keyword matches for computer names or certain keywords.', '[Dust Storm] has used Android backdoors capable of enumerating specific files on the infected devices.', '[Dragonfly 2.0] used a batch script to gather folder and file names from victim hosts.', '[Shamoon] attempts to access the <code>ADMIN$</code>, <code>C$\\Windows</code>, <code>D$\\Windows</code>, and <code>E$\\Windows</code> shares on the victim with its current privileges.']"
T1647,Plist File Modification,"Adversaries may modify property list files (plist files) to enable other malicious activity, while also potentially evading and bypassing system defenses. macOS applications use plist files, such as the <code>info.plist</code> file, to store properties and configuration settings that inform the operating system how to handle the application at runtime. Plist files are structured metadata in key-value pairs formatted in XML based on Apple's Core Foundation DTD. Plist files can be saved in text or binary format.   Adversaries can modify key-value pairs in plist files to influence system behaviors, such as hiding the execution of an application (i.e. [Hidden Window] or running additional commands for persistence (ex: [Launch Agent] Daemon] or [Re-opened Applications]  For example, adversaries can add a malicious application path to the `~/Library/Preferences/com.apple.dock.plist` file, which controls apps that appear in the Dock. Adversaries can also modify the <code>LSUIElement</code> key in an application’s <code>info.plist</code> file  to run the app in the background. Adversaries can also insert key-value pairs to insert environment variables, such as <code>LSEnvironment</code>, to enable persistence via [Dynamic Linker Hijacking]","['[XCSSET] uses the <code>plutil</code> command to modify the <code>LSUIElement</code>, <code>DFBundleDisplayName</code>, and <code>CFBundleIdentifier</code> keys in the <code>/Contents/Info.plist</code> file to change how [XCSSET] is visible on the system.']"
T1049,System Network Connections Discovery,"Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network.   An adversary who gains access to a system that is part of a cloud-based environment may map out Virtual Private Clouds or Virtual Networks in order to determine what systems and services are connected. The actions performed are likely the same types of discovery techniques depending on the operating system, but the resulting information may include details about the networked cloud environment relevant to the adversary's goals. Cloud providers may have different ways in which their virtual networks operate. Similarly, adversaries who gain access to network devices may also perform similar discovery activities to gather information about connected systems and services.  Utilities and commands that acquire this information include [netstat] ""net use,"" and ""net session"" with [Net] In Mac and Linux, [netstat] and <code>lsof</code> can be used to list current connections. <code>who -a</code> and <code>w</code> can be used to show which users are currently logged in, similar to ""net session"". Additionally, built-in features native to network devices and [Network Device CLI] may be used (e.g. <code>show ip sockets</code>, <code>show tcp brief</code>).","['[Lucifer] can identify the IP and port numbers for all remote connections from the compromised host.', '[Trojan.Karagany] can use [netstat] to collect a list of network connections.', '[Babuk] can use “WNetOpenEnumW” and “WNetEnumResourceW” to enumerate files in network resources for encryption.', '[APT38] installed a port monitoring tool, MAPMAKER, to print the active TCP connections on the local system.', '[menuPass] has used <code>net use</code> to conduct connectivity checks to machines.', '[ShimRatReporter] used the Windows function <code>GetExtendedUdpTable</code> to detect connected UDP endpoints.', '[Zebrocy] uses <code>netstat -aon</code> to gather network connection information.', '[PoshC2] contains an implementation of [netstat] to enumerate TCP and UDP connections.', '[Poseidon Group] obtains and saves information about victim network interfaces and addresses.', '[Remsec] can obtain a list of active connections and open ports.', 'During [Operation Wocao] threat actors collected a list of open connections on the infected system using `netstat` and checks whether it has an internet connection.', '[GravityRAT] uses the <code>netstat</code> command to find open ports on the victim’s machine.', '[netstat] can be used to enumerate local network connections, including active TCP connections and other network statistics.', ""[KONNI] has used <code>net session</code> on the victim's machine. "", '[TeamTNT] has run <code>netstat -anp</code> to search for rival malware connections. [TeamTNT] has also used `libprocesshider` to modify <code>/etc/ld.so.preload</code>.', ""[Andariel] has used the <code>netstat -naop tcp</code> command to display TCP connections on a victim's machine."", '[Mustang Panda] has used <code>netstat -ano</code> to determine network connection information.', '[CrackMapExec] can discover active sessions for a targeted system.', '[Maze] has used the ""WNetOpenEnumW"", ""WNetEnumResourceW”, “WNetCloseEnum” and “WNetAddConnection2W” functions to enumerate the network resources on the infected machine.', '[RATANKBA] uses <code>netstat -ano</code> to search for specific IP address ranges.', '[Turla] surveys a system upon check-in to discover active local network connections using the <code>netstat -an</code>, <code>net use</code>, <code>net file</code>, and <code>net session</code> commands. [Turla] RPC backdoors have also enumerated the IPv4 TCP connection table via the <code>GetTcpTable2</code> API call.', '[Carbon] uses the <code>netstat -r</code> and <code>netstat -an</code> commands.', '[Machete] uses the <code>netsh wlan show networks mode=bssid</code> and <code>netsh wlan show interfaces</code> commands to list all nearby WiFi networks and connected interfaces. ', '[Torisma] can use `WTSEnumerateSessionsW` to monitor remote desktop connections.', '[Cobalt Strike] can produce a sessions report from compromised hosts.', 'Commands such as <code>net use</code> and <code>net session</code> can be used in [Net] to gather information about network connections from a particular host.', '[APT3] has a tool that can enumerate current network connections.', '[BlackEnergy] has gathered information about local network connections using [netstat]', '[Dtrack] can collect network and active connection information.', ' [Volt Typhoon] has used `netstat -ano` on compromised hosts to enumerate network connections.                                                   ', ""[Sandworm Team] had gathered user, IP address, and server data related to RDP sessions on a compromised host. It has also accessed network diagram files useful for understanding how a host's network was configured. "", '[Epic] uses the <code>net use</code>, <code>net session</code>, and <code>netstat</code> commands to gather information on network connections.', '[Comnie] executes the <code>netstat -ano</code> command.', 'Once inside a Virtual Private Cloud, [Pacu] can attempt to identify DirectConnect, VPN, or VPC Peering.', '[Egregor] can enumerate all connected drives.', '[Mafalda] can use the <code>GetExtendedTcpTable</code> function to retrieve information about established TCP connections.', ""[Cuba] can use the function <code>GetIpNetTable</code> to recover the last connections to the victim's machine. "", '[NETWIRE] can capture session logon details from a compromised host.', '[OSInfo] enumerates the current network connections similar to <code> net use </code>.', '[Sykipot] may use <code>netstat -ano</code> to display active network connections.', '[PyDCrypt] has used [netsh] to find RPC connections on remote machines.', '[APT1] used the <code>net use</code> command to get a listing on network connections.', '[Waterbear] can use API hooks on `GetExtendedTcpTable` to retrieve a table containing a list of TCP endpoints available to the application. ', '[PlugX] has a module for enumerating TCP and UDP network connections and associated processes using the <code>netstat</code> command.', '[OilRig] has used <code>netstat -an</code> on a victim to get a listing of network connections.', 'The discovery modules used with [Duqu] can collect information on network connections.', '[Magic Hound] has used quser.exe to identify existing RDP connections.', '[nbtstat] can be used to discover current NetBIOS sessions.', '[Chimera] has used <code>netstat -ano | findstr EST</code> to discover network connections.', '[MuddyWater] has used a PowerShell backdoor to check for Skype connections on the target machine.', '[SLOTHFULMEDIA] can enumerate open ports on a victim machine.', '[admin@338] actors used the following command following exploitation of a machine with [LOWBALL] malware to display network connections: <code>netstat -ano >> %temp%\\download</code>', '[GALLIUM] used <code>netstat -oan</code> to obtain information about the victim network connections.', '[CharmPower] can use `netsh wlan show profiles` to list specific Wi-Fi profile details.', '[SHOTPUT] uses [netstat] to list TCP connection status.', '[APT41] has enumerated IP addresses of network resources and used the <code>netstat</code> command as part of network reconnaissance. The group has also used a malware variant, HIGHNOON, to enumerate active RDP sessions.', '[Conti] can enumerate routine network connections from a compromised host.', 'After loading the keyword and phone data files, [MESSAGETAP] begins monitoring all network connections to and from the victim server. ', 'During [Operation CuckooBees] the threat actors used the `net session`, `net use`, and `netstat` commands as part of their advanced reconnaissance.', '[Kwampirs] collects a list of active and listening connections by using the command <code>netstat -nao</code> as well as a list of available network mappings with <code>net use</code>.', '[Empire] can enumerate the current network connections of a host.', 'During [FunnyDream] the threat actors used [netstat] to discover network connections on remote systems.', '[KOPILUWAK] can use [netstat] [Arp] and [Net] to discover current TCP connections.', '[HEXANE] has used [netstat] to monitor connections to specific ports.', '[Sibot] has retrieved a GUID associated with a present LAN connection on a compromised machine.', '[SpeakUp] uses the <code>arp -a</code> command. ', '[BackdoorDiplomacy] has used NetCat and PortQry  to enumerate network connections and display the status of related TCP and UDP ports.', '[Okrum] was seen using NetSess to discover NetBIOS sessions.', ""[APT32] used the <code>netstat -anpo tcp</code> command to display TCP connections on the victim's machine."", '[Earth Lusca] employed a PowerShell script called RDPConnectionParser to read and filter the Windows event log “Microsoft-Windows-TerminalServices-RDPClient/Operational” (Event ID 1024) to obtain network information from RDP connections. [Earth Lusca] has also used [netstat] from a compromised system to obtain network connection information.', '[Tropic Trooper] has tested if the localhost network is available and other connection capability on an infected system using command scripts.\t', '[POWRUNER] may collect active network connections by running <code>netstat -an</code> on a victim.', '[USBferry] can use <code>netstat</code> and <code>nbtstat</code> to detect active network connections.\t', '[Flagpro] has been used to execute <code>netstat -ano</code> on a compromised host.', '[QakBot] can use <code>netstat</code> to enumerate current network connections.', '[Ke3chang] performs local network connection discovery using <code>netstat</code>.', '[BADHATCH] can execute `netstat.exe -f` on a compromised machine.', '[Pupy] has a built-in utility command for <code>netstat</code>, can do net session through PowerView, and has an interactive shell which can be used to discover additional information.', '[jRAT] can list network connections.', '[Ramsay] can use <code>netstat</code> to enumerate network connections.', '[RedLeaves] can enumerate drives and Remote Desktop sessions.', '[Volgmer] can gather information about TCP connection state.', '[Sardonic] has the ability to execute the `netstat` command.', '[Lazarus Group] has used <code>net use</code> to identify and establish a network connection with a remote host.', '[FIN13] has used `netstat` and other net  commands for network reconnaissance efforts.', '[Sliver] can collect network connection information.', '[Threat Group-3390] has used `net use` and `netstat` to conduct internal discovery of systems. The group has also used `quser.exe` to identify existing RDP sessions on a victim.', '[Aria-body] has the ability to gather TCP and UDP table status listings.', '[Lizar] has a plugin to retrieve information about all active network sessions on the infected server.', '[Operation Wocao] has collected a list of open connections on the infected system using netstat and checks whether it has an internet connection.']"
T1528,Steal Application Access Token,"Adversaries can steal application access tokens as a means of acquiring credentials to access remote systems and resources.  Application access tokens are used to make authorized API requests on behalf of a user or service and are commonly used as a way to access resources in cloud and container-based applications and software-as-a-service (SaaS). OAuth is one commonly implemented framework that issues tokens to users for access to systems. Adversaries who steal account API tokens in cloud and containerized environments may be able to access data and perform actions with the permissions of these accounts, which can lead to privilege escalation and further compromise of the environment.  In Kubernetes environments, processes running inside a container communicate with the Kubernetes API server using service account tokens. If a container is compromised, an attacker may be able to steal the container’s token and thereby gain access to Kubernetes API commands.  Token theft can also occur through social engineering, in which case user action may be required to grant access. An application desiring access to cloud-based services or protected APIs can gain entry using OAuth 2.0 through a variety of authorization protocols. An example commonly-used sequence is Microsoft's Authorization Code Grant flow. An OAuth access token enables a third-party application to interact with resources containing user data in the ways requested by the application without obtaining user credentials.    Adversaries can leverage OAuth authorization by constructing a malicious application designed to be granted access to resources with the target user's OAuth token. The adversary will need to complete registration of their application with the authorization server, for example Microsoft Identity Platform using Azure Portal, the Visual Studio IDE, the command-line interface, PowerShell, or REST API calls. Then, they can send a [Spearphishing Link] to the target user to entice them to grant access to the application. Once the OAuth access token is granted, the application can gain potentially long-term access to features of the user account through [Application Access Token]  Application access tokens may function within a limited lifetime, limiting how long an adversary can utilize the stolen token. However, in some cases, adversaries can also steal application refresh tokens, allowing them to obtain new access tokens without prompting the user.    ","['[Peirates] gathers Kubernetes service account tokens using a variety of techniques.', '[AADInternals] can steal users’ access tokens via phishing emails containing malicious links.', '[APT28] has used several malicious applications to steal user OAuth access tokens including applications masquerading as ""Google Defender"" ""Google Email Protection,"" and ""Google Scanner"" for Gmail users. They also targeted Yahoo users with applications masquerading as ""Delivery Service"" and ""McAfee Email Protection"".']"
T1057,Process Discovery,"Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Adversaries may use the information from [Process Discovery] during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.  In Windows environments, adversaries could obtain details on running processes using the [Tasklist] utility via [cmd] or <code>Get-Process</code> via [PowerShell] Information about processes can also be extracted from the output of [Native API] calls such as <code>CreateToolhelp32Snapshot</code>. In Mac and Linux, this is accomplished with the <code>ps</code> command. Adversaries may also opt to enumerate processes via /proc.  On network devices, [Network Device CLI] commands such as `show processes` can be used to display current running processes.","['[Epic] uses the <code>tasklist /v</code> command to obtain a list of processes.', '[WarzoneRAT] can obtain a list of processes on a compromised host.', '[FELIXROOT] collects a list of running processes.', 'During [Frankenstein] the threat actors used [Empire] to obtain a list of all running processes.', '[Windshift] has used malware to enumerate active processes.', '[SUNSPOT] monitored running processes for instances of <code>MsBuild.exe</code> by hashing the name of each running process and comparing it to the corresponding value <code>0x53D525</code>. It also extracted command-line arguments and individual arguments from the running <code>MsBuild.exe</code> process to identify the directory path of the Orion software Visual Studio solution.', '[StreamEx] has the ability to enumerate processes.', '[Aria-body] has the ability to enumerate loaded modules for a process..', '[Volt Typhoon] has enumerated running processes on targeted systems.', '[MoonWind] has a command to return a list of running processes.', '[Zebrocy] uses the <code>tasklist</code> and <code>wmic process get Capture, ExecutablePath</code> commands to gather the processes running on the system.', '[IronNetInjector] can identify processes via C# methods such as <code>GetProcessesByName</code> and running [Tasklist] with the Python <code>os.popen</code> function.', '[FruitFly] has the ability to list processes on the system.', '[Cannon] can obtain a list of processes running on the system.', '[LoudMiner] used the <code>ps</code> command to monitor the running processes on the system.\t', '[WinMM] sets a WH_CBT Windows hook to collect information on process creation.', '[ZxxZ] has created a snapshot of running processes using `CreateToolhelp32Snapshot`.', '[Grandoreiro] can identify installed security tools based on process names.', '[KEYMARBLE] can obtain a list of running processes on the system.', '[WINERACK] can enumerate processes.', '[NETEAGLE] can send process listings over the C2 channel.', '[Tropic Trooper] is capable of enumerating the running processes on the system using <code>pslist</code>.', '[SombRAT] can use the <code>getprocesslist</code> command to enumerate processes on a compromised host.', '[Ryuk] has called <code>CreateToolhelp32Snapshot</code> to enumerate all running processes.', '[JHUHUGIT] obtains a list of running processes on the victim.', 'During the [SolarWinds Compromise] [APT29] used multiple command-line utilities to enumerate running processes.', '[Bisonal] can obtain a list of running processes on the victim’s machine.', '[Valak] has the ability to enumerate running processes on a compromised host.', '[TSCookie] has the ability to list processes on the infected host.', '[PcShare] can obtain a list of running processes on a compromised host.', '[Ixeshe] can list running processes.', '[Bundlore] has used the <code>ps</code> command to list processes.', ""[Sidewinder] has used tools to identify running processes on the victim's machine."", '[SoreFang] can enumerate processes on a victim machine through use of [Tasklist]', '[Orz] can gather a process list from the victim.', '[Deep Panda] uses the Microsoft [Tasklist] utility to list processes running on systems.', '[Lucifer] can identify the process that owns remote connections.', '[Machete] has a component to check for running processes to look for web browsers. ', '[JPIN] can list running processes.', '[BADHATCH] can retrieve a list of running processes from a compromised machine. ', '[SysUpdate] can collect information about running processes.', '[RCSession] can identify processes based on PID.', '[EKANS] looks for processes from a hard-coded list.', '[BlackEnergy] has gathered a process list by using [Tasklist]', '[Brave Prince] lists the running processes.', '[Fysbis] can collect information about running processes. ', '[Remsec] can obtain a process list from the victim.', '[Diavol] has used `CreateToolhelp32Snapshot`, `Process32First`, and `Process32Next` API calls to enumerate the running processes in the system.', '[Tasklist] can be used to discover processes running on a system.', '[Caterpillar WebShell] can gather a list of processes running on the machine. ', '[GeminiDuke] collects information on running processes and environment variables from the victim.', '[Astaroth] searches for different processes on the system.', '[Woody RAT] can call `NtQuerySystemProcessInformation` with `SystemProcessInformation` to enumerate all running processes, including associated information such as PID, parent PID, image name, and owner.', '[Bankshot] identifies processes and collects the process ids.', '[APT1] gathered a list of running processes on the system using <code>tasklist /v</code>.', '[metaMain] can enumerate the processes that run on the platform.', '[Zeus Panda] checks for running processes on the victim’s machine.', 'The discovery modules used with [Duqu] can collect information on process details.', '[Comnie] uses the <code>tasklist</code> to view running processes on the victim’s machine.', '[Dacls] can collect data on running and parent processes.', '[POWRUNER] may collect process information by running <code>tasklist</code> on a victim.', '[TAINTEDSCRIBE] can execute <code>ProcessList</code> for process discovery.', '[Ursnif] has gathered information about running processes.', '[Agent Tesla] can list the current running processes on the system.', '[Final1stspy] obtains a list of running processes.', '[Sykipot] may gather a list of running processes by running <code>tasklist /v</code>.', '[Imminent Monitor] has a ""Process Watcher"" feature to monitor processes in case the client ever crashes or gets closed.', '[PowerShower] has the ability to deploy a reconnaissance module to retrieve a list of the active processes.', '[HAFNIUM] has used `tasklist` to enumerate processes.', '[Darkhotel] malware can collect a list of running processes on a system.', '[Elise] enumerates processes via the <code>tasklist</code> command.', '[AppleSeed] can enumerate the current process on a compromised host.', '[Avenger] has the ability to use [Tasklist] to identify running processes.', '[PlugX] has a module to list the processes running on a machine.', '[Seasalt] has a command to perform a process listing.', '[Kasidet] has the ability to search for a given process name in processes currently running in the system.', '[Stealth Falcon] malware gathers a list of running processes.', '[TeamTNT] has searched for rival malware and removes it if found. [TeamTNT] has also searched for running processes containing the strings aliyun or liyun to identify machines running Alibaba Cloud Security tools.', '[Javali] can monitor processes for open browsers and custom banking applications.', '[Trojan.Karagany] can use [Tasklist] to collect a list of running tasks.', ""An [APT28] loader Trojan will enumerate the victim's processes searching for explorer.exe if its current process does not have necessary permissions."", '[ROKRAT] can list the current running processes on the system.', '[Pasam] creates a backdoor through which remote attackers can retrieve lists of running processes.', '[BabyShark] has executed the <code>tasklist</code> command.\t', '[GravityRAT] lists the running processes on the system.', '[Winnti for Windows] can check if the explorer.exe process is responsible for calling its install function.', '[iKitten] lists the current processes running.', '[P8RAT] can check for specific processes associated with virtual environments.', '[down_new] has the ability to list running processes on a compromised host.', '[Chimera] has used <code>tasklist</code> to enumerate processes.', '[Brute Ratel C4] can enumerate all processes and locate specific process IDs (PIDs).', '[Donut] includes subprojects that enumerate and identify information about [Process Injection] candidates.\t', '[BLACKCOFFEE] has the capability to discover processes.', 'During [C0015] the threat actors used the `tasklist /s` command as well as `taskmanager` to obtain a list of running processes.', '[Avaddon] has collected information about running processes.', '[Helminth] has used [Tasklist] to get information on processes.', '[yty] gets an output of running processes using the <code>tasklist</code> command.', '[Gelsemium] can enumerate running processes.', '[Kazuar] obtains a list of running processes through WMI querying and the <code>ps</code> command.', '[FunnyDream] has the ability to discover processes, including `Bka.exe` and `BkavUtil.exe`.', '[Get2] has the ability to identify running processes on an infected host.', '[HALFBAKED] can obtain information about running processes on the victim.', ""[PowerDuke] has a command to list the victim's processes."", '[KOPILUWAK] can enumerate current running processes on the targeted machine.', '[Andariel] has used <code>tasklist</code> to enumerate processes and find a specific string.', '[BACKSPACE] may collect information about running processes.', '[LookBack] can list running processes.', '[ADVSTORESHELL] can list running processes.', '[RainyDay] can enumerate processes on a target system.', '[ZxShell] has a command, ps, to obtain a listing of processes on the system. ', 'Several [Lazarus Group] malware families gather a list of running processes on a victim system and send it to their C2 server. A Destover-like variant used by [Lazarus Group] also gathers process times.', '[Mafalda] can enumerate running processes on a machine.', '[Carbanak] lists running processes.', '[QakBot] has the ability to check running processes.', ""[FoggyWeb] loader can enumerate all Common Language Runtimes (CLRs) and running Application Domains in the compromised AD FS server's <code>Microsoft.IdentityServer.ServiceHost.exe</code> process."", '[Bazar] can identity the current process on a compromised host.', '[Molerats] actors obtained a list of active processes on the victim and sent them to C2 servers.', '[Nebulae] can enumerate processes on a target system.', '[Earth Lusca] has used [Tasklist] to obtain information from a compromised host.', '[MobileOrder] has a command to upload information about all running processes to its C2 server.', '[NETWIRE] can discover processes on compromised hosts.', '[Bad Rabbit] can enumerate all running processes to compare hashes.', '[4H RAT] has the capability to obtain a listing of running processes (including loaded modules).', '[KONNI] has used the command <code>cmd /c tasklist</code> to get a snapshot of the current processes on the target machine.', '[FatDuke] can list running processes on the localhost.', '[Heyoka Backdoor] can gather process information.', '[KillDisk] has called <code>GetCurrentProcess</code>.', '[ELMER] is capable of performing process listings.', '[PowerStallion] has been used to monitor process lists.', '[Pandora] can monitor processes on a compromised host.', '[jRAT] can query and kill system processes.', '[DarkComet] can list active processes running on the victim’s machine.', '[TajMahal] has the ability to identify running processes and associated plugins on an infected host.', ""[Clop] can enumerate all processes on the victim's machine."", '[DarkTortilla] can enumerate a list of running processes on a compromised system.', '[Volgmer] can gather a list of processes.', '[Gold Dragon] checks the running processes on the victim’s machine.', '[Industroyer2] has the ability to cyclically enumerate running processes such as PServiceControl.exe, PService_PDD.exe, and other targets supplied through a hardcoded configuration.', '[Crimson] contains a command to list processes.\t ', '[RATANKBA] lists the system’s processes.', '[Mustang Panda] has used <code>tasklist /v</code> to determine active process information.\t', '[Pillowmint] can iterate through running processes every six seconds collecting a list of processes to capture from later.\t', '[Rising Sun] can enumerate all running processes and process information on an infected machine.\t', '[Cyclops Blink] can enumerate the process it is currently running under.', '[Skidmap] has monitored critical processes to ensure resiliency. ', '[Ramsay] can gather a list of running processes by using [Tasklist]', '[PipeMon] can iterate over the running processes to find a suitable injection target.', '[MacMa] can enumerate running processes.', '[PLAINTEE] performs the <code>tasklist</code> command to list running processes.', '[Linfo] creates a backdoor through which remote attackers can retrieve a list of running processes.', '[ShadowPad] has collected the PID of a malicious process.', '[BISCUIT] has a command to enumerate running processes and identify their owners.', '[Mosquito] runs <code>tasklist</code> to obtain running processes.', '[SUNBURST] collected a list of process names that were hashed using a FNV-1a + XOR algorithm to check against similarly-hashed hardcoded blocklists.', 'The OsInfo function in [Komplex] collects a running process list.', '[TrickBot] uses module networkDll for process list discovery.', 'During [FunnyDream] the threat actors used [Tasklist] on targeted systems.', '[BLUELIGHT] can collect process filenames and SID authority level.', '[Turla] surveys a system upon check-in to discover running processes using the <code>tasklist /v</code> command. [Turla] RPC backdoors have also enumerated processes associated with specific open ports or named pipes.', '[MuddyWater] has used malware to obtain a list of running processes on the system.', '[OceanSalt] can collect the name and ID for every process running on the system.', ""[Rocke] can detect a running process's PID on the infected machine.\t"", '[Magic Hound] malware can list running processes.', '[gh0st RAT] has the capability to list processes.', '[Sardonic] has the ability to execute the `tasklist` command.', '[HotCroissant] has the ability to list running processes on the infected host.', '[CharmPower] has the ability to list running processes through the use of `tasklist`.', '[Hydraq] creates a backdoor through which remote attackers can monitor processes.', '[HELLOKITTY] can search for specific processes to terminate.', '[APT37] Freenki malware lists running processes using the Microsoft Windows API.', '[PoetRAT] has the ability to list all running processes.', '[DRATzarus] can enumerate and examine running processes to determine if a debugger is present.', '[Zox] has the ability to list processes.', '[MarkiRAT] can search for different processes on a system.', '[Goopy] has checked for the Google Updater process to ensure [Goopy] was loaded properly.', '[Clambling] can enumerate processes on a targeted system.', '[SYSCON] has the ability to use [Tasklist] to list running processes.', '[Backdoor.Oldrea] collects information about running processes.', '[FrameworkPOS] can enumerate and exclude selected processes on a compromised host to speed execution of memory scraping.', '[BBSRAT] can list running processes.', '[NavRAT] uses <code>tasklist /v</code> to check running processes.', ""[Kimsuky] can gather a list of all processes running on a victim's machine."", '[XAgentOSX] contains the getProcessList function to run <code>ps aux</code> to get running processes.', '[Saint Bot] has enumerated running processes on a compromised host to determine if it is running under the process name `dfrgui.exe`.', '[Dtrack] dropper can list all running processes.', '[USBferry] can use <code>tasklist</code> to gather information about the process running on the infected system.\t', '[Kwampirs] collects a list of running services with the command <code>tasklist /v</code>.', '[Bumblebee] can identify processes associated with analytical tools.', '[PowerSploit] <code>Get-ProcessTokenPrivilege</code> Privesc-PowerUp module can enumerate privileges for a given process.', ""[Cuba] can enumerate processes running on a victim's machine."", '[RogueRobin] checks the running processes for evidence it may be running in a sandbox environment. It specifically enumerates processes for Wireshark and Sysinternals.', '[Proxysvc] lists processes running on the system.', '[NightClub] has the ability to use `GetWindowThreadProcessId` to identify the process behind a specified window.', '[Maze] has gathered all of the running system processes.\t', '[ObliqueRAT] can check for blocklisted process names on a compromised host.', '[SVCReady] can collect a list of running processes from an infected host.', '[Higaisa] shellcode attempted to find the process ID of the current process.', 'After compromising a victim, [Poseidon Group] lists all running processes.', '[Ke3chang] performs process discovery using <code>tasklist</code> commands.', '[ThiefQuest] obtains a list of running processes using the function <code>kill_unwanted</code>.', '[SHOTPUT] has a command to obtain a process listing.', '[SodaMaster] can search a list of running processes.', '[HEXANE] has enumerated processes on targeted systems.', '[SLOTHFULMEDIA] has enumerated processes by ID, name, or privileges. ', '[Babuk] has the ability to check running processes on a targeted system.', '[Inception] has used a reconnaissance module to identify active processes and other associated loaded modules.', '[Taidoor] can use <code>GetCurrentProcessId</code> for process discovery.', '[SDBbot] can enumerate a list of running processes on a compromised machine.', '[POORAIM] can enumerate processes.', '[njRAT] can search a list of running processes for Tr.exe.', '[AsyncRAT] can examine running processes to determine if a debugger is present.', '[FinFisher] checks its parent process for indications that it is running in a sandbox setup.', ""[OilRig] has run <code>tasklist</code> on a victim's machine."", '[Waterbear] can identify the process for a specific security product.', '[SynAck] enumerates all running processes.', '[APT3] has a tool that can list out currently running processes.', ""[RotaJakiro] can monitor the `/proc/[PID]` directory of known [RotaJakiro] processes as a part of its persistence when executing with non-root permissions. If the process is found dead, it resurrects the process. [RotaJakiro] processes can be matched to an associated Advisory Lock, in the `/proc/locks` folder, to ensure it doesn't spawn more than one process."", '[Uroburos] can use its `Process List` command to enumerate processes on compromised hosts.', '[PLEAD] has the ability to list processes on the compromised host.', '[StrongPity] can determine if a user is logged in by checking to see if explorer.exe is running.', '[Kinsing] has used ps to list processes.', '[Gamaredon Group] has used tools to enumerate processes on target hosts including Process Explorer.', '[SILENTTRINITY] can enumerate processes, including properties to determine if they have the Common Language Runtime (CLR) loaded.', 'During [Operation Honeybee] the threat actors obtained a list of running processes on a victim machine using `cmd /c tasklist > %temp%\\temp.ini`.', '[EvilBunny] has used EnumProcesses() to identify how many process are running in the environment.', '[UBoatRAT] can list running processes on the system.', '[Emotet] has been observed enumerating local processes.', 'During [Operation CuckooBees] the threat actors used the `tasklist` command as part of their advanced reconnaissance.', '[Carbon] can list the processes on the victim’s machine.', '[ChChes] collects its process identifier (PID) on the victim.', '[OutSteel] can identify running processes on a compromised host.', '[Winnti Group] looked for a specific process running on infected servers.', '[Lizar] has a plugin designed to obtain a list of processes.', '[Metamorfo] has performed process name checks and has monitored applications. ', '[Conti] can enumerate through all open processes to search for any that have the string “sql” in their process name.', '[InvisiMole] can obtain a list of running processes.', '[Socksbot] can list all running processes.', '[Cobalt Strike] Beacon payload can collect information on process details.', '[Cardinal RAT] contains watchdog functionality that ensures its process is always running, else spawns a new instance.', '[Empire] can find information about processes running on local and remote systems.', '[CaddyWiper] can obtain a list of current processes.', '[Derusbi] collects current and parent process IDs.', ""[Meteor] can check if a specific process is running, such as Kaspersky's `avp.exe`."", '[Royal] can use `GetCurrentProcess` to enumerate processes.', '[RTM] can obtain information about process integrity levels.', '[Flagpro] has been used to run the <code>tasklist</code> command on a compromised system.', '[macOS.OSAMiner] has used `ps ax | grep <name> | grep -v grep | ...` and `ps ax | grep -E...` to conduct process discovery.', '[DustySky] collects information about running processes from victims.', '[APT38] leveraged Sysmon to understand the processes, services in the organization.', '[Azorult] can collect a list of running processes by calling CreateToolhelp32Snapshot.', '[Bonadan] can use the <code>ps</code> command to discover other cryptocurrency miners active on the system.', '[VERMIN] can get a list of the processes and running tasks on the system.', '[ShimRatReporter] listed all running processes on the machine.', '[Carberp] has collected a list of running processes.', '[AvosLocker] has discovered system processes by calling `RmGetList`.', '[Pupy] can list the running processes and get the process ID and parent process’s ID.', '[Doki] has searched for the current process’s PID.', 'During [Operation Wocao] the threat actors used `tasklist` to collect a list of running processes on an infected system.', '[POWERSTATS] has used <code>get_tasklist</code> to discover processes on the compromised host.', '[APT29] has used multiple command-line utilities to enumerate running processes.', '[UNC2452] used multiple command-line utilities to enumerate running processes.', '[Operation Wocao] has collected a list of running processes on the infected system.', '[Frankenstein] has enumerated hosts, looking to obtain a list of all currently running processes.', '[Honeybee] gathers a list of processes using the <code>tasklist</code> command and then is sent back to the control server.', '[Cobalt Strike] ""beacon"" payload can collect information on process details.']"
T1606,Forge Web Credentials,"Adversaries may forge credential materials that can be used to gain access to web applications or Internet services. Web applications and services (hosted in cloud SaaS environments or on-premise servers) often use session cookies, tokens, or other materials to authenticate and authorize user access.  Adversaries may generate these credential materials in order to gain access to web resources. This differs from [Steal Web Session Cookie] [Steal Application Access Token] and other similar behaviors in that the credentials are new and forged by the adversary, rather than stolen or intercepted from legitimate users.  The generation of web credentials often requires secret values, such as passwords, [Private Keys] or other cryptographic seed values. Adversaries may also forge tokens by taking advantage of features such as the `AssumeRole` and `GetFederationToken` APIs in AWS, which allow users to request temporary security credentials (i.e., [Temporary Elevated Cloud Access] or the `zmprov gdpak` command in Zimbra, which generates a pre-authentication key that can be used to generate tokens for any user in the domain.  Once forged, adversaries may use these web credentials to access resources (ex: [Use Alternate Authentication Material] which may bypass multi-factor and other authentication protection mechanisms.  ",[]
T1590,Gather Victim Network Information,"Adversaries may gather information about the victim's networks that can be used during targeting. Information about networks may include a variety of details, including administrative data (ex: IP ranges, domain names, etc.) as well as specifics regarding its topology and operations.  Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning] or [Phishing for Information] Information about networks may also be exposed to adversaries via online or other accessible data sets (ex: [Search Open Technical Databases] Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Active Scanning] or [Search Open Websites/Domains] establishing operational resources (ex: [Acquire Infrastructure] or [Compromise Infrastructure] and/or initial access (ex: [Trusted Relationship]","[""[HAFNIUM] gathered the fully qualified domain names (FQDNs) for targeted Exchange servers in the victim's environment.""]"
T1110,Brute Force,"Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained. Without knowledge of the password for an account or set of accounts, an adversary may systematically guess the password using a repetitive or iterative mechanism. Brute forcing passwords can take place via interaction with a service that will check the validity of those credentials or offline against previously acquired credential data, such as password hashes.  Brute forcing credentials may take place at various points during a breach. For example, adversaries may attempt to brute force access to [Valid Accounts] within a victim environment leveraging knowledge gathered from other post-compromise behaviors such as [OS Credential Dumping] [Account Discovery] or [Password Policy Discovery] Adversaries may also combine brute forcing activity with behaviors such as [External Remote Services] as part of Initial Access.","['[Fox Kitten] has brute forced RDP credentials.', '[HEXANE] has used brute force attacks to compromise valid credentials.', '[Chaos] conducts brute force attacks against SSH services to gain initial access.', '[Caterpillar WebShell] has a module to perform brute force attacks on a system. ', ""[Turla] may attempt to connect to systems within a victim's network using <code>net use</code> commands and a predefined list or collection of passwords."", '[DarkVishnya] used brute-force attack to obtain login data.', 'During [Operation Dream Job] [Lazarus Group] performed brute force attacks against administrator accounts. ', '[FIN5] has has used the tool GET2 Penetrator to look for remote login and hard-coded credentials.', '[Kinsing] has attempted to brute force hosts over SSH.', '[APT38] has used brute force techniques to attempt account access when passwords are unknown or when password hashes are unavailable.', '[OilRig] has used brute force techniques to obtain credentials.', '[PoshC2] has modules for brute forcing local administrator and AD user accounts.', '[QakBot] can conduct brute force attacks to capture credentials.', '[APT39] has used Ncrack to reveal credentials.', 'During the [2016 Ukraine Electric Power Attack] [Sandworm Team] used a script to attempt RPC authentication against a number of hosts.', '[Dragonfly] has attempted to brute force credentials to gain access.', '[Pysa] has used brute force attempts against a central management console, as well as some Active Directory accounts.', '[CrackMapExec] can brute force supplied user credentials across a network range.', '[APT28] can perform brute force attacks to obtain credentials.', '[Lazarus Group] has performed brute force attacks against administrator accounts.', 'APT34 has used brute force techniques to obtain credentials.', 'Dragonfly dropped and executed Hydra, a password cracker.']"
T1039,Data from Network Shared Drive,"Adversaries may search network shares on computers they have compromised to find files of interest. Sensitive data can be collected from remote systems via shared network drives (host shared directory, network file server, etc.) that are accessible from the current system prior to Exfiltration. Interactive command shells may be in use, and common functionality within [cmd] may be used to gather information.","['[CosmicDuke] steals user files from network shared drives with file extensions and keywords that match a predefined list.', '[APT28] has collected files from network shared drives.', '[Gamaredon Group] malware has collected Microsoft Office documents from mapped network drives.', '[BRONZE BUTLER] has exfiltrated files stolen from file shares.', '[Egregor] can collect any files found in the enumerated drivers before sending it to its C2 channel. ', '[Sowbug] extracted Word documents from a file server on a victim network.', '[Ramsay] can collect data from network drives and stage it for exfiltration.\t', ""When it first starts, [BADNEWS] crawls the victim's mapped drives and collects documents with the following extensions: .doc, .docx, .pdf, .ppt, .pptx, and .txt."", '[Chimera] has collected data of interest from network shares.', '[menuPass] has collected data from remote systems by mounting network shares with <code>net use</code> and using Robocopy to transfer data.', 'During [C0015] the threat actors collected files from network shared drives prior to network encryption.', '[Fox Kitten] has searched network shares to access sensitive documents.']"
T1078,Valid Accounts,"Adversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Compromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access, network devices, and remote desktop. Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network. Adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence.  In some cases, adversaries may abuse inactive accounts: for example, those belonging to individuals who are no longer part of an organization. Using these accounts may allow the adversary to evade detection, as the original account user will not be present to identify any anomalous activity taking place on their account.  The overlap of permissions for local, domain, and cloud accounts across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access (i.e., domain or enterprise administrator) to bypass access controls set within the enterprise.","['[APT41] used compromised credentials to log on to other systems.', '[FIN8] has used valid accounts for persistence and lateral movement.', '[FIN4] has used legitimate credentials to hijack email communications.', '[FIN7] has harvested valid administrative credentials for lateral movement.', '[Kinsing] has used valid SSH credentials to access remote hosts.', '[Dragonfly] has compromised user credentials and used valid accounts for operations.', '[GALLIUM] leveraged valid accounts to maintain access to a victim network.', '[APT18] actors leverage legitimate credentials to log into external remote services.', '[Lazarus Group] has used administrator credentials to gain access to restricted network segments.', '[Chimera] has used a valid account to maintain persistence via scheduled task.', 'Some [SeaDuke] samples have a module to extract email from Microsoft Exchange servers using compromised credentials.', '[Dtrack] used hard-coded credentials to gain access to a network share.', '[Industroyer] can use supplied user credentials to execute processes and stop services.', 'During [Night Dragon] threat actors used compromised VPN accounts to gain access to victim systems.', '[menuPass] has used valid accounts including shared between Managed Service Providers and clients to move between the two environments.', 'Adversaries can instruct [Duqu] to spread laterally by copying itself to shares it has enumerated and for which it has obtained legitimate credentials (via keylogging or other means). The remote host is then infected by using the compromised credentials to schedule a task on remote machines that executes the malware.', '[Sandworm Team] have used previously acquired legitimate credentials prior to attacks.', ""[LAPSUS$] has used compromised credentials and/or session tokens to gain access into a victim's VPN, VDI, RDP, and IAMs."", '[Carbanak] actors used legitimate credentials of banking employees to perform operations that sent them millions of dollars.', 'During [Operation Wocao] threat actors used valid VPN credentials to gain initial access.', ""[APT28] has used legitimate credentials to gain initial access, maintain access, and exfiltrate data from a victim network. The group has specifically used credentials stolen through a spearphishing email to login to the DCCC network. The group has also leveraged default manufacturer's passwords to gain initial access to corporate networks via IoT devices such as a VOIP phone, printer, and video decoder."", '[Threat Group-3390] actors obtain legitimate credentials using a variety of methods and use them to further lateral movement on victim networks.', '[Suckfly] used legitimate account credentials that they dumped to navigate the internal victim network as though they were the legitimate account owner.', 'During the [2015 Ukraine Electric Power Attack] [Sandworm Team] used valid accounts on the corporate network to escalate privileges, move laterally, and establish persistence within the corporate network. ', '[Axiom] has used previously compromised administrative accounts to escalate privileges.', '[Leviathan] has obtained valid accounts to gain initial access.', '[PittyTiger] attempts to obtain legitimate credentials during operations.', '[Silence] has used compromised credentials to log on to other systems and escalate privileges.', '[OilRig] has used compromised credentials to access other systems on a victim network.', '[Wizard Spider] has used valid credentials for privileged accounts with the goal of accessing domain controllers.', ""[APT29] has used a compromised account to access an organization's VPN infrastructure."", '[TEMP.Veles] has used compromised VPN accounts.\t', '[Ke3chang] has used credential dumpers or stealers to obtain legitimate credentials, which they used to gain access to victim accounts.', '[FIN10] has used stolen credentials to connect remotely to victim networks using VPNs protected with only a single factor.', '[APT33] has used valid accounts for initial access and privilege escalation.', 'To move laterally on a victim network, [FIN6] has used credentials stolen from various systems on which it gathered usernames and password hashes.', '[Fox Kitten] has used valid credentials with various services during lateral movement.', '[POLONIUM] has used valid compromised credentials to gain access to victim environments.', '[FIN5] has used legitimate VPN, RDP, Citrix, or VNC credentials to maintain access to a victim environment.', '[Linux Rabbit] acquires valid SSH accounts through brute force. ', '[Silent Librarian] has used compromised credentials to obtain unauthorized access to online accounts.', '[APT39] has used stolen credentials to compromise Outlook Web Access (OWA).', 'During the [SolarWinds Compromise] [APT29] used different compromised credentials for remote access and to move laterally.', '[UNC2452] used different compromised credentials for remote access and to move laterally.', '[APT29] used different compromised credentials for remote access and to move laterally.', '[Night Dragon] has used compromised VPN accounts to gain access to victim systems.', '[Operation Wocao] has used valid VPN credentials to gain initial access.', '[Dragonfly 2.0] compromised user credentials and used valid accounts for operations.', '[Leviathan] has used valid, compromised email accounts for defense evasion, including to send malicious emails to other victim organizations.', 'APT34 has used valid administrator credentials to assist in lateral movement.']"
T1027,Obfuscated Files or Information,"Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This is common behavior that can be used across different platforms and the network to evade defenses.   Payloads may be compressed, archived, or encrypted in order to avoid detection. These payloads may be used during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open and [Deobfuscate/Decode Files or Information] for [User Execution] The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary.  Adversaries may also use compressed or archived scripts, such as JavaScript.   Portions of files can also be encoded to hide the plain-text strings that would otherwise help defenders with discovery.  Payloads may also be split into separate, seemingly benign files that only reveal malicious functionality when reassembled.   Adversaries may also abuse [Command Obfuscation] to obscure commands executed from payloads or directly via [Command and Scripting Interpreter] Environment variables, aliases, characters, and other platform/language specific semantics can be used to evade signature based detections and application control mechanisms.   ","['[DEADEYE] has encrypted its payload.', '[Torisma] has been Base64 encoded and AES encrypted.', '[OSX_OCEANLOTUS.D] encrypts its strings in RSA256 and encodes them in a custom base64 scheme and XOR.', '[Inception] has encrypted malware payloads dropped on victim machines with AES and RC4 encryption.', 'Most strings in [USBStealer] are encrypted using 3DES and XOR and reversed.', 'Variants of [Emissary] encrypt payloads using various XOR ciphers, as well as a custom algorithm that uses the ""srand"" and ""rand"" functions.', '[Kessel] configuration is hardcoded and RC4 encrypted within the binary.', '[BackdoorDiplomacy] has obfuscated tools and malware it uses with VMProtect.', '[Raindrop] encrypted its payload using a simple XOR algorithm with a single-byte key.', '[Ryuk] can use anti-disassembly and code transformation obfuscation techniques.', '[Rifdoor] has encrypted strings with a single byte XOR algorithm.', '[DarkTortilla] has been obfuscated with the DeepSea .NET and ConfuserEx code obfuscators.', '[Dark Caracal] has obfuscated strings in [Bandook] by base64 encoding, and then encrypting them.', '[Elderwood] has encrypted documents and malicious executables.', '[Lokibot] has obfuscated strings with base64 encoding.', '[SVCReady] can encrypt victim data with an RC4 cipher.', '[Shark] can use encrypted and encoded files for C2 configuration.', '[Ursnif] has used an XOR-based algorithm to encrypt Tor clients dropped to disk.\t[Ursnif] droppers have also been delivered as password-protected zip files that execute base64 encoded [PowerShell] commands.', '[PowerStallion] uses a XOR cipher to encrypt command output written to its OneDrive C2 server.', '[Darkhotel] has obfuscated code using RC4, XOR, and RSA.', '[SynAck] payloads are obfuscated prior to compilation to inhibit analysis and/or reverse engineering.', '[Transparent Tribe] has dropped encoded executables on compromised hosts.', '[Amadey] has obfuscated strings such as antivirus vendor names, domains, files, and others.', '[PolyglotDuke] can custom encrypt strings.', '[APT28] encrypted a .dll payload using RTL and a custom encryption algorithm. [APT28] has also obfuscated payloads with base64, XOR, and RC4.', '[PUNCHTRACK] is loaded and executed by a highly obfuscated launcher.', '[ECCENTRICBANDWAGON] has encrypted strings with RC4.', '[Drovorub] has used XOR encrypted payloads in WebSocket client to server messages.', '[HAWKBALL] has encrypted the payload with an XOR-based algorithm.', ""[Skidmap] has encrypted it's main payload using 3DES. "", '[Astaroth] has used an XOR-based algorithm to encrypt payloads twice with different keys.', '[APT18] obfuscates strings in the payload.', '[KEYPLUG] can use a hardcoded one-byte XOR encoded configuration file.', '[Valak] has the ability to base64 encode and XOR encrypt strings.', '[Sakula] uses single-byte XOR obfuscation to obfuscate many of its files.', '[Zox] has been encoded with Base64.', '[Rocke] has modified UPX headers after packing files to break unpackers.', '[PoisonIvy] hides any strings related to its own indicators of compromise.', 'The [Helminth] config file is encrypted with RC4.', '[Out1] has the ability to encode data.', '[SamSam] has been seen using AES or DES to encrypt payloads and payload components.', 'Some resources in [Prikormka] are encrypted with a simple XOR operation or encoded with Base64.', '[HTTPBrowser] code may be obfuscated through structured exception handling and return-oriented programming.', '[NanHaiShu] encodes files in Base64.', '[DarkWatchman] has been delivered as compressed RAR payloads in ZIP files to victims.', '[metaMain] module file has been encrypted via XOR.', '[Trojan.Karagany] can base64 encode and AES-128-CBC encrypt data prior to transmission.', '[GALLIUM] used a modified version of [HTRAN] in which they obfuscated strings such as debug messages in an apparent attempt to evade detection.', '[Leviathan] has obfuscated code using base64 and gzip compression.', '[Bazar] has used XOR, RSA2, and RC4 encrypted files.', '[Gallmaker] obfuscated shellcode used during execution.', '[Saint Bot] has been obfuscated to help avoid detection.', '[NanoCore] plugins were obfuscated with Eazfuscater.NET 3.3.', '[LoudMiner] has encrypted DMG files.\t', '[SHOTPUT] is obscured using XOR encoding and appended to a valid GIF file.', '[SodaMaster] can use ""stackstrings"" for obfuscation.', '[Sidewinder] has used base64 encoding and ECDH-P256 encryption for payloads.', '[CoinTicker] initially downloads a hidden encoded file.', '[BLUELIGHT] has a XOR-encoded payload.', '[PipeMon] modules are stored encrypted on disk.', '[Woody RAT] has used Base64 encoded strings and scripts.', '[Molerats] has delivered compressed executables within ZIP files to victims.', '[DCSrv] configuration is encrypted.', '[Turian] can use VMProtect for obfuscation.', '[APT39] has used malware to drop encrypted CAB files.', '[GravityRAT] supports file encryption (AES with the key ""lolomycin2017"").', '[Snip3] has the ability to obfuscate strings using XOR encryption.', '[Metamorfo] has encrypted payloads and strings.', '[ComRAT] has encrypted its virtual file system using AES-256 in XTS mode. ', '[Lazarus Group] has used multiple types of encryption and encoding for their payloads, including AES, Caracachs, RC4, XOR, Base64, and other tricks such as creating aliases in code for [Native API] function names.', '[Final1stspy] obfuscates strings with base64 encoding.', '[APT33] has used base64 to encode payloads.', 'The [DustySky] dropper uses a function to obfuscate the name of functions and other parts of the malware.', '[SUNSPOT] encrypted log entries it collected with the stream cipher RC4 using a hard-coded key. It also uses AES128-CBC encrypted blobs for [SUNBURST] source code and data extracted from the SolarWinds Orion <MsBuild.exe</code> process.', 'During [Night Dragon] threat actors used a DLL that included an XOR-encoded section.', '[LightNeuron] encrypts its configuration files with AES-256.', '[Pillowmint] has been compressed and stored within a registry key. [Pillowmint] has also obfuscated the AES key used for encryption.\t', '[DanBot] can Base64 encode its payload.', '[FELIXROOT] encrypts strings in the backdoor using a custom XOR algorithm.', 'Some data in [Remsec] is encrypted using RC5 in CBC mode, AES-CBC with a hardcoded key, RC4, or Salsa20. Some data is also base64-encoded.', '[Donut] can generate encrypted, compressed/encoded, or otherwise obfuscated code modules.', '[H1N1] uses multiple techniques to obfuscate strings, including XOR.', 'During [Operation Honeybee] the threat actors used Base64 to encode files with a custom key.', '[WindTail] can be delivered as a compressed, encrypted, and encoded payload.', '[Kazuar] is obfuscated using the open source ConfuserEx protector. [Kazuar] also obfuscates the name of created files/folders/mutexes and encrypts debug messages written to log files using the Rijndael cipher.', 'The [Grandoreiro] payload has been delivered encrypted with a custom XOR-based algorithm and also as a base64-encoded ZIP file.', '[Milan] can encode files containing information about the targeted system.', '[BLINDINGCAN] has obfuscated code using Base64 encoding.', '[KONNI] is heavily obfuscated and includes encrypted configuration files.', '[NETWIRE] has used a custom obfuscation algorithm to hide strings including Registry keys, APIs, and DLL names.', '[SombRAT] can encrypt strings with XOR-based routines and use a custom AES storage format for plugins, configuration, C2 domains, and harvested data.', '[BlackOasis] first stage shellcode contains a NOP sled with alternative instructions that was likely designed to bypass antivirus tools.', '[TINYTYPHON] has used XOR with 0x90 to obfuscate its configuration file.', '[Pony] attachments have been delivered via compressed archive files. [Pony] also obfuscates the memory flow by adding junk instructions when executing to make analysis more difficult.\t', '[BITTER] has used a RAR SFX dropper to deliver malware.', '[WhisperGate] can Base64 encode strings, store downloaded files in reverse byte order,  and use the Eazfuscator tool to obfuscate its third stage.', '[Agent Tesla] has had its code obfuscated in an apparent attempt to make analysis difficult. [Agent Tesla] has used the Rijndael symmetric encryption algorithm to encrypt strings.', '[ZxxZ] has been encoded to avoid detection from static analysis tools.', '[PcShare] has been encrypted with XOR using different 32-long Base16 strings and compressed with LZW algorithm.', '[TrickBot] uses non-descriptive names to hide functionality and uses an AES CBC (256 bits) encryption algorithm for its loader and configuration files.', '[Reaver] encrypts some of its files with XOR.', '[BOOSTWRITE] has encoded its payloads using a ChaCha stream cipher with a 256-bit key and 64-bit Initialization vector (IV) to evade detection.', '[Fysbis] has been encrypted using XOR and RC4. ', '[TA505] has password-protected malicious Word documents.', '[Stuxnet] uses encrypted configuration blocks and writes encrypted files to disk.', '[Higaisa] used Base64 encoded compressed payloads.', '[InnaputRAT] uses an 8-byte XOR key to obfuscate API names and other strings contained in the payload.', '[BitPaymer] has used RC4-encrypted strings and string hashes to avoid identifiable strings within the binary.', '[Kwampirs] downloads additional files that are base64-encoded and encrypted with another cipher.', '[Remexi] obfuscates its configuration data with XOR.', '[MiniDuke] can use control flow flattening to obscure code.', '[APT3] obfuscates files or information to help evade defensive measures.', '[TEARDROP] created and read from a file with a fake JPG header, and its payload was encrypted with a simple rotating XOR cipher.', '[Matryoshka] obfuscates API function names using a substitute cipher combined with Base64 encoding.', 'APIs and strings in some [TYPEFRAME] variants are RC4 encrypted. Another variant is encoded with XOR.', 'The [Clambling] executable has been obfuscated when dropped on a compromised host.', '[Brute Ratel C4] has used encrypted payload files and maintains an encrypted configuration structure in memory.', '[FoggyWeb] has been XOR-encoded.', '[APT19] used Base64 to obfuscate payloads.', '[Shamoon] contains base64-encoded strings.', '[StrongPity] has used encrypted strings in its dropper component.', '[Hydraq] uses basic obfuscation in the form of spaghetti code.', '[Fox Kitten] has base64 encoded payloads to avoid detection.', '[QakBot] has hidden code within Excel spreadsheets by turning the font color to white and splitting it across multiple cells.', '[Ember Bear] has obfuscated malware to help avoid detection.', '[Bisonal] DLL file and non-malicious decoy file are encrypted with RC4 and some function name strings are obfuscated.', 'A [Threat Group-3390] tool can encrypt payloads using XOR. [Threat Group-3390] malware is also obfuscated using Metasploit’s shikata_ga_nai encoder as well as compressed with LZNT1 compression.', 'A [RedLeaves] configuration file is encrypted with a simple XOR key, 0x53.', '[Flagpro] has been delivered within ZIP or RAR password-protected archived files.', 'During [C0017] [APT41] broke malicious binaries, including [DEADEYE] and [KEYPLUG] into multiple sections on disk to evade detection.', '[Cuba] has used multiple layers of obfuscation to avoid analysis, including its Base64 encoded payload. ', '[FlawedGrace] encrypts its C2 configuration files with AES in CBC mode.', '[More_eggs] payload has been encrypted with a key that has the hostname and processor family information appended to the end.', '[Elise] encrypts several of its files, including configuration files.', '[Avenger] has the ability to XOR encrypt files to be sent to C2.', '[EnvyScout] can Base64 encode payloads.', '[Dridex] strings are obfuscated using RC4. ', 'Configuration data used by [Rising Sun] has been encrypted using an RC4 stream algorithm.\t', '[Goopy] decrypter have been inflated with junk code in between legitimate API functions, and also included infinite loops to avoid analysis.', '[Ecipekac] can use XOR, AES, and DES to encrypt loader shellcode.', '[NOKKI] uses Base64 encoding for strings.', '[POSHSPY] appends a file signature header (randomly selected from six file types) to encrypted data prior to upload or download.', '[Dacls] can encrypt its configuration file with AES CBC.', '[SUNBURST] strings were compressed and encoded in Base64. [SUNBURST] also obfuscated collected system information using a FNV-1a + XOR algorithm.', '[Remcos] uses RC4 and base64 to obfuscate data, including Registry entries and file paths.', '[njRAT] has included a base64 encoded executable.', '[Kerrdown] can encrypt, encode, and compress multiple layers of shellcode.', ' [TA2541] has used compressed and char-encoded scripts in operations. ', '[PS1] is distributed as a set of encrypted files and scripts.', 'In one version of [KeyBoy] string obfuscation routines were used to hide many of the critical values referenced in the malware.', '[RainyDay] has downloaded as a XOR-encrypted payload.', '[Sliver] can encrypt strings at compile time.', '[FatDuke] can use base64 encoding, string stacking, and opaque predicates for obfuscation.', '[APT-C-36] has used ConfuserEx to obfuscate its variant of [Imminent Monitor] compressed payload and RAT packages, and password protected encrypted email attachments to avoid detection.', '[Waterbear] has used RC4 encrypted shellcode and encrypted functions.', '[Carbanak] encrypts strings to make analysis more difficult.', ' [Action RAT] commands, strings, and domains can be Base64 encoded within the payload.', '[Winnti for Linux] can encode its configuration file with single-byte XOR encoding.', '[Small Sieve] has the ability to use a custom hex byte swapping encoding scheme combined with an obfuscated Base64 function to protect program strings and Telegram credentials.', 'During the [2016 Ukraine Electric Power Attack] [Sandworm Team] used heavily obfuscated code with [Industroyer] in its Windows Notepad backdoor.', '[Magic Hound] malware has used base64-encoded files and has also encrypted embedded strings with AES.', '[Seasalt] obfuscates configuration data.', '[StoneDrill] has obfuscated its module with an alphabet-based table or XOR encryption.', '[IcedID] has utilzed encrypted binaries and base64 encoded strings.', '[Blue Mockingbird] has obfuscated the wallet address in the payload binary.', '[Tropic Trooper] has encrypted configuration files.', '[SysUpdate] can encrypt and encode its configuration file.', '[Chrommme] can encrypt sections of its code to evade detection.', '[Bundlore] has obfuscated data with base64, AES, RC4, and bz2.', '[KillDisk] uses VMProtect to make reverse engineering the malware more difficult.', 'Strings in [Attor] components are encrypted with a XOR cipher, using a hardcoded key and the configuration data, log files and plugins are encrypted using a hybrid encryption scheme of Blowfish-OFB combined with RSA.', '[ROKRAT] can encrypt data prior to exfiltration by using an RSA public key.', '[REvil] has used encrypted strings and configuration files.', '[Mofang] has compressed the [ShimRat] executable within malicious email attachments. [Mofang] has also encrypted payloads before they are downloaded to victims.', '[P.A.S. Webshell] can use encryption and base64 encoding to hide strings and to enforce access control once deployed.', 'Some strings in [HOMEFRY] are obfuscated with XOR x56.', '[Smoke Loader] uses a simple one-byte XOR method to obfuscate values in the malware.', '[OLDBAIT] obfuscates internal strings and unpacks them at startup.', '[Aria-body] has used an encrypted configuration file for its loader.', '[Mosquito] installer is obfuscated with a custom crypter to obfuscate the installer.', 'The payload of [CozyCar] is encrypted with simple XOR with a rotating key. The [CozyCar] configuration file has been encrypted with RC4 keys.', '[Anchor] has obfuscated code with stack strings and string encryption.', '[Daserf] uses encrypted Windows APIs and also encrypts data using the alternative base64+RC4 or the Caesar cipher.', '[YAHOYAH] encrypts its configuration file using a simple algorithm.', '[ThreatNeedle] has been compressed and obfuscated using RC4, AES, or XOR.', '[Pandora] has the ability to compress stings with QuickLZ.', '[BADHATCH] can be compressed with the ApLib algorithm.', '[Whitefly] has encrypted the payload used for C2.\t', '[Windshift] has used string encoding with floating point calculations.', '[menuPass] has encoded strings in its malware with base64 as well as with a simple, single-byte XOR obfuscation using key 0x40.', '[Ke3chang] has used Base64-encoded shellcode strings.', '[Ebury] has obfuscated its strings with a simple XOR encryption with a static key.', '[Conti] can use compiler-based obfuscation for its code, encrypt DLLs, and hide Windows API calls.', '[BendyBear] has encrypted payloads using RC4 and XOR.', '[Kobalos] encrypts all strings using RC4 and bundles all functionality into a single function call. ', '[APT37] obfuscates strings and payloads.', '[InvisiMole] avoids analysis by encrypting all strings, internal files, configuration data and by using a custom executable format.', '[PyDCrypt] has been compiled and encrypted with PyInstaller, specifically using the --key flag during the build phase.', '[Bumblebee] has been delivered as password-protected zipped ISO files and used control-flow-flattening to obfuscate the flow of functions.', '[ISMInjector] is obfuscated with the off-the-shelf SmartAssembly .NET obfuscator created by red-gate.com.', '[VERMIN] is obfuscated using the obfuscation tool called ConfuserEx.', '[Kimsuky] has obfuscated binary strings including the use of XOR encryption and Base64 encoding. [Kimsuky] has also modified the first byte of DLL implants targeting victims to prevent recognition of the executable file format.', '[HermeticWiper] can compress 32-bit and 64-bit driver files with the Lempel-Ziv algorithm.', '[Micropsia] obfuscates the configuration with a custom Base64 and XOR.', 'During [Operation Dust Storm] the threat actors encoded some payloads with a single-byte XOR, both skipping the key itself and zeroing in an attempt to avoid exposing the key; other payloads were Base64-encoded.', '[Kevin] has Base64-encoded its configuration file.', '[Moses Staff] has used obfuscated web shells in their operations.', '[TeamTNT] has encrypted its binaries via AES and encoded files using Base64.', '[Green Lambert] has encrypted strings. ', 'During [C0015] the threat actors used Base64-encoded strings.', '[Carbon] encrypts configuration files and tasks for the malware to complete using CAST-128 algorithm.', '[Diavol] has Base64 encoded the RSA public key used for encrypting files.', 'Many strings in [JHUHUGIT] are obfuscated with a XOR algorithm.', '[GoldMax] has written AES-encrypted and Base64-encoded configuration files to disk.', '[MCMD] can Base64 encode output strings prior to sending to C2.', '[Chinoxy] has encrypted its configuration file.', '[ShimRat] has been delivered as a package that includes compressed DLL and shellcode payloads within a .dat file.', '[DOGCALL] is encrypted using single-byte XOR.', '[RCSession] can compress and obfuscate its strings to evade detection on a compromised host.', '[AppleSeed] has the ability to Base64 encode its payload and custom encrypt API calls.', '[Heyoka Backdoor] can encrypt its payload.', '[BoxCaon] used the ""StackStrings"" obfuscation technique to hide malicious functionalities.', '[Metador] has encrypted their payloads.', 'Most of the strings in [ADVSTORESHELL] are encrypted with an XOR-based algorithm; some strings are also encrypted with 3DES and reversed. API function names are also reversed, presumably to avoid detection in memory.', '[Conficker] has obfuscated its code to prevent its removal from host machines.', 'The [FIVEHANDS] payload is encrypted with AES-128.', '[Siloscape] itself is obfuscated and uses obfuscated API calls.', '[Zeus Panda] encrypts strings with XOR. [Zeus Panda] also encrypts all configuration and settings in AES and RC4.', '[Squirrelwaffle] has been obfuscated with a XOR-based algorithm.', '[HyperBro] can be delivered encrypted to a compromised host.', '[STARWHALE] has been obfuscated with hex-encoded strings.', '[Mustang Panda] has delivered initial payloads hidden using archives and encoding measures.', '[ShadowPad] has encrypted its payload, a virtual file system, and various files.', '[HotCroissant] has encrypted strings with single-byte XOR and base64 encoded RC4.', '[EKANS] uses encoded strings in its process kill list. ', '[RegDuke] can use control-flow flattening or the commercially available .NET Reactor for obfuscation.', '[NightClub] can obfuscate strings using the congruential generator `(LCG): staten+1 = (690069 × staten + 1) mod 232`. ', '[Sandworm Team] has used Base64 encoding within malware variants.', '[Group5] disguised its malicious binaries with several layers of obfuscation, including encrypting the files.', '[Imminent Monitor] has encrypted the spearphish attachments to avoid detection from email gateways; the debugger also encrypts information before sending to the C2.', 'During [Operation Dream Job] [Lazarus Group] encrypted malware such as  [DRATzarus] with XOR and DLL files with base64.', '[KGH_SPY] has used encrypted strings in its installer.', '[SUPERNOVA] contained Base64-encoded strings.', '[Earth Lusca] used Base64 to encode strings.', '[SoreFang] has the ability to encode and RC6 encrypt data sent to C2.', '[Carberp] has used XOR-based encryption to mask C2 server locations within the trojan.', '[Hancitor] has used Base64 to encode malicious links. [Hancitor] has also delivered compressed payloads in ZIP files to victims.', 'Droppers used by [Putter Panda] use RC4 or a 16-byte XOR key consisting of the bytes 0xA0 – 0xAF to obfuscate payloads.', '[SpeakUp] encodes its second-stage payload with Base64. ', '[Pisloader] obfuscates files by splitting strings into smaller sub-strings and including ""garbage"" strings that are never used. The malware also uses return-oriented programming (ROP) technique and single-byte XOR to obfuscate data.', '[Avaddon] has used encrypted strings.', '[OilRig] has encrypted and encoded data in its malware, including by using base64.', '[Mafalda] has been obfuscated and contains encrypted functions.', '[Hi-Zor] uses various XOR techniques to obfuscate its components.', '[HiddenWasp] encrypts its configuration and payload.', 'A [JPIN] uses a encrypted and compressed payload that is disguised as a bitmap within the resource section of the installer.', '[GoldenSpy] uninstaller has base64-encoded its variables. ', '[Taidoor] can use encrypted string blocks for obfuscation.', '[RTM] strings, network data, configuration, and modules are encrypted with a modified RC4 algorithm. [RTM] has also been delivered to targets as various archive files including ZIP, 7-ZIP, and RAR.', 'The [WastedLocker] payload includes encrypted strings stored within the .bss section of the binary file.   ', 'For [Operation Spalax] the threat actors used XOR-encrypted payloads.', '[Winnti for Windows] has the ability to encrypt and compress its payload.', '[CARROTBALL] has used a custom base64 alphabet to decode files.', '[Sardonic] can use certain ConfuserEx features for obfuscation and can be encoded in a base64 string.', '[Exaramel for Linux] uses RC4 for encrypting the configuration.', '[APT32] has performed code obfuscation, including encoding payloads using Base64 and using a framework called ""Dont-Kill-My-Cat (DKMC). [APT32] also encrypts the library used for network exfiltration with AES-256 in CBC mode in their macOS backdoor.', '[HermeticWizard] has the ability to encrypt PE files with a reverse XOR loop.', '[Gamaredon Group] has delivered self-extracting 7z archive files within malicious document attachments.', '[AppleJeus] has XOR-encrypted collected system information prior to sending to a C2. [AppleJeus] has also used the open source ADVObfuscation library for its components.', '[Gazer] logs its actions into files that are encrypted with 3DES. It also uses RSA to encrypt resources.', '[DRATzarus] can be partly encrypted with XOR.', '[Hildegard] has encrypted an ELF file.', '[AvosLocker] has used XOR-encoded strings.', '[PoetRAT] has used a custom encryption scheme for communication between scripts.', '[Ramsay] has base64-encoded its portable executable and hidden itself under a JPG header. [Ramsay] can also embed information within document footers.\t', ""[PUNCHBUGGY] has hashed most its code's functions and encrypted payloads with base64 and XOR."", '[Maze] has decrypted strings and other important information during the encryption process. [Maze] also calls certain functions dynamically to hinder analysis.\t', '[Gelsemium] has the ability to compress its components.', 'A [Volgmer] variant is encoded using a simple XOR cipher.', '[Epic] heavily obfuscates its code to make analysis more difficult.', '[CORESHELL] obfuscates strings using a custom stream cipher.', '[PlugX] can use API hashing and modify the names of strings to evade detection.', '[IronNetInjector] can obfuscate variable names, encrypt strings, as well as base64 encode and Rijndael encrypt payloads.', 'A version of [XTunnel] introduced in July 2015 obfuscated the binary using opaque predicates and other techniques in a likely attempt to obfuscate it and bypass security products.', '[UBoatRAT] encrypts instructions in the payload using a simple XOR cipher.', '[jRAT] Java payload is encrypted with AES. Additionally, backdoor files are encrypted using DES as a stream cipher. Later variants of [jRAT] also incorporated AV evasion methods such as Java bytecode obfuscation via the commercial Allatori obfuscation tool.', '[OopsIE] uses the Confuser protector to obfuscate an embedded .Net Framework assembly used for C2. [OopsIE] also encodes collected data in hexadecimal format before writing to files on disk and obfuscates strings.', '[GrimAgent] has used Rotate on Right (RoR) and Rotate on Left (RoL) functionality to encrypt strings.', '[ShimRatReporter] encrypted gathered information with a combination of shifting and XOR using a static key.', '[StreamEx] obfuscates some commands by using statically programmed fragments of strings when starting a DLL. It also uses a one-byte xor against 0x91 to encode configuration data.', '[Uroburos] can use AES and CAST-128 encryption to obfuscate resources.', '[FunnyDream] can Base64 encode its C2 address stored in a template binary with the `xyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvw_-` or `xyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvw_=` character sets.', '[APT41] used VMProtected binaries in multiple intrusions.', '[SDBbot] has the ability to XOR the strings for its installer component with a hardcoded 128 byte key.', '[TajMahal] has used an encrypted Virtual File System to store plugins.', '[Denis] obfuscates its code and encrypts the API names.', '[FinFisher] is heavily obfuscated in many ways, including through the use of spaghetti code in its functions in an effort to confuse disassembly programs. It also uses a custom XOR algorithm to obfuscate code.', '[AuditCred] encrypts the configuration.', '[Penquin] has encrypted strings in the binary for obfuscation.', 'Some [Orz] strings are base64 encoded, such as the embedded DLL known as MockDll.', '[GreyEnergy] encrypts its configuration files with AES-256 and also encrypts its strings.', '[CARROTBAT] has the ability to download a base64 encoded payload.', '[BoomBox] can encrypt data using AES prior to exfiltration.', '[Cobalt Strike] can hash functions to obfuscate calls to the Windows API and use a public/private key pair to encrypt Beacon session metadata.', '[Industroyer] uses heavily obfuscated code in its Windows Notepad backdoor.', '[ZeroT] has encrypted its payload with RC4.', '[Comnie] uses RC4 and Base64 to obfuscate strings.', '[Cardinal RAT] encodes many of its artifacts and is encrypted (AES-128) when downloaded. ', '[APT29] has used encoded PowerShell commands.', '[UNC2452] used encoded PowerShell commands.', '[TRITON] encoded the two inject.bin and imain.bin payloads.', '[Operation Wocao] has executed PowerShell commands which were encoded or compressed using Base64, zlib, and XOR.', '[Frankenstein] has run encoded commands from the command line.', 'A [Night Dragon] DLL included an XOR-encoded section.', '[Dust Storm] has encoded payloads with a single-byte XOR, both skipping the key itself and zeroing in an attempt to avoid exposing the key.', '[Dtrack] has used a dropper that embeds an encrypted payload as extra data.', '[Honeybee] drops files with base64-encoded data.', 'The [SMOKEDHAM] source code is embedded in the dropper as an encrypted string.', '[Machete] employed some visual obfuscation techniques by naming variables as combinations of letters to hinder analysis.', '[PowerDuke] uses steganography to hide backdoors in PNG files, which are also encrypted using the Tiny Encryption Algorithm (TEA).', '[Exaramel] uses RC4 for encrypting the configuration.', 'hides any strings related to its own indicators of compromise.', 'APT34 has used base64-encoded files that are dropped to victims.', 'If the victim is using PowerShell 3.0 or later, POWERSOURCE writes its decoded payload to an Alternate Data Stream (ADS) named kernel32.dll that is saved in <code>%PROGRAMDATA%\\Windows\\</code>.']"
T1056,Input Capture,"Adversaries may use methods of capturing user input to obtain credentials or collect information. During normal system usage, users often provide credentials to various different locations, such as login pages/portals or system dialog boxes. Input capture mechanisms may be transparent to the user (e.g. [Credential API Hooking] or rely on deceiving the user into providing input into what they believe to be a genuine service (e.g. [Web Portal Capture]","['[metaMain] can log mouse events.', '[Mafalda] can conduct mouse event logging.', '[Chaes] has a module to perform any API hooking it desires. ', '[FlawedAmmyy] can collect mouse events.', '[Kobalos] has used a compromised SSH client to capture the hostname, port, username and password used to establish an SSH connection from the compromised host. ', '[APT39] has utilized tools to capture mouse movements.', 'APT34 has used a keylogging tool called KEYPUNCH.', 'captures keystrokes.']"
T1012,Query Registry,"Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software.  The Registry contains a significant amount of information about the operating system, configuration, software, and security. Information can easily be queried using the [Reg] utility, though other means to access the Registry exist. Some of the information may help adversaries to further their operation within a network. Adversaries may use the information from [Query Registry] during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.","['During [Operation Wocao] the threat actors executed `/c cd /d c:\\windows\\temp\\ & reg query HKEY_CURRENT_USER\\Software\\<username>\\PuTTY\\Sessions\\` to detect recent PuTTY sessions, likely to further lateral movement.', '[Epic] uses the <code>rem reg query</code> command to obtain values from Registry keys.', '[Sibot] has queried the registry for proxy server information.', '[FatDuke] can get user agent strings for the default browser from <code>HKCU\\Software\\Classes\\http\\shell\\open\\command</code>.', '[Hydraq] creates a backdoor through which remote attackers can retrieve system information, such as CPU speed, from Registry keys.', '[SVCReady] can search for the `HKEY_LOCAL_MACHINE\\HARDWARE\\DESCRIPTION\\System` Registry key to gather system information.', '[ZIRCONIUM] has used a tool to query the Registry for proxy settings.', '[TEARDROP] checked that <code>HKU\\SOFTWARE\\Microsoft\\CTF</code> existed before decoding its embedded payload. ', ""A variant of [HOPLIGHT] hooks lsass.exe, and lsass.exe then checks the Registry for the data value 'rdpproto' under the key <code>SYSTEM\\CurrentControlSet\\Control\\Lsa Name</code>."", '[Shark] can query `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography MachineGuid` to retrieve the machine GUID.', '[Azorult] can check for installed software on the system under the Registry key <code>Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall</code>.', '[Clambling] has the ability to enumerate Registry keys, including <code>KEY_CURRENT_USER\\Software\\Bitcoin\\Bitcoin-Qt\\strDataDir</code> to search for a bitcoin wallet.', '[Volgmer] checks the system for certain Registry keys.', '[njRAT] can read specific registry values.', '[ROKRAT] can access the <code>HKLM\\System\\CurrentControlSet\\Services\\mssmbios\\Data\\SMBiosData</code> Registry key to obtain the System manufacturer value to identify the machine type.', '[Shamoon] queries several Registry keys to identify hard disk partitions to overwrite.', '[BabyShark] has executed the <code>reg query</code> command for <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default</code>.\t', '[Denis] queries the Registry for keys and values.', '[PowerSploit] contains a collection of Privesc-PowerUp modules that can query Registry keys for potential opportunities.', '[Pillowmint] has used shellcode which reads code stored in the registry keys <code>\\REGISTRY\\SOFTWARE\\Microsoft\\DRM</code> using the native Windows API as well as read <code>HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces</code> as part of its C2.\t', 'A [Threat Group-3390] tool can read and decrypt stored Registry values.', '[Carbon] enumerates values in the Registry.', '[Lazarus Group] malware IndiaIndia checks Registry keys within HKCU and HKLM to determine if certain applications are present, including SecureCRT, Terminal Services, RealVNC, TightVNC, UltraVNC, Radmin, mRemote, TeamViewer, FileZilla, pcAnyware, and Remote Desktop. Another [Lazarus Group] malware sample checks for the presence of the following Registry key:<code>HKEY_CURRENT_USER\\Software\\Bitcoin\\Bitcoin-Qt</code>.', '[Carbanak] checks the Registry key <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings</code> for proxy configurations information.', '[REvil] can query the Registry to get random file extensions to append to encrypted files.', '[LitePower] can query the Registry for keys added to execute COM hijacking.', '[JPIN] can enumerate Registry keys.', '[APT32] backdoor can query the Windows Registry to gather system information. ', '[WINDSHIELD] can gather Registry values.', '[PlugX] can enumerate and query for information contained within the Windows Registry.', '[Dragonfly] has queried the Registry to identify victim information.', '[ZxxZ] can search the registry of a compromised host.', '[FELIXROOT] queries the Registry for specific keys for potential privilege escalation and proxy information. [FELIXROOT] has also used WMI to query the Windows Registry.', '[Turla] surveys a system upon check-in to discover information in the Windows Registry with the <code>reg query</code> command. [Turla] has also retrieved PowerShell payloads hidden in Registry keys as well as checking keys associated with null session named pipes .', '[DownPaper] searches and reads the value of the Windows Update Registry Run key.', '[Reg] may be used to gather details from the Windows Registry of a local or remote system at the command-line interface.', ""[BACKSPACE] is capable of enumerating and making modifications to an infected system's Registry."", '[LiteDuke] can query the Registry to check for the presence of <code>HKCU\\Software\\KasperskyLab</code>.', '[ZxShell] can query the netsvc group value data located in the svchost group Registry key. ', '[Taidoor] can query the Registry on compromised hosts using <code>RegQueryValueExA</code>.', '[Saint Bot] has used `check_registry_keys` as part of its environmental checks.', '[OSInfo] queries the registry to look for information about Terminal Services.', '[Kimsuky] has obtained specific Registry keys and values on a compromised host.', '[SynAck] enumerates Registry keys associated with event logs.', '[Uroburos] can query the Registry, typically `HKLM:\\SOFTWARE\\Classes\\.wav\\OpenWithProgIds`, to find the key and path to decrypt and load its kernel driver and kernel driver loader.', '[Dtrack] can collect the RegisteredOwner, RegisteredOrganization, and InstallDate registry values.', '[Milan] can query `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography MachineGuid` to retrieve the machine GUID.', '[Stealth Falcon] malware attempts to determine the installed version of .NET by querying the Registry.', '[Bazar] can query <code>Windows\\CurrentVersion\\Uninstall</code> for installed applications.', '[SILENTTRINITY] can use the `GetRegValue` function to check Registry keys within `HKCU\\Software\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated` and `HKLM\\Software\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated`. It also contains additional modules that can check software AutoRun values and use the Win32 namespace to get values from HKCU, HKLM, HKCR, and HKCC hives.', '[Bankshot] searches for certain Registry keys to be configured before executing the payload.', '[DarkWatchman] can query the Registry to determine if it has already been installed on the system.', '[FinFisher] queries Registry values as part of its anti-sandbox checks.', '[Mafalda] can enumerate Registry keys with all subkeys and values.', '[BitPaymer] can use the RegEnumKeyW to iterate through Registry keys. ', '[gh0st RAT] has checked for the existence of a Service key to determine if it has already been installed on the system.', '[Cardinal RAT] contains watchdog functionality that periodically ensures <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Load</code> is set to point to its executable.', '[FunnyDream] can check `Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings` to extract the `ProxyServer` string.', '[Carberp] has searched the Image File Execution Options registry key for ""Debugger"" within every subkey.', '[Cobalt Strike] can query <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\<Excel Version>\\Excel\\Security\\AccessVBOM\\</code>  to determine if the security setting for restricting default programmatic access is enabled.', '[Waterbear] can query the Registry key <code>""HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\MSDTC\\MTxOCI""</code> to see if the value `OracleOcilib` exists.', '[WastedLocker] checks for specific registry keys related to the <code>UCOMIEnumConnections</code> and <code>IActiveScriptParseProcedure32</code> interfaces.', ""[BendyBear] can query the host's Registry key at <code>HKEY_CURRENT_USER\\Console\\QuickEdit</code> to retrieve data."", '[Mori] can read data from the Registry including from `HKLM\\Software\\NFC\\IPA` and `HKLM\\Software\\NFC\\`.', '[POWERSOURCE] queries Registry keys in preparation for setting Run keys to achieve persistence.', '[ADVSTORESHELL] can enumerate registry keys.', '[PcShare] can search the registry files of a compromised host.', '[Ursnif] has used [Reg] to query the Registry for installed programs.', '[Bisonal] has used the RegQueryValueExA function to retrieve proxy information in the Registry.', '[Brave Prince] gathers information about the Registry.', '[Bumblebee] can check the Registry for specific keys.', '[Valak] can use the Registry for code updates and to collect credentials.', '[TinyTurla] can query the Registry for its configuration information.', '[ComRAT] can check the default browser by querying <code>HKCR\\http\\shell\\open\\command</code>.', '[StoneDrill] has looked in the registry to find the default browser path.', '[Fox Kitten] has accessed Registry hives ntuser.dat and UserClass.dat.', '[RATANKBA] uses the command <code>reg query “HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\InternetSettings”</code>.', '[QUADAGENT] checks if a value exists within a Registry key in the HKCU hive whose name is the same as the scheduled task it has created.', '[APT39] has used various strains of malware to query the Registry.', '[Chimera] has queried Registry keys using <code>reg query \\\\<host>\\HKU\\<SID>\\SOFTWARE\\Microsoft\\Terminal Server Client\\Servers</code> and <code>reg query \\\\<host>\\HKU\\<SID>\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings</code>.', '[Zebrocy] executes the <code>reg query</code> command to obtain information in the Registry.', '[Gelsemium] can open random files and Registry keys to obscure malware behavior from sandbox analysis.', '[Stuxnet] searches the Registry for indicators of security programs.', '[Proxysvc] gathers product names from the Registry key: <code>HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion ProductName</code> and the processor description from the Registry key <code>HKLM\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0 ProcessorNameString</code>.', '[SUNBURST] collected the registry value <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid</code> from compromised hosts.', '[POWRUNER] may query the Registry by running <code>reg query</code> on a victim.', '[Zeus Panda] checks for the existence of a Registry key and if it contains certain values.', '[Rising Sun] has identified the OS product name from a compromised host by searching the registry for `SOFTWARE\\MICROSOFT\\Windows NT\\ CurrentVersion | ProductName`.', '[Volt Typhoon] has queried the Registry on compromised systems, `reg query hklm\\software\\`, for information on installed software.', '[Crimson] can check the Registry for the presence of <code>HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\last_edate</code> to determine how long it has been installed on a host.', '[OilRig] has used <code>reg query “HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default”</code> on a victim to query the Registry.', '[Woody RAT] can search registry keys to identify antivirus programs on an compromised host.', '[QUIETCANARY] has the ability to retrieve information from the Registry.', '[SodaMaster] has the ability to query the Registry to detect a key specific to VMware.', '[Derusbi] is capable of enumerating Registry keys and values.', '[CharmPower] has the ability to enumerate `Uninstall` registry values.', '[Reaver] queries the Registry to determine the correct Startup path to use for persistence.', '[CHOPSTICK] provides access to the Windows Registry, which can be used to gather information.', '[Industroyer] has a data wiper component that enumerates keys in the Registry <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services</code>.', '[Gold Dragon] enumerates registry keys with the command <code>regkeyenum</code> and obtains information for the Registry key <code>HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code>.', '[Lucifer] can check for existing stratum cryptomining information in <code>HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\spreadCpuXmr – %stratum info%</code>.', '[Attor] has opened the registry and performed query searches.', '[InvisiMole] can enumerate Registry values, keys, and data.', '[Operation Wocao] has queried the registry to detect recent PuTTY sessions.', '[Dragonfly 2.0] queried the Registry to identify victim information.']"
T1499,Endpoint Denial of Service,"Adversaries may perform Endpoint Denial of Service (DoS) attacks to degrade or block the availability of services to users. Endpoint DoS can be performed by exhausting the system resources those services are hosted on or exploiting the system to cause a persistent crash condition. Example services include websites, email services, DNS, and web-based applications. Adversaries have been observed conducting DoS attacks for political purposes and to support other malicious activities, including distraction, hacktivism, and extortion.  An Endpoint DoS denies the availability of a service without saturating the network used to provide access to the service. Adversaries can target various layers of the application stack that is hosted on the system used to provide the service. These layers include the Operating Systems (OS), server applications such as web servers, DNS servers, databases, and the (typically web-based) applications that sit on top of them. Attacking each layer requires different techniques that take advantage of bottlenecks that are unique to the respective components. A DoS attack may be generated by a single system or multiple systems spread across the internet, which is commonly referred to as a distributed DoS (DDoS).  To perform DoS attacks against endpoint resources, several aspects apply to multiple methods, including IP address spoofing and botnets.  Adversaries may use the original IP address of an attacking system, or spoof the source IP address to make the attack traffic more difficult to trace back to the attacking system or to enable reflection. This can increase the difficulty defenders have in defending against the attack by reducing or eliminating the effectiveness of filtering by the source address on network defense devices.  Botnets are commonly used to conduct DDoS attacks against networks and services. Large botnets can generate a significant amount of traffic from systems spread across the global internet. Adversaries may have the resources to build out and control their own botnet infrastructure or may rent time on an existing botnet to conduct an attack. In some of the worst cases for DDoS, so many systems are used to generate requests that each one only needs to send out a small amount of traffic to produce enough volume to exhaust the target's resources. In such circumstances, distinguishing DDoS traffic from legitimate clients becomes exceedingly difficult. Botnets have been used in some of the most high-profile DDoS attacks, such as the 2012 series of incidents that targeted major US banks.  In cases where traffic manipulation is used, there may be points in the global network (such as high traffic gateway routers) where packets can be altered and cause legitimate clients to execute code that directs network packets toward a target in high volume. This type of capability was previously used for the purposes of web censorship where client HTTP traffic was modified to include a reference to JavaScript that generated the DDoS code to overwhelm target web servers.  For attacks attempting to saturate the providing network, see [Network Denial of Service] ","['[OnionDuke] has the capability to use a Denial of Service module.', '[Sandworm Team] temporarily disrupted service to Georgian government, non-government, and private sector websites after compromising a Georgian web hosting provider in 2019.', '[ZxShell] has a feature to perform SYN flood attack on a host. ']"
T1213,Data from Information Repositories,"Adversaries may leverage information repositories to mine valuable information. Information repositories are tools that allow for storage of information, typically to facilitate collaboration or information sharing between users, and can store a wide variety of data that may aid adversaries in further objectives, or direct access to the target information. Adversaries may also abuse external sharing features to share sensitive documents with recipients outside of the organization.   The following is a brief list of example information that may hold potential value to an adversary and may also be found on an information repository:  * Policies, procedures, and standards * Physical / logical network diagrams * System architecture diagrams * Technical system documentation * Testing / development credentials * Work / project schedules * Source code snippets * Links to network shares and other internal resources  Information stored in a repository may vary based on the specific instance or environment. Specific common information repositories include web-based platforms such as [Sharepoint] and [Confluence] specific services such as Code Repositories, IaaS databases, enterprise databases, and other storage infrastructure such as SQL Server.","['[FIN6] has collected schemas and user accounts from systems running SQL Server.', ""During the [SolarWinds Compromise] [APT29] accessed victims' internal knowledge repositories (wikis) to view sensitive corporate information on products, services, and internal business operations."", '[Fox Kitten] has accessed victim security and IT environments and Microsoft Teams to mine valuable information.', '[APT28] has collected files from various information repositories.', ""[Turla] has used a custom .NET tool to collect documents from an organization's internal central database."", ""[LAPSUS$] has searched a victim's network for organization collaboration channels like MS Teams or Slack to discover further high-privilege account credentials."", '[P.A.S. Webshell] has the ability to list and extract data from SQL databases.', '[APT29] has accessed victims’ internal knowledge repositories (wikis) to view sensitive corporate information on products, services, and internal business operations.']"
T1200,Hardware Additions,"Adversaries may introduce computer accessories, networking hardware, or other computing devices into a system or network that can be used as a vector to gain access. Rather than just connecting and distributing payloads via removable storage (i.e. [Replication Through Removable Media] more robust hardware additions can be used to introduce new functionalities and/or features into a system that can then be abused.  While public references of usage by threat actors are scarce, many red teams/penetration testers leverage hardware additions for initial access. Commercial and open source products can be leveraged with capabilities such as passive network tapping, network traffic modification (i.e. [Adversary-in-the-Middle] keystroke injection, kernel memory reading via DMA, addition of new wireless access to an existing network, and others.","['[DarkVishnya] used Bash Bunny, Raspberry Pi, netbooks or inexpensive laptops to connect to the company’s local network.']"
T1221,Template Injection,"Adversaries may create or modify references in user document templates to conceal malicious code or force authentication attempts. For example, Microsoft’s Office Open XML (OOXML) specification defines an XML-based format for Office documents (.docx, xlsx, .pptx) to replace older binary formats (.doc, .xls, .ppt). OOXML files are packed together ZIP archives compromised of various XML files, referred to as parts, containing properties that collectively define how a document is rendered.  Properties within parts may reference shared public resources accessed via online URLs. For example, template properties may reference a file, serving as a pre-formatted document blueprint, that is fetched when the document is loaded.  Adversaries may abuse these templates to initially conceal malicious code to be executed via user documents. Template references injected into a document may enable malicious payloads to be fetched and executed when the document is loaded. These documents can be delivered via other techniques such as [Phishing] and/or [Taint Shared Content] and may evade static detections since no typical indicators (VBA macro, script, etc.) are present until after the malicious payload is fetched. Examples have been seen in the wild where template injection was used to load malicious code containing an exploit.  Adversaries may also modify the <code>*\template</code> control word within an .rtf file to similarly conceal then download malicious code. This legitimate control word value is intended to be a file destination of a template file resource that is retrieved and loaded when an .rtf file is opened. However, adversaries may alter the bytes of an existing .rtf file to insert a template control word field to include a URL resource of a malicious payload.  This technique may also enable [Forced Authentication] by injecting a SMB/HTTPS (or other credential prompting) URL and triggering an authentication attempt.","['[Dragonfly] has injected SMB URLs into malicious Word spearphishing attachments to initiate [Forced Authentication]', '[Confucius] has used a weaponized Microsoft Word document with an embedded RTF exploit.', 'During [Operation Dream Job] [Lazarus Group] used DOCX files to retrieve a malicious document template/DOTM file.', '[Tropic Trooper] delivered malicious documents with the XLSX extension, typically used by OpenXML documents, but the file itself was actually an OLE (XLS) document.', '[APT28] used weaponized Microsoft Word documents abusing the remote template function to retrieve a malicious macro. ', 'During [Frankenstein] the threat actors used trojanized documents that retrieved remote templates from an adversary-controlled website.', '[Gamaredon Group] has used DOCX files to download malicious DOT document templates and has used RTF template injection to download malicious payloads. [Gamaredon Group] can also inject malicious macros or remote templates into documents already present on compromised systems.', '[Chaes] changed the template target of the settings.xml file embedded in the Word document and populated that field with the downloaded URL of the next payload. ', '[Inception] has used decoy documents to load malicious remote payloads via HTTP.', '[WarzoneRAT] has been install via template injection through a malicious DLL embedded within a template RTF in a Word document.', '[DarkHydrus] used an open-source tool, Phishery, to inject malicious remote template URLs into Microsoft Word documents and then sent them to victims to enable [Forced Authentication]', '[Lazarus Group] has used DOCX files to retrieve a malicious document template/DOTM file.', '[Frankenstein] has used trojanized documents that retrieve remote templates from an adversary-controlled website.', '[Dragonfly 2.0] has injected SMB URLs into malicious Word spearphishing attachments to initiate [Forced Authentication]']"
T1134,Access Token Manipulation,"Adversaries may modify access tokens to operate under a different user or system security context to perform actions and bypass access controls. Windows uses access tokens to determine the ownership of a running process. A user can manipulate access tokens to make a running process appear as though it is the child of a different process or belongs to someone other than the user that started the process. When this occurs, the process also takes on the security context associated with the new token.  An adversary can use built-in Windows API functions to copy access tokens from existing processes; this is known as token stealing. These token can then be applied to an existing process (i.e. [Token Impersonation/Theft] or used to spawn a new process (i.e. [Create Process with Token] An adversary must already be in a privileged user context (i.e. administrator) to steal a token. However, adversaries commonly use token stealing to elevate their security context from the administrator level to the SYSTEM level. An adversary can then use a token to authenticate to a remote system as the account for that token if the account has appropriate permissions on the remote system.  Any standard user can use the <code>runas</code> command, and the Windows API functions, to create impersonation tokens; it does not require access to an administrator account. There are also other mechanisms, such as Active Directory fields, that can be used to modify access tokens.","['[HermeticWiper] can use `AdjustTokenPrivileges` to grant itself privileges for debugging with `SeDebugPrivilege`, creating backups with `SeBackupPrivilege`, loading drivers with `SeLoadDriverPrivilege`, and shutting down a local system with `SeShutdownPrivilege`.', '[SUNSPOT] modified its security token to grants itself debugging privileges by adding <code>SeDebugPrivilege</code>.', '[PowerSploit] <code>Invoke-TokenManipulation</code> Exfiltration module can be used to manipulate tokens.', '[AppleSeed] can gain system level privilege by passing <code>SeDebugPrivilege</code> to the <code>AdjustTokenPrivilege</code> API.', '[Sliver] has the ability to manipulate user tokens on targeted Windows systems.', '[FIN6] has used has used Metasploit’s named-pipe impersonation technique to escalate privileges.', '[Blue Mockingbird] has used JuicyPotato to abuse the <code>SeImpersonate</code> token privilege to escalate from web application pool accounts to NT Authority\\SYSTEM.', '[SslMM] contains a feature to manipulate process privileges and tokens.', '[Duqu] examines running system processes for tokens that have specific system privileges. If it finds one, it will copy the token and store it for later use. Eventually it will start new processes with the stored token attached. It can also steal tokens to acquire administrative privileges.', '[Empire] can use [PowerSploit] <code>Invoke-TokenManipulation</code> to manipulate access tokens.', '[Gelsemium] can use token manipulation to bypass UAC on Windows7 systems.', '[Cuba] has used <code>SeDebugPrivilege</code> and <code>AdjustTokenPrivileges</code> to elevate privileges.', '[Mafalda] can use `AdjustTokenPrivileges()` to elevate privileges.', 'During [C0017] [APT41] used a ConfuserEx obfuscated BADPOTATO exploit to abuse named-pipe impersonation for local `NT AUTHORITY\\SYSTEM` privilege escalation.', '[PoshC2] can use Invoke-TokenManipulation for manipulating tokens.', '[Hydraq] creates a backdoor through which remote attackers can adjust token privileges.', '[KillDisk] has attempted to get the access token of a process by calling <code>OpenProcessToken</code>. If [KillDisk] gets the access token, then it attempt to modify the token privileges with <code>AdjustTokenPrivileges</code>.', '[Ryuk] has attempted to adjust its token privileges to have the <code>SeDebugPrivilege</code>.', '[MegaCortex] can enable <code>SeDebugPrivilege</code> and adjust token privileges.', '[BlackCat] has the ability modify access tokens.']"
T1111,Multi-Factor Authentication Interception,"Adversaries may target multi-factor authentication (MFA) mechanisms, (i.e., smart cards, token generators, etc.) to gain access to credentials that can be used to access systems, services, and network resources. Use of MFA is recommended and provides a higher level of security than usernames and passwords alone, but organizations should be aware of techniques that could be used to intercept and bypass these security mechanisms.   If a smart card is used for multi-factor authentication, then a keylogger will need to be used to obtain the password associated with a smart card during normal use. With both an inserted card and access to the smart card password, an adversary can connect to a network resource using the infected system to proxy the authentication with the inserted hardware token.   Adversaries may also employ a keylogger to similarly target other hardware tokens, such as RSA SecurID. Capturing token input (including a user's personal identification code) may provide temporary access (i.e. replay the one-time passcode until the next value rollover) as well as possibly enabling adversaries to reliably predict future authentication values (given access to both the algorithm and any seed values used to generate appended temporary codes).   Other methods of MFA may be intercepted and used by an adversary to authenticate. It is common for one-time codes to be sent via out-of-band communications (email, SMS). If the device and/or service is not secured, then it may be vulnerable to interception. Service providers can also be targeted: for example, an adversary may compromise an SMS messaging service in order to steal MFA codes sent to users’ phones.","['[Sykipot] is known to contain functionality that enables targeting of smart card technologies to proxy authentication for connections to restricted network resources using detected hardware tokens.', 'During [Operation Wocao] threat actors used a custom collection method to intercept two-factor authentication soft tokens.', '[Kimsuky] has used a proprietary tool to intercept one time passwords required for two-factor authentication.', '[Chimera] has registered alternate phone numbers for compromised users to intercept 2FA codes sent via SMS.', '[LAPSUS$] has replayed stolen session token and passwords to trigger simple-approval MFA prompts in hope of the legitimate user will grant necessary approval.', '[Operation Wocao] has used a custom collection method to intercept two-factor authentication soft tokens.']"
T1018,Remote System Discovery,"Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as  [Ping] or <code>net view</code> using [Net]  Adversaries may also analyze data from local host files (ex: <code>C:\Windows\System32\Drivers\etc\hosts</code> or <code>/etc/hosts</code>) or other passive means (such as local [Arp] cache entries) in order to discover the presence of remote systems in an environment.  Adversaries may also target discovery of network infrastructure as well as leverage [Network Device CLI] commands on network devices to gather detailed information about systems within a network (e.g. <code>show cdp neighbors</code>, <code>show arp</code>).   ","['[menuPass] uses scripts to enumerate IP ranges on the victim network. [menuPass] has also issued the command <code>net view /domain</code> to a [PlugX] implant to gather information about remote systems on the network.', '[MURKYTOP] has the capability to identify remote hosts on connected networks.', 'The [TAINTEDSCRIBE] command and execution module can perform target system enumeration.', '[ROADTools] can enumerate Azure AD systems and devices.', '[BitPaymer] can use <code>net view</code> to discover remote systems.', '[QakBot] can identify remote systems through the <code>net view</code> command.', 'During [Operation CuckooBees] the threat actors used the `net view` and `ping` commands as part of their advanced reconnaissance.', 'During [Operation Wocao] threat actors used `nbtscan` and `ping` to discover remote systems, as well as `dsquery subnet` on a domain controller to retrieve all subnets in the Active Directory.', '[Fox Kitten] has used Angry IP Scanner to detect remote systems.', '[USBferry] can use <code>net view</code> to gather information about remote systems.', '[Bazar] can enumerate remote systems using <code> Net View</code>.', '[BADHATCH] can use a PowerShell object such as, `System.Net.NetworkInformation.Ping` to ping a computer.', '[BlackCat] can broadcasts NetBIOS Name Service (NBNC) messages to search for servers connected to compromised networks.', '[Naikon] has used a netbios scanner for remote machine identification.', '[Deep Panda] has used ping to identify other machines of interest.', '[Earth Lusca] used the command <code>powershell “Get-EventLog -LogName security -Newest 500 | where {$_.EventID -eq 4624} | format-list - property * | findstr “Address””</code> to find the network information of successfully logged-in accounts to discovery addresses of other machines. [Earth Lusca] has also used multiple scanning tools to discover other machines within the same compromised network.', 'Commands such as <code>net view</code> can be used in [Net] to gather information about available remote systems.', '[Black Basta] can use LDAP queries to connect to AD and iterate over connected workstations.', '[yty] uses the <code>net view</code> command for discovery.', ""During [FunnyDream] the threat actors used several tools and batch files to map victims' internal networks."", '[FIN5] has used the open source tool Essential NetTools to map the network and build a list of targets.', '[Volt Typhoon] has used multiple methods, including [Ping] to enumerate systems on compromised networks.', '[Sandworm Team] has used a tool to query Active Directory using LDAP, discovering information about computers listed in AD. ', '[njRAT] can identify remote hosts on connected networks.', '[Industroyer] can enumerate remote computers in the compromised network.', '[Remsec] can ping or traceroute a remote host.', 'During the [2015 Ukraine Electric Power Attack] [Sandworm Team] remotely discovered systems over LAN connections. OT systems were visible from the IT network   as well, giving adversaries the ability to discover operational assets. ', '[Ke3chang] has used network scanning and enumeration tools, including [Ping]', '[CrackMapExec] can discover active IP addresses, along with the machine name, within a targeted network.', '[PoetRAT] used Nmap for remote system discovery.', '[HEXANE] has used `net view` to enumerate domain machines.', '[Epic] uses the <code>net view</code> command on the victim’s machine.', '[Kwampirs] collects a list of available servers with the command <code>net view</code>.', '[FunnyDream] can collect information about hosts on the victim network.', 'During the [SolarWinds Compromise] [APT29] used [AdFind] to enumerate remote systems.', '[Comnie] runs the <code>net view</code> command', '[WannaCry] scans its local network segment for remote systems to try to exploit and copy itself to.', '[Threat Group-3390] has used the <code>net view</code> command.', '[Sykipot] may use <code>net view /domain</code> to display hostnames of available systems on a network.', '[Cobalt Strike] uses the native Windows Network Enumeration APIs to interrogate and discover targets in a Windows Active Directory network.', '[SILENTTRINITY] can enumerate and collect the properties of domain computers.', '[BloodHound] can enumerate and collect the properties of domain computers, including domain controllers.', '[DRATzarus] can search for other machines connected to compromised host and attempt to map the network.', '[OSInfo] performs a connection test to discover remote systems in the network', '[Flagpro] has been used to execute <code>net view</code> on a targeted system. ', '[HermeticWizard] can find machines on the local network by gathering known local IP addresses through `DNSGetCacheDataTable`, `GetIpNetTable`,`WNetOpenEnumW(RESOURCE_GLOBALNET, RESOURCETYPE_ANY)`,`NetServerEnum`,`GetTcpTable`, and `GetAdaptersAddresses.`', '[BRONZE BUTLER] typically use <code>ping</code> and [Net] to enumerate systems.', '[APT39] has used [NBTscan] and custom tools to discover remote systems.', '[Ping] can be used to identify remote systems within a network.', ' [Conti] has the ability to discover hosts on a target network.', '[RATANKBA] runs the <code>net view /domain</code> and <code>net view</code> commands.', '[SHOTPUT] has a command to list all servers in the domain, as well as one to locate domain controllers on a domain.', '[APT32] has enumerated DC servers using the command <code>net group ""Domain Controllers"" /domain</code>. The group has also used the <code>ping</code> command.', '[Silence] has used Nmap to scan the corporate network, build a network topology, and identify vulnerable hosts.\t', '[Carbon] uses the <code>net view</code> command.', '[Kinsing] has used a script to parse files like <code>/etc/hosts</code> and SSH <code>known_hosts</code> to discover remote systems.', ""[FIN6] used publicly available tools (including Microsoft's built-in SQL querying tool, osql.exe) to map the internal network and conduct reconnaissance against Active Directory, Structured Query Language (SQL) servers, and NetBIOS."", '[Diavol] can use the ARP table to find remote hosts to scan. ', '[TrickBot] can enumerate computers and network devices.', '[Indrik Spider] has used PowerView to enumerate all Windows Server, Windows Server 2003, and Windows 7 instances in the Active Directory database.', '[SpicyOmelette] can identify payment systems, payment gateways, and ATM systems in compromised environments.', '[Turla] surveys a system upon check-in to discover remote systems on a local network using the <code>net view</code> and <code>net view /DOMAIN</code> commands. [Turla] has also used <code>net group ""Domain Computers"" /domain</code>, <code>net group ""Domain Controllers"" /domain</code>, and <code>net group ""Exchange Servers"" /domain</code> to enumerate domain computers, including the organization\'s DC and Exchange Server.', ""[Arp] can be used to display a host's ARP cache, which may include address resolutions for remote systems."", '[NBTscan] can list NetBIOS computer names.\t', '[Rocke] has looked for IP addresses in the known_hosts file on the infected system and attempted to SSH into them.\t', '[Leafminer] used Microsoft’s Sysinternals tools to gather detailed information about remote systems.', '[Olympic Destroyer] uses [Windows Management Instrumentation] to enumerate all systems in the network.', '[Magic Hound] has used [Ping] for discovery on targeted networks.', '[Nltest] may be used to enumerate remote domain controllers using options such as <code>/dclist</code> and <code>/dsgetdc</code>.', '[Chimera] has utilized various scans and queries to find domain controllers and remote services in the target environment.', 'During the [2016 Ukraine Electric Power Attack] [Sandworm Team] checked for connectivity to resources within the network and used LDAP to query Active Directory, discovering information about computers listed in AD.', '[HAFNIUM] has enumerated domain controllers using `net group ""Domain computers""` and `nltest /dclist`.', '[Wizard Spider] has used networkdll for network discovery and psfin specifically for financial and point of sale indicators. [Wizard Spider] has also used [AdFind] <code>nltest/dclist</code>, and PowerShell script Get-DataInfo.ps1 to enumerate domain computers, including the domain controller.', '[AdFind] has the ability to query Active Directory for computers.', ""[Shamoon] scans the C-class subnet of the IPs on the victim's interfaces."", '[APT3] has a tool that can detect the existence of remote systems.', ""During [C0015] the threat actors used the commands `net view /all /domain` and `ping` to discover remote systems. They also used PowerView's PowerShell Invoke-ShareFinder script for file share enumeration."", '[GALLIUM] used a modified version of [NBTscan] to identify available NetBIOS name servers over the network as well as <code>ping</code> to identify remote systems.', '[FIN8] has used [dsquery] and other Active Directory utilities to enumerate hosts; they have also used <code>nltest.exe /dclist</code> to retrieve a list of domain controllers.', '[Backdoor.Oldrea] can enumerate and map ICS-specific systems in victim environments.', '[Dragonfly] has likely obtained a list of hosts in the victim environment.', '[TRITON] TsLow python module pings controllers over the TriStation protocol. ', '[UNC2452] used [AdFind] to enumerate remote systems.', '[APT29] has used [AdFind] to enumerate remote systems.', '[Operation Wocao] can use the <code>ping</code> command to discover remote systems.', '[Dragonfly 2.0] likely obtained a list of hosts in the victim environment.', '[Cobalt Strike] uses the native Windows Network Enumeration APIs to interrogate and discover targets in a Windows Active Directory network.']"
T1046,Network Service Discovery,"Adversaries may attempt to get a listing of services running on remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation. Common methods to acquire this information include port and/or vulnerability scans using tools that are brought onto a system.     Within cloud environments, adversaries may attempt to discover services running on other cloud hosts. Additionally, if the cloud environment is connected to a on-premises environment, adversaries may be able to identify services running on non-cloud systems as well.  Within macOS environments, adversaries may use the native Bonjour application to discover services running on other macOS hosts within a network. The Bonjour mDNSResponder daemon automatically registers and advertises a host’s registered services on the network. For example, adversaries can use a mDNS query (such as <code>dns-sd -B _ssh._tcp .</code>) to find other systems broadcasting the ssh service.","['[Pupy] has a built-in module for port scanning.', '[APT39] has used [CrackMapExec] and a custom port scanner known as BLUETORCH for network scanning.', 'During [CostaRicto] the threat actors employed nmap and pscan to scan target environments. ', '[BlackTech] has used the SNScan tool to find other potential targets on victim networks.', '[menuPass] has used tcping.exe, similar to [Ping] to probe port status on systems of interest.', '[Backdoor.Oldrea] can use a network scanning module to identify ICS-related ports.', '[Threat Group-3390] actors use the Hunter tool to conduct network service discovery for vulnerable systems.', '[Industroyer] uses a custom port scanner to map out a network.', '[Empire] can perform port scans from an infected host.', '[FIN13] has utilized `nmap` for reconnaissance efforts. [FIN13] has also scanned for internal MS-SQL servers in a compromised network.', '[Ramsay] can scan for systems that are vulnerable to the EternalBlue exploit.\t', '[DarkVishnya] performed port scanning to obtain the list of active services.', '[OilRig] has used the publicly available tool SoftPerfect Network Scanner as well as a custom tool called GOLDIRONY to conduct network scanning.', '[Lazarus Group] has used nmap from a router VM to scan ports on systems within the restricted segment of an enterprise network.', '[Leafminer] scanned network services to search for vulnerabilities in the victim system.', '[Royal] can scan the network interfaces of targeted systems.', '[SpeakUp] checks for availability of specific ports on servers.', '[BlackEnergy] has conducted port scans on a host.', '[Hildegard] has used masscan to look for kubelets in the internal Kubernetes network.', '[Tropic Trooper] used <code>pr</code> and an openly available tool to scan for open ports on target systems.', '[Naikon] has used the LadonGo scanner to scan target networks.', '[Magic Hound] has used KPortScan 3.0 to perform SMB, RDP, and LDAP scanning.', '[Rocke] conducted scanning for exposed TCP port 7001 as well as SSH and Redis servers.', 'During [C0027] used RustScan to scan for open ports on targeted ESXi appliances.', '[NBTscan] can be used to scan IP networks.', '[APT32] performed network scanning on the network to search for open ports, services, OS finger-printing, and other vulnerabilities.', '[Peirates] can initiate a port scan against a given IP address.', '[BADHATCH] can check for open ports on a computer by establishing a TCP connection.', '[ZxShell] can launch port scans. ', '[Koadic] can scan for open TCP ports on the target network.', '[China Chopper] server component can spider authentication portals.', 'During [C0018] the threat actors used the SoftPerfect Network Scanner for network scanning.', '[Chimera] has used the <code>get -b <start ip> -e <end ip> -p</code> command for network scanning as well as a custom Python tool  packed into a Windows executable named Get.exe to scan IP ranges for HTTP.', '[SILENTTRINITY] can scan for open ports on a compromised machine.', '[APT41] used a malware variant called WIDETONE to conduct port scans on specified subnets.', '[Xbash] can perform port scanning of TCP and UDP ports.', '[Cobalt Strike] can perform port scans from an infected host.', ""[Suckfly] the victim's internal network for hosts with ports 8080, 5900, and 40 open."", '[Brute Ratel C4] can conduct port scanning against targeted systems.', '[P.A.S. Webshell] can scan networks for open ports and listening services.', '[XTunnel] is capable of probing the network for open ports.', '[HermeticWizard] has the ability to scan ports on a compromised network.', ""[FIN6] used publicly available tools (including Microsoft's built-in SQL querying tool, osql.exe) to map the internal network and conduct reconnaissance against Active Directory, Structured Query Language (SQL) servers, and NetBIOS."", '[TeamTNT] has used masscan to search for open Docker API ports and Kubernetes clusters. [TeamTNT] has also used malware that utilizes zmap and zgrab to search for vulnerable services in cloud environments.', 'During [Operation Wocao] threat actors scanned for open ports and used nbtscan to find NETBIOS nameservers.', '[BackdoorDiplomacy] has used SMBTouch, a vulnerability scanner, to determine whether a target is vulnerable to EternalBlue malware.', '[Conficker] scans for other machines to infect.', '[HDoor] scans to identify open ports on the victim.', '[MURKYTOP] has the capability to scan for open ports on hosts in a connected network.', '[Fox Kitten] has used tools including NMAP to conduct broad scanning to identify open ports.', '[InvisiMole] can scan the network for open ports and vulnerable instances of RDP and SMB protocols.', '[PoshC2] can perform port scans from an infected host.', '[Remsec] has a plugin that can perform ARP scanning as well as port scanning.', '[Lucifer] can scan for open ports including TCP ports 135 and 1433.', '[Cobalt Group] leveraged an open-source tool called SoftPerfect Network Scanner to perform network scanning.', '[Caterpillar WebShell] has a module to use a port scanner on a system. ', '[Pysa] can perform network reconnaissance using the Advanced Port Scanner tool.', '[Operation Wocao] has scanned for open ports and used nbtscan to find NETBIOS nameservers.', '[CostaRicto] employed nmap and pscan to scan target environments.', '[Cobalt Strike] can perform port scans from an infected host.', 'APT34 has used the publicly available tool SoftPerfect Network Scanner as well as a custom tool called GOLDIRONY to conduct network scanning.']"
T1124,System Time Discovery,"An adversary may gather the system time and/or time zone from a local or remote system. The system time is set and stored by the Windows Time Service within a domain to maintain time synchronization between systems and services in an enterprise network.   System time information may be gathered in a number of ways, such as with [Net] on Windows by performing <code>net time \\hostname</code> to gather the system time on a remote system. The victim's time zone may also be inferred from the current system time or gathered by using <code>w32tm /tz</code>.  On network devices, [Network Device CLI] commands such as `show clock detail` can be used to see the current time configuration.  This information could be useful for performing other techniques, such as executing a file with a [Scheduled Task/Job] or to discover locality information based on time zone to assist in victim targeting (i.e. [System Location Discovery] Adversaries may also use knowledge of system time as part of a time bomb, or delaying execution until a specified date/time.","['[Shamoon] obtains the system time and will only activate if it is greater than a preset date.', '[Astaroth] collects the timestamp from the infected machine. ', '[Zebrocy] gathers the current time zone and date information from the system.', '[ShadowPad] has collected the current date and time of the victim system.', '[Taidoor] can use <code>GetLocalTime</code> and <code>GetSystemTime</code> to collect system time.', '[EvilBunny] has used the API calls NtQuerySystemTime, GetSystemTimeAsFileTime, and GetTickCount to gather time metrics as part of its checks to see if the malware is running in a sandbox.', '[T9000] gathers and beacons the system time during installation.', '[KEYPLUG] can obtain the current tick count of an infected computer.', '[Sidewinder] has used tools to obtain the current system time.', 'The <code>net time</code> command can be used in [Net] to determine the local or remote system time.', '[SombRAT] can execute <code>getinfo</code>  to discover the current time on a compromised host.', '[Epic] uses the <code>net time</code> command  to get the system time from the machine and collect the current date and time zone information.', '[Torisma] can collect the current time on a victim machine.', 'During [Operation CuckooBees] the threat actors used the `net time` command as part of their advanced reconnaissance.', '[UPPERCUT] has the capability to obtain the time zone information and current timestamp of the victim’s machine.', '[GoldMax] can check the current date-time value of the compromised system, comparing it to the hardcoded execution trigger and can send the current timestamp to the C2 server. ', '[Conficker] uses the current UTC victim system date for domain generation and connects to time servers to determine the current date.', 'During [Operation Wocao] threat actors used the `time` command to retrieve the current time of a compromised system.', '[GravityRAT] can obtain the date and time of a system.', '[Agent Tesla] can collect the timestamp from the victim’s machine.', '[ccf32] can determine the local time on targeted machines.', '[BADHATCH] can obtain the `DATETIME` from a compromised machine.  ', '[GRIFFON] has used a reconnaissance module that can be used to retrieve the date and time of the system.\t', '[QakBot] can identify the system time on a targeted host.', '[Carbon] uses the command <code>net time \\\\127.0.0.1</code> to get information the system’s time.', '[Higaisa] used a function to gather the current time.', '[Egregor] contains functionality to query the local/system time.', '[Crimson] has the ability to determine the date and time on a compromised host.', '[Metamorfo] uses JavaScript to get the system time. ', '[RTM] can obtain the victim time zone.', ""[NOKKI] can collect the current timestamp of the victim's machine."", '[Grandoreiro] can determine the time on the victim machine via IPinfo.', '[DarkWatchman] can collect the time zone information from the system.', '[DRATzarus] can use the `GetTickCount` and `GetSystemTimeAsFileTime` API calls to inspect system time.', '[StoneDrill] can obtain the current date and time of the victim machine.\t', '[build_downer] has the ability to determine the local time to ensure malware installation only happens during the hours that the infected system is active.', '[ZIRCONIUM] has used a tool to capture the time on a compromised host in order to register it with C2.', '[TajMahal] has the ability to determine local time on a compromised host.', '[DCSrv] can compare the current time on an infected host with a configuration value to determine when to start the encryption process.', '[SILENTTRINITY] can collect start time information from a compromised host.', '[PowerDuke] has commands to get the time the machine was built, the time, and the time zone.', '[BRONZE BUTLER] has used <code>net time</code> to check the local time on a target system.', '[Bazar] can collect the time on the compromised host.', ""[MoonWind] obtains the victim's current time."", '[FunnyDream] can check system time to help determine when changes were made to specified files.', '[Turla] surveys a system upon check-in to discover the system time by using the <code>net time</code> command.', '[FELIXROOT] gathers the time zone information from the victim’s machine.', ""[StrifeWater] can collect the time zone from the victim's machine."", '[Darkhotel] malware can obtain system time from a compromised host.', '[SVCReady] can collect time zone information.', '[Zeus Panda] collects the current system time (UTC) and sends it back to the C2 server.', '[PipeMon] can send time zone information from a compromised host to C2.', '[Chimera] has used <code>time /t</code> and <code>net time \\\\ip/hostname</code> for system time discovery.', '[Azorult] can collect the time zone information from the system.', '[Cannon] can collect the current time zone information from the victim’s machine.', '[Clambling] can determine the current time.', '[TAINTEDSCRIBE] can execute <code>GetLocalTime</code> for time discovery.', 'During [C0015] the threat actors used the command `net view /all time` to gather the local time of a compromised network.', ""[ComRAT] has checked the victim system's date and time to perform tasks during business hours (9 to 5, Monday to Friday). "", '[BendyBear] has the ability to determine local time on a compromised host. ', '[Stuxnet] collects the time and date of a system when it is infected.', 'A Destover-like implant used by [Lazarus Group] can obtain the current system time and send it to the C2 server.', '[HOPLIGHT] has been observed collecting system time from victim machines.', '[BLUELIGHT] can collect the local time on a compromised host.', 'As part of the data reconnaissance phase, [Proxysvc] grabs the system time to send back to the control server.', '[OopsIE] checks to see if the system is configured with ""Daylight"" time and checks for a specific region to be set for the timezone.', '[InvisiMole] gathers the local system time from the victim’s machine.', '[SHARPSTATS] has the ability to identify the current date and time on the compromised host.', '[Green Lambert] can collect the date and time from a compromised host.', '[Okrum] can obtain the date and time of the compromised system.', '[Bisonal] can check the system time set on the infected host.', ""[AppleSeed] can pull a timestamp from the victim's machine."", '[AvosLocker] has checked the system time before and after encryption.', '[The White Company] has checked the current date on the victim system.', '[WindTail] has the ability to generate the current date and time.', '[Operation Wocao] has used the <code>time</code> command to retrieve the current time of a compromised system.']"
T1556,Modify Authentication Process,"Adversaries may modify authentication mechanisms and processes to access user credentials or enable otherwise unwarranted access to accounts. The authentication process is handled by mechanisms, such as the Local Security Authentication Server (LSASS) process and the Security Accounts Manager (SAM) on Windows, pluggable authentication modules (PAM) on Unix-based systems, and authorization plugins on MacOS systems, responsible for gathering, storing, and validating credentials. By modifying an authentication process, an adversary may be able to authenticate to a service or system without using [Valid Accounts]  Adversaries may maliciously modify a part of this process to either reveal credentials or bypass authentication mechanisms. Compromised credentials or access may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access and remote desktop.","['[Ebury] can intercept private keys using a trojanized <code>ssh-add</code> function.', '[SILENTTRINITY] can create a backdoor in KeePass using a malicious config file and in TortoiseSVN using a registry hook.', '[Kessel] has trojanized the <sode>ssh_login</code> and <code>user-auth_pubkey</code> functions to steal plaintext credentials.', '[FIN13] has replaced legitimate KeePass binaries with trojanized versions to collect passwords from numerous applications.  ']"
T1211,Exploitation for Defense Evasion,"Adversaries may exploit a system or application vulnerability to bypass security features. Exploitation of a vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. Vulnerabilities may exist in defensive security software that can be used to disable or circumvent them.  Adversaries may have prior knowledge through reconnaissance that security software exists within an environment or they may perform checks during or shortly after the system is compromised for [Security Software Discovery] The security software will likely be targeted directly for exploitation. There are examples of antivirus software being targeted by persistent threat groups to avoid detection.  There have also been examples of vulnerabilities in public cloud infrastructure of SaaS applications that may bypass defense boundaries , evade security logs , or deploy hidden infrastructure.",['[APT28] has used CVE-2015-4902 to bypass security features.']
T1027.009,Embedded Payloads,"Adversaries may embed payloads within other files to conceal malicious content from defenses. Otherwise seemingly benign files (such as scripts and executables) may be abused to carry and obfuscate malicious payloads and content. In some cases, embedded payloads may also enable adversaries to [Subvert Trust Controls] by not impacting execution controls such as digital signatures and notarization tickets.   Adversaries may embed payloads in various file formats to hide payloads. This is similar to [Steganography] though does not involve weaving malicious content into specific bytes and patterns related to legitimate digital media formats.   For example, adversaries have been observed embedding payloads within or as an overlay of an otherwise benign binary. Adversaries have also been observed nesting payloads (such as executables and run-only scripts) inside a file of the same format.   Embedded content may also be used as [Process Injection] payloads used to infect benign system processes. These embedded then injected payloads may be used as part of the modules of malware designed to provide specific features such as encrypting C2 communications in support of an orchestrator module. For example, an embedded module may be injected into default browsers, allowing adversaries to then communicate via the network.","[' The DEADEYE.EMBED variant of [DEADEYE] has the ability to embed payloads inside of a compiled binary.', '[BADHATCH] has an embedded second stage DLL payload within the first stage of the malware.', '[Emotet] has dropped an embedded executable at `%Temp%\\setup.exe`.', '[macOS.OSAMiner] has embedded [Stripped Payloads] within another run-only [Stripped Payloads]', '[Dtrack] has used a dropper that embeds an encrypted payload as extra data.', '[Netwalker] DLL has been embedded within the PowerShell script in hex format.', 'The [SMOKEDHAM] source code is embedded in the dropper as an encrypted string.', '[ComRAT] has embedded a XOR encrypted communications module inside the orchestrator module. ', '[Invoke-PSImage] can be used to embed payload data within a new image file.', 'For [C0021] the threat actors embedded a base64-encoded payload within a LNK file.', 'The [Uroburos] Queue file contains embedded executable files along with key material, communication channels, and modes of operation.']"
T1110.001,Password Guessing,"Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Without knowledge of the password for an account, an adversary may opt to systematically guess the password using a repetitive or iterative mechanism. An adversary may guess login credentials without prior knowledge of system or environment passwords during an operation by using a list of common passwords. Password guessing may or may not take into account the target's policies on password complexity or use policies that may lock accounts out after a number of failed attempts.  Guessing passwords can be a risky option because it could cause numerous authentication failures and account lockouts, depending on the organization's login failure policies.   Typically, management services over commonly used ports are used when guessing passwords. Commonly targeted services include the following:  * SSH (22/TCP) * Telnet (23/TCP) * FTP (21/TCP) * NetBIOS / SMB / Samba (139/TCP & 445/TCP) * LDAP (389/TCP) * Kerberos (88/TCP) * RDP / Terminal Services (3389/TCP) * HTTP/HTTP Management Services (80/TCP & 443/TCP) * MSSQL (1433/TCP) * Oracle (1521/TCP) * MySQL (3306/TCP) * VNC (5900/TCP) * SNMP (161/UDP and 162/TCP/UDP)  In addition to management services, adversaries may ""target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,"" as well as externally facing email applications, such as Office 365.. Further, adversaries may abuse network device interfaces (such as `wlanAPI`) to brute force accessible wifi-router(s) via wireless authentication protocols.  In default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows ""logon failure"" event ID 4625.","['[China Chopper] server component can perform brute force password guessing against authentication portals.', '[Emotet] has been observed using a hard coded list of passwords to brute force user accounts. ', '[SpeakUp] can perform brute forcing using a pre-defined list of usernames and passwords in an attempt to log in to administrative panels. ', '[APT28] has used a brute-force/password-spray tooling that operated in two modes: in brute-force mode it typically sent over 300 authentication attempts per hour per targeted account over the course of several hours or days. [APT28] has also used a Kubernetes cluster to conduct distributed, large-scale password guessing attacks.', '[CrackMapExec] can brute force passwords for a specified user on a single target system or across an entire network.', '[HermeticWizard] can use a list of hardcoded credentials in attempt to authenticate to SMB shares.', '[APT29] has successfully conducted password guessing attacks against a list of mailboxes.', '[Lucifer] has attempted to brute force TCP ports 135 (RPC) and 1433 (MSSQL) with the default username or list of usernames and    passwords.', '[Pony] has used a small dictionary of common passwords against a collected list of local accounts.\t', '[Xbash] can obtain a list of weak passwords from the C2 server to use for brute forcing as well as attempt to brute force services with open ports.', '[P.A.S. Webshell] can use predefined users and passwords to execute brute force attacks against SSH, FTP, POP3, MySQL, MSSQL, and PostgreSQL services.']"
T1498.001,Direct Network Flood,"Adversaries may attempt to cause a denial of service (DoS) by directly sending a high-volume of network traffic to a target. This DoS attack may also reduce the availability and functionality of the targeted system(s) and network. [Direct Network Flood] are when one or more systems are used to send a high-volume of network packets towards the targeted service's network. Almost any network protocol may be used for flooding. Stateless protocols such as UDP or ICMP are commonly used but stateful protocols such as TCP can be used as well.  Botnets are commonly used to conduct network flooding attacks against networks and services. Large botnets can generate a significant amount of traffic from systems spread across the global Internet. Adversaries may have the resources to build out and control their own botnet infrastructure or may rent time on an existing botnet to conduct an attack. In some of the worst cases for distributed DoS (DDoS), so many systems are used to generate the flood that each one only needs to send out a small amount of traffic to produce enough volume to saturate the target network. In such circumstances, distinguishing DDoS traffic from legitimate clients becomes exceedingly difficult. Botnets have been used in some of the most high-profile DDoS flooding attacks, such as the 2012 series of incidents that targeted major US banks.",[]
T1574.007,Path Interception by PATH Environment Variable,"Adversaries may execute their own malicious payloads by hijacking environment variables used to load libraries. The PATH environment variable contains a list of directories (User and System) that the OS searches sequentially through in search of the binary that was called from a script or the command line.   Adversaries can place a malicious program in an earlier entry in the list of directories stored in the PATH environment variable, resulting in the operating system executing the malicious binary rather than the legitimate binary when it searches sequentially through that PATH listing.  For example, on Windows if an adversary places a malicious program named ""net.exe"" in `C:\example path`, which by default precedes `C:\Windows\system32\net.exe` in the PATH environment variable, when ""net"" is executed from the command-line the `C:\example path` will be called instead of the system's legitimate executable at `C:\Windows\system32\net.exe`. Some methods of executing a program rely on the PATH environment variable to determine the locations that are searched when the path for the program is not given, such as executing programs from a [Command and Scripting Interpreter]  Adversaries may also directly modify the $PATH variable specifying the directories to be searched.  An adversary can modify the `$PATH` variable to point to a directory they have write access. When a program using the $PATH variable is called, the OS searches the specified directory and executes the malicious binary. On macOS, this can also be performed through modifying the $HOME variable. These variables can be modified using the command-line, launchctl, [Unix Shell Configuration Modification] or modifying the `/etc/paths.d` folder contents.","['[PowerSploit] contains a collection of Privesc-PowerUp modules that can discover and exploit path interception opportunities in the PATH environment variable.', '[Empire] contains modules that can discover and exploit path interception opportunities in the PATH environment variable.']"
T1499.001,OS Exhaustion Flood,"Adversaries may launch a denial of service (DoS) attack targeting an endpoint's operating system (OS). A system's OS is responsible for managing the finite resources as well as preventing the entire system from being overwhelmed by excessive demands on its capacity. These attacks do not need to exhaust the actual resources on a system; the attacks may simply exhaust the limits and available resources that an OS self-imposes.  Different ways to achieve this exist, including TCP state-exhaustion attacks such as SYN floods and ACK floods. With SYN floods, excessive amounts of SYN packets are sent, but the 3-way TCP handshake is never completed. Because each OS has a maximum number of concurrent TCP connections that it will allow, this can quickly exhaust the ability of the system to receive new requests for TCP connections, thus preventing access to any TCP service provided by the server.  ACK floods leverage the stateful nature of the TCP protocol. A flood of ACK packets are sent to the target. This forces the OS to search its state table for a related TCP connection that has already been established. Because the ACK packets are for connections that do not exist, the OS will have to search the entire state table to confirm that no match exists. When it is necessary to do this for a large flood of packets, the computational requirements can cause the server to become sluggish and/or unresponsive, due to the work it must do to eliminate the rogue ACK packets. This greatly reduces the resources available for providing the targeted service.",[]
T1574.011,Services Registry Permissions Weakness,"Adversaries may execute their own malicious payloads by hijacking the Registry entries used by services. Adversaries may use flaws in the permissions for Registry keys related to services to redirect from the originally specified executable to one that they control, in order to launch their own code when a service starts. Windows stores local service configuration information in the Registry under <code>HKLM\SYSTEM\CurrentControlSet\Services</code>. The information stored under a service's Registry keys can be manipulated to modify a service's execution parameters through tools such as the service controller, sc.exe,  [PowerShell] or [Reg] Access to Registry keys is controlled through access control lists and user permissions.   If the permissions for users and groups are not properly set and allow access to the Registry keys for a service, adversaries may change the service's binPath/ImagePath to point to a different executable under their control. When the service starts or is restarted, then the adversary-controlled program will execute, allowing the adversary to establish persistence and/or privilege escalation to the account context the service is set to execute under (local/domain account, SYSTEM, LocalService, or NetworkService).  Adversaries may also alter other Registry keys in the service’s Registry tree. For example, the <code>FailureCommand</code> key may be changed so that the service is executed in an elevated context anytime the service fails or is intentionally corrupted.  The <code>Performance</code> key contains the name of a driver service's performance DLL and the names of several exported functions in the DLL. If the <code>Performance</code> key is not already present and if an adversary-controlled user has the <code>Create Subkey</code> permission, adversaries may create the <code>Performance</code> key in the service’s Registry tree to point to a malicious DLL.  Adversaries may also add the <code>Parameters</code> key, which stores driver-specific data, or other custom subkeys for their malicious services to establish persistence or enable other malicious activities. Additionally, If adversaries launch their malicious services using svchost.exe, the service’s file may be identified using <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\servicename\Parameters\ServiceDll</code>.",['During [Operation Honeybee] the threat actors used a batch file that modified the COMSysApp service to load a malicious ipnet.dll payload and to load a DLL into the `svchost.exe` process.']
T1499.003,Application Exhaustion Flood,"Adversaries may target resource intensive features of applications to cause a denial of service (DoS), denying availability to those applications. For example, specific features in web applications may be highly resource intensive. Repeated requests to those features may be able to exhaust system resources and deny access to the application or the server itself.",[]
T1542.003,Bootkit,"Adversaries may use bootkits to persist on systems. Bootkits reside at a layer below the operating system and may make it difficult to perform full remediation unless an organization suspects one was used and can act accordingly.  A bootkit is a malware variant that modifies the boot sectors of a hard drive, including the Master Boot Record (MBR) and Volume Boot Record (VBR).  The MBR is the section of disk that is first loaded after completing hardware initialization by the BIOS. It is the location of the boot loader. An adversary who has raw access to the boot drive may overwrite this area, diverting execution during startup from the normal boot loader to adversary code.   The MBR passes control of the boot process to the VBR. Similar to the case of MBR, an adversary who has raw access to the boot drive may overwrite the VBR to divert execution during startup to adversary code.","['[Carberp] has installed a bootkit on the system to maintain persistence.', '[WhisperGate] overwrites the MBR with a bootloader component that performs destructive wiping operations on hard drives and displays a fake ransom note when the host boots.', ""[TrickBot] can implant malicious code into a compromised device's firmware."", '[ROCKBOOT] is a Master Boot Record (MBR) bootkit that uses the MBR to establish persistence.', '[APT41] deployed Master Boot Record bootkits on Windows systems to hide their malware and maintain persistence on victim systems.', '[BOOTRASH] is a Volume Boot Record (VBR) bootkit that uses the VBR to maintain persistence.', 'Some [FinFisher] variants incorporate an MBR rootkit.', '[Lazarus Group] malware WhiskeyAlfa-Three modifies sector 0 of the Master Boot Record (MBR) to ensure that the malware will persist even if a victim machine shuts down.', '[APT28] has deployed a bootkit along with [Downdelph] to ensure its persistence on the victim. The bootkit shares code with some variants of [BlackEnergy]']"
T1036.005,Match Legitimate Name or Location,"Adversaries may match or approximate the name or location of legitimate files or resources when naming/placing them. This is done for the sake of evading defenses and observation. This may be done by placing an executable in a commonly trusted directory (ex: under System32) or giving it the name of a legitimate, trusted program (ex: svchost.exe). In containerized environments, this may also be done by creating a resource in a namespace that matches the naming convention of a container pod or cluster. Alternatively, a file or container image name given may be a close approximation to legitimate programs/images or something innocuous.  Adversaries may also use the same icon of the file they are trying to mimic.","['[Misdat] saves itself as a file named `msdtc.exe`, which is also the name of the legitimate Microsoft Distributed Transaction Coordinator service binary.', '[RainyDay] has used names to mimic legitimate software including ""vmtoolsd.exe"" to spoof Vmtools.', '[TeamTNT] has replaced .dockerd and .dockerenv with their own scripts and cryptocurrency mining software.', '[MechaFlounder] has been downloaded as a file named lsass.exe, which matches the legitimate Windows file.', '[PcShare] has been named `wuauclt.exe` to appear as the legitimate Windows Update AutoUpdate Client.', '[SLOTHFULMEDIA] has mimicked the names of known executables, such as mediaplayer.exe.', 'If installing itself as a service fails, [Elise] instead writes itself as a file named svchost.exe saved in %APPDATA%\\Microsoft\\Network.', '[OwaAuth] uses the filename owaauth.dll, which is a legitimate file that normally resides in <code>%ProgramFiles%\\Microsoft\\Exchange Server\\ClientAccess\\Owa\\Auth\\</code>; the malicious file by the same name is saved in <code>%ProgramFiles%\\Microsoft\\Exchange Server\\ClientAccess\\Owa\\bin\\</code>.', 'During the [2016 Ukraine Electric Power Attack] DLLs and EXEs with filenames associated with common electric power sector protocols were used to masquerade files.', '[Bundlore] has disguised a malicious .app file as a Flash Player update.', '[S-Type] may save itself as a file named `msdtc.exe`, which is also the name of the legitimate Microsoft Distributed Transaction Coordinator service binary.', '[DanBot] files have been named `UltraVNC.exe` and `WINVNC.exe` to appear as legitimate VNC tools.', '[Cyclops Blink] can rename its running process to <code>[kworker:0/1]</code> to masquerade as a Linux kernel thread. [Cyclops Blink] has also named RC scripts used for persistence after WatchGuard artifacts.', '[Gamaredon Group] has used legitimate process names to hide malware including <code>svchosst</code>.', '[TinyTurla] has been deployed as `w64time.dll` to appear legitimate.', '[Carberp] has masqueraded as Windows system file names, as well as ""chkntfs.exe"" and ""syscron.exe"".', '[Volt Typhoon] has used legitimate looking filenames for compressed copies of the ntds.dit database and used names including cisco_up.exe, cl64.exe, vm3dservice.exe, watchdogd.exe, Win.exe, WmiPreSV.exe, and WmiPrvSE.exe for the Earthworm and Fast Reverse Proxy tools.', '[BRONZE BUTLER] has given malware the same name as an existing file on the file share server to cause users to unwittingly launch and install the malware on additional systems.', '[Pony] has used the Adobe Reader icon for the downloaded file to look more trustworthy.\t', '[NightClub] has chosen file names to appear legitimate including EsetUpdate-0117583943.exe for its dropper.', '[TA2541] has used file names to mimic legitimate Windows files or system functionality.', '[IceApple] .NET assemblies have used `App_Web_` in their file names to appear legitimate.', '[Felismus] has masqueraded as legitimate Adobe Content Management System files.', '[APT41] attempted to masquerade their files as popular anti-virus software.', '[REvil] can mimic the names of known executables.', '[Grandoreiro] has named malicious browser extensions and update files to appear legitimate.', '[Indrik Spider] used fake updates for FlashPlayer plugin and Google Chrome as initial infection vectors.', '[FIN7] has attempted to run Darkside ransomware with the filename sleep.exe.', '[Skidmap] has created a fake <code>rm</code> binary to replace the legitimate Linux binary.', 'For [C0018] the threat actors renamed a [Sliver] payload to `vmware_kb.exe`.', 'During the [SolarWinds Compromise] [APT29] renamed software and DLLs with legitimate names to appear benign.', '[Tarrask] has masqueraded as executable files such as `winupdate.exe`, `date.exe`, or `win.exe`.   ', '[OLDBAIT] installs itself in <code>%ALLUSERPROFILE%\\\\Application Data\\Microsoft\\MediaPlayer\\updatewindws.exe</code>; the directory name is missing a space and the file name is missing the letter ""o.""', '[Sibot] has downloaded a DLL to the <code>C:\\windows\\system32\\drivers\\</code> folder and renamed it with a <code>.sys</code> extension.', '[MuddyWater] has disguised malicious executables and used filenames and Registry key names associated with Windows Defender.', '[PyDCrypt] has dropped [DCSrv] under the `svchost.exe` name to disk. ', '[WIRTE] has named a first stage dropper `Kaspersky Update Agent` in order to appear legitimate.', '[Patchwork] installed its payload in the startup programs folder as ""Baidu Software Update."" The group also adds its second stage payload to the startup programs as “Net Monitor."" They have also dropped [QuasarRAT] binaries as files named microsoft_network.exe and crome.exe.', '[BLINDINGCAN] has attempted to hide its payload by using legitimate file names such as ""iconcache.db"".', '[HermeticWizard] has been named `exec_32.dll` to mimic a legitimate MS Outlook .dll.', '[RDAT] has masqueraded as VMware.exe.\t', 'The [Remsec] loader implements itself with the name Security Support Provider, a legitimate Windows function. Various [Remsec] .exe files mimic legitimate file names used by Microsoft, Symantec, Kaspersky, Hewlett-Packard, and VMWare. [Remsec] also disguised malicious modules using similar filenames as custom network encryption software on victims.', '[ANDROMEDA] has been installed to `C:\\Temp\\TrustedInstaller.exe` to mimic a legitimate Windows installer service.', '[Raindrop] was installed under names that resembled legitimate Windows file and directory names.', '[Transparent Tribe] can mimic legitimate Windows directories by using the same icons and names.', '[admin@338] actors used the following command to rename one of their tools to a benign file name: <code>ren ""%temp%\\upload"" audiodg.exe</code>', '[Earth Lusca] used the command `move [file path] c:\\windows\\system32\\spool\\prtprocs\\x64\\spool.dll` to move and register a malicious DLL name as a Windows print processor, which eventually was loaded by the Print Spooler service.', '[Mis-Type] saves itself as a file named `msdtc.exe`, which is also the name of the legitimate Microsoft Distributed Transaction Coordinator service binary.', '[BackdoorDiplomacy] has dropped implants in folders named for legitimate software.', '[KGH_SPY] has masqueraded as a legitimate Windows tool.', '[Bad Rabbit] has masqueraded as a Flash Player installer through the executable file <code>install_flash_player.exe</code>.', 'One of [Dtrack] can hide in replicas of legitimate programs like OllyDbg, 7-Zip, and FileZilla.', ""[Ferocious Kitten] has named malicious files <code>update.exe</code> and loaded them into the compromise host's “Public” folder."", '[SUGARDUMP] has been named `CrashReporter.exe` to appear as a legitimate Mozilla executable.', '[PUNCHBUGGY] mimics filenames from %SYSTEM%\\System32 to hide DLLs in %WINDIR% and/or %TEMP%.', '[Octopus] has been disguised as legitimate programs, such as Java and Telegram Messenger.', '[Ryuk] has constructed legitimate appearing installation folder paths by calling <code>GetWindowsDirectoryW</code> and then inserting a null byte at the fourth character of the path. For Windows Vista or higher, the path would appear as <code>C:\\Users\\Public</code>.', '[HTTPBrowser] installer contains a malicious file named navlu.dll to decrypt and run the RAT. navlu.dll is also the name of a legitimate Symantec DLL.', '[Brute Ratel C4] has used a payload file named OneDrive.update to appear benign.', '[NOKKI] is written to %LOCALAPPDATA%\\MicroSoft Updatea\\svServiceUpdate.exe prior being executed in a new process in an apparent attempt to masquerade as a legitimate folder and file.', '[LightNeuron] has used filenames associated with Exchange and Outlook for binary and configuration files, such as <code>winmail.dat</code>.', '[APT29] has renamed malicious DLLs with legitimate names to appear benign; they have also created an Azure AD certificate with a Common Name that matched the display name of the compromised service principal.', '[APT28] has changed extensions on files containing exfiltrated data to make them appear benign, and renamed a web shell instance to appear as a legitimate OWA page.', 'During [Operation CuckooBees] the threat actors renamed a malicious executable to `rundll32.exe` to allow it to blend in with other Windows system files.', '[Penquin] has mimicked the Cron binary to hide itself on compromised systems.', '[LookBack] has a C2 proxy tool that masquerades as <code>GUP.exe</code>, which is software used by Notepad++.', '[GoldenSpy] setup file installs initial executables under the folder <code>%WinDir%\\System32\\PluginManager</code>.\t', '[Naikon] has disguised malicious programs as Google Chrome, Adobe, and VMware executables.', '[AppleSeed] has the ability to rename its payload to ESTCommon.dll to masquerade as a DLL belonging to ESTsecurity.', '[Small Sieve] can use variations of Microsoft and Outlook spellings, such as ""Microsift"", in its file names to avoid detection.', '[Ursnif] has used strings from legitimate system files and existing folders for its file, folder, and Registry entry names.', '[Machete] renamed payloads to masquerade as legitimate Google Chrome, Java, Dropbox, Adobe Reader and Python executables.', '[Chimera] has renamed malware to GoogleUpdate.exe and WinRAR to jucheck.exe, RecordedTV.ms, teredo.tmp, update.exe, and msadcs1.exe.', '[ThiefQuest] prepends a copy of itself to the beginning of an executable file while maintaining the name of the executable.', '[ShimRatReporter] spoofed itself as <code>AlphaZawgyl_font.exe</code>, a specialized Unicode font.', 'The [Bazar] loader has named malicious shortcuts ""adobe"" and mimicked communications software.', 'The [TAINTEDSCRIBE] main executable has disguised itself as Microsoft’s Narrator.', '[DRATzarus] has been named `Flash.exe`, and its dropper has been named `IExplorer`.', '[Bumblebee] has named component DLLs ""RapportGP.dll"" to match those used by the security company Trusteer.', '[APT32] has renamed a NetCat binary to kb-10233.exe to masquerade as a Windows update. [APT32] has also renamed a Cobalt Strike beacon payload to install_flashplayers.exe. ', '[MCMD] has been named Readme.txt to appear legitimate.', '[StrifeWater] has been named `calc.exe` to appear as a legitimate calculator program.', '[SUNBURST] created VBScripts that were named after existing services or folders to blend into legitimate activities. ', '[Ke3chang] has dropped their malware into legitimate installed software paths including: `C:\\ProgramFiles\\Realtek\\Audio\\HDA\\AERTSr.exe`, `C:\\Program Files (x86)\\Foxit Software\\Foxit Reader\\FoxitRdr64.exe`, `C:\\Program Files (x86)\\Adobe\\Flash Player\\AddIns\\airappinstaller\\airappinstall.exe`, and `C:\\Program Files (x86)\\Adobe\\Acrobat Reader DC\\Reader\\AcroRd64.exe`.', '[QUADAGENT] used the PowerShell filenames <code>Office365DCOMCheck.ps1</code> and <code>SystemDiskClean.ps1</code>.', '[Ramsay] has masqueraded as a 7zip installer.\t', 'During [C0017] [APT41] used file names beginning with USERS, SYSUSER, and SYSLOG for [DEADEYE] and changed [KEYPLUG] file extensions from .vmp  to .upx likely to avoid hunting detections.', '[Tropic Trooper] has hidden payloads in Flash directories and fake installer files.', '[Magic Hound] has used `dllhost.exe` to mask Fast Reverse Proxy (FRP) and `MicrosoftOutLookUpdater.exe` for Plink.', '[SUPERNOVA] has masqueraded as a legitimate SolarWinds DLL.', '[PlugX] has been disguised as legitimate Adobe and PotPlayer files.', '[OSX/Shlayer] can masquerade as a Flash Player update.', '[Starloader] has masqueraded as legitimate software update packages such as Adobe Acrobat Reader and Intel.', '[Chaes] has used an unsigned, crafted DLL module named <code>hha.dll</code> that was designed to look like a legitimate 32-bit Windows DLL.', '[PROMETHIUM] has disguised malicious installer files by bundling them with legitimate software installers.', '[Aoqin Dragon] has used fake icons including antivirus and external drives to disguise malicious payloads.', '[Shark] binaries have been named `audioddg.pdb` and `Winlangdb.pdb` in order to appear legitimate.', '[FoggyWeb] can be disguised as a Visual Studio file such as `Windows.Data.TimeZones.zh-PH.pri` to evade detection. Also, [FoggyWeb] loader can mimic a genuine `dll` file that carries out the same import functions as the legitimate Windows `version.dll` file.', '[NETWIRE] has masqueraded as legitimate software including TeamViewer and macOS Finder.', '[USBStealer] mimics a legitimate Russian program called USB Disk Security.', '[MarkiRAT] can masquerade as <code>update.exe</code> and <code>svehost.exe</code>; it has also mimicked legitimate Telegram and Chrome files.', 'During [Operation Wocao] the threat actors renamed some tools and executables to appear as legitimate programs.', '[LuminousMoth] has disguised their exfiltration malware as `ZoomVideoApp.exe`.', '[HermeticWiper] has used the name `postgressql.exe` to mask a malicious payload.', '[Whitefly] has named the malicious DLL the same name as DLLs belonging to legitimate software from various security vendors.', ""[Nebulae] uses functions named <code>StartUserModeBrowserInjection</code> and <code>StopUserModeBrowserInjection</code> indicating that it's trying to imitate chrome_frame_helper.dll."", '[Machete] [Machete] MSI installer has masqueraded as a legitimate Adobe Acrobat Reader installer.', '[KOCTOPUS] has been disguised as legitimate software programs associated with the travel and airline industries. ', '[TEARDROP] files had names that resembled legitimate Window file and directory names.', '[TEMP.Veles] has renamed files to look like legitimate files, such as Windows update files or Schneider Electric application files. ', '[Carbanak] has named malware ""svchost.exe,"" which is the name of the Windows shared service host program.', 'During [Operation Honeybee] the threat actors used a legitimate Windows executable and secure directory for their payloads to bypass UAC. ', ""[Lazarus Group] has renamed malicious code to disguise it as Microsoft's narrator and other legitimate files."", '[Doki] has disguised a file as a Linux kernel module.', '[SUNSPOT] was identified on disk with a filename of <code>taskhostsvc.exe</code> and it created an encrypted log file at <code>C:\\Windows\\Temp\\vmware-vmdmp.log</code>. ', '[GoldMax] has used filenames that matched the system name, and appeared as a scheduled task impersonating systems management software within the corresponding ProgramData subfolder.', '[BADNEWS] attempts to hide its payloads using legitimate filenames.', 'To establish persistence, [SslMM] identifies the Start Menu Startup directory and drops a link to its own executable disguised as an “Office Start,” “Yahoo Talk,” “MSN Gaming Z0ne,” or “MSN Talk” shortcut.', '[Darkhotel] has used malware that is disguised as a Secure Shell (SSH) tool.', ""The file name AcroRD32.exe, a legitimate process name for Adobe's Acrobat Reader, was used by [APT1] as a name for malware."", '[FinFisher] renames one of its .dll files to uxtheme.dll in an apparent attempt to masquerade as a legitimate file.', '[Blue Mockingbird] has masqueraded their XMRIG payload name by naming it wercplsupporte.dll after the legitimate wercplsupport.dll file.', '[Sidewinder] has named malicious files <code>rekeywiz.exe</code> to match the name of a legitimate Windows executable.', '[Saint Bot] has been disguised as a legitimate executable, including as Windows SDK.', '[RotaJakiro] has used the filename `systemd-daemon` in an attempt to appear legitimate.', '[ThreatNeedle] chooses its payload creation path from a randomly selected service name from netsvc.', '[InnaputRAT] variants have attempted to appear legitimate by using the file names SafeApp.exe and NeutralApp.exe.', '[Calisto] installation file is an unsigned DMG image under the guise of Intego’s security solution for mac.', '[PowGoop] has used a DLL named Goopdate.dll to impersonate a legitimate Google update file.', '[Daserf] uses file and folder names related to legitimate programs in order to blend in, such as HP, Intel, Adobe, and perflogs.', '[menuPass] has been seen changing malicious files to appear legitimate.', '[Metamorfo] has disguised an MSI file as the Adobe Acrobat Reader Installer and has masqueraded payloads as OneDrive, WhatsApp, or Spotify, for example. ', '[Sowbug] named its tools to masquerade as Windows or Adobe Reader software, such as by using the file name adobecms.exe and the directory <code>CSIDL_APPDATA\\microsoft\\security</code>.', '[Pysa] has executed a malicious executable by naming it svchost.exe.', '[APT39] has used malware disguised as Mozilla Firefox and a tool named mfevtpse.exe to proxy C2 communications, closely mimicking a legitimate McAfee file mfevtps.exe.', 'The [Black Basta] dropper has mimicked an application for creating USB bootable drivers.', '[Kimsuky] has renamed malware to legitimate names such as <code>ESTCommon.dll</code> or <code>patch.dll</code>.', '[Green Lambert] has been disguised as a Growl help file.', '[Fysbis] has masqueraded as trusted software rsyncd and dbus-inotifier.', '[Poseidon Group] tools attempt to spoof anti-virus processes as a means of self-defense.', '[Silence] has named its backdoor ""WINWORD.exe"".', '[Chinoxy] has used the name `eoffice.exe` in attempt to appear as a legitimate file.', '[Fox Kitten] has named binaries and configuration files svhost and dllhost respectively to appear legitimate.', '[ChChes] copies itself to an .exe file with a filename that is likely intended to imitate Norton Antivirus but has several letters reversed (e.g. notron.exe).', 'A [Winnti for Windows] implant file was named ASPNET_FILTER.DLL, mimicking the legitimate ASP.NET ISAPI filter DLL with the same name.', '[Goopy] has impersonated the legitimate goopdate.dll, which was dropped on the target system with a legitimate GoogleUpdate.exe.', '[SideCopy] has used a legitimate DLL file name, `Duser.dll` to disguise a malicious remote access tool.', '[Bisonal] has renamed malicious code to `msacm32.dll` to hide within a legitimate library; earlier versions were disguised as `winhelp`. ', '[Ixeshe] has used registry values and file names associated with Adobe software, such as AcroRd32.exe.', '[BackConfig] has hidden malicious payloads in <code>%USERPROFILE%\\Adobe\\Driver\\dwg\\</code> and mimicked the legitimate DHCP service binary.', '[Cuba] has been disguised as legitimate 360 Total Security Antivirus and OpenVPN programs. ', '[PipeMon] modules are stored on disk with seemingly benign names including use of a file extension associated with a popular word processor.', '[Mustang Panda] has used names like `adobeupdate.dat` and `PotPlayerDB.dat` to disguise [PlugX] and a file named `OneDrive.exe` to load a [Cobalt Strike] payload.', '[StrongPity] has been bundled with legitimate software installation files for disguise.', '[Gelsemium] has named malicious binaries `serv.exe`, `winprint.dll`, and `chrome_elf.dll` and has set its persistence in the Registry with the key value <code>Chrome Update</code> to appear legitimate.', '[KONNI] has created a shortcut called ""Anti virus service.lnk"" in an apparent attempt to masquerade as a legitimate file.', '[FIN13] has masqueraded WAR files to look like legitimate packages such as, wsexample.war, wsexamples.com, examples.war, and exampl3s.war.', '[DarkComet] has dropped itself onto victim machines with file names such as WinDefender.Exe and winupdate.exe in an apparent attempt to masquerade as a legitimate file.', '[EKANS] has been disguised as <code>update.exe</code> to appear as a valid executable.', 'During [Operation Sharpshooter] threat actors installed [Rising Sun] in the Startup folder and disguised it as `mssync.exe`.', '[InvisiMole] has disguised its droppers as legitimate software or documents, matching their original names and locations, and saved its files as mpr.dll in the Windows folder.', '[ZLib] mimics the resource version information of legitimate Realtek Semiconductor, Nvidia, or Synaptics modules.', '[QUIETEXIT] has attempted to change its name to `cron` upon startup. During incident response, [QUIETEXIT] samples have been identified that were renamed to blend in with other legitimate files.', '[Sandworm Team] has avoided detection by naming a malicious binary explorer.exe.', '[Rocke] has used shell scripts which download mining executables and saves them with the filename ""java"".', '[TRITON] disguised itself as the legitimate Triconex Trilog application.', '[UNC2452] renamed a version of [AdFind] to <code>sqlceip.exe</code> or <code>csrss.exe</code> in an attempt to appear as the SQL Server Telemetry Client or Client Service Runtime Process, respectively.']"
T1110.002,Password Cracking,"Adversaries may use password cracking to attempt to recover usable credentials, such as plaintext passwords, when credential material such as password hashes are obtained. [OS Credential Dumping] can be used to obtain password hashes, this may only get an adversary so far when [Pass the Hash] is not an option. Further,  adversaries may leverage [Data from Configuration Repository] in order to obtain hashed credentials for network devices.   Techniques to systematically guess the passwords used to compute hashes are available, or the adversary may use a pre-computed rainbow table to crack hashes. Cracking hashes is usually done on adversary-controlled systems outside of the target network. The resulting plaintext password resulting from a successfully cracked hash may be used to log into systems, resources, and services in which the account has access.","['[APT3] has been known to brute force password hashes to be able to leverage plain text credentials.', '[Net Crawler] uses a list of known credentials gathered through credential dumping to guess passwords to accounts as it spreads throughout a network.', '[Dragonfly] has dropped and executed tools used for password cracking, including Hydra and [CrackMapExec]', '[APT41] performed password brute-force attacks on the local admin account.', '[FIN6] has extracted password hashes from ntds.dit to crack offline.', 'During [Night Dragon] threat actors used Cain & Abel to crack password hashes.', '[Dragonfly 2.0] dropped and executed tools used for password cracking, including Hydra and [CrackMapExec]']"
T1555.001,Keychain,"Adversaries may acquire credentials from Keychain. Keychain (or Keychain Services) is the macOS credential management system that stores account names, passwords, private keys, certificates, sensitive application data, payment data, and secure notes. There are three types of Keychains: Login Keychain, System Keychain, and Local Items (iCloud) Keychain. The default Keychain is the Login Keychain, which stores user passwords and information. The System Keychain stores items accessed by the operating system, such as items shared among users on a host. The Local Items (iCloud) Keychain is used for items synced with Apple’s iCloud service.   Keychains can be viewed and edited through the Keychain Access application or using the command-line utility <code>security</code>. Keychain files are located in <code>~/Library/Keychains/</code>, <code>/Library/Keychains/</code>, and <code>/Network/Library/Keychains/</code>.  Adversaries may gather user credentials from Keychain storage/memory. For example, the command <code>security dump-keychain –d</code> will dump all Login Keychain credentials from <code>~/Library/Keychains/login.keychain-db</code>. Adversaries may also directly read Login Keychain credentials from the <code>~/Library/Keychains/login.keychain</code> file. Both methods require a password, where the default password for the Login Keychain is the current user’s password to login to the macOS host.  ","['[Green Lambert] can use Keychain Services API functions to find and collect passwords, such as `SecKeychainFindInternetPassword` and `SecKeychainItemCopyAttributesAndData`. ', '[Proton] gathers credentials in files for keychains.', '[MacMa] can dump credentials from the macOS keychain.', '[LaZagne] can obtain credentials from macOS Keychains.\t', '[Calisto] collects Keychain storage data and copies those passwords/tokens to a file.', '[iKitten] collects the keychains on the system.']"
T1587.001,Malware,"Adversaries may develop malware and malware components that can be used during targeting. Building malicious software can include the development of payloads, droppers, post-compromise tools, backdoors (including backdoored images), packers, C2 protocols, and the creation of infected removable media. Adversaries may develop malware to support their operations, creating a means for maintaining control of remote machines, evading defenses, and executing post-compromise behaviors.  As with legitimate development efforts, different skill sets may be required for developing malware. The skills needed may be located in-house, or may need to be contracted out. Use of a contractor may be considered an extension of that adversary's malware development capabilities, provided the adversary plays a role in shaping requirements and maintains a degree of exclusivity to the malware.  Some aspects of malware development, such as C2 protocol development, may require adversaries to obtain additional infrastructure. For example, malware developed that will communicate with Twitter for C2, may require use of [Web Services]","['[Kimsuky] has developed its own unique malware such as MailFetch.py for use in operations.', '[FIN13] has utilized custom malware to maintain persistence in a compromised environment.', '[Indrik Spider] has developed malware for their operations, including ransomware such as [BitPaymer] and [WastedLocker]', 'During [Operation Wocao] threat actors developed their own custom webshells to upload to compromised servers.', '[Lazarus Group] has developed custom malware for use in their operations.', '[LuminousMoth] has used unique malware for information theft and exfiltration.', '[Sandworm Team] has developed malware for its operations, including malicious mobile applications and destructive malware such as [NotPetya] and [Olympic Destroyer]', '[APT29] has used unique malware in many of their operations.', '[Aoqin Dragon] has used custom malware, including [Mongall] and [Heyoka Backdoor] in their operations.', 'For the [SolarWinds Compromise] [APT29] used numerous pieces of malware that were likely developed for or by the group, including [SUNBURST] [SUNSPOT] [Raindrop] and [TEARDROP] ', '[Cleaver] has created customized tools and payloads for functions including ARP poisoning, encryption, credential dumping, ASP.NET shells, web backdoors, process enumeration, WMI querying, HTTP and SMB communications, network interface sniffing, and keystroke logging.', 'For [Operation Ghost] [APT29] used new strains of malware including [FatDuke] [MiniDuke] [RegDuke] and [PolyglotDuke]', ""[Moses Staff] has built malware, such as [DCSrv] and [PyDCrypt] for targeting victims' machines."", 'For [C0010] UNC3890 actors used unique malware, including [SUGARUSH] and [SUGARDUMP]', '[Turla] has developed its own unique malware for use in operations.', 'For [CostaRicto] the threat actors used custom malware, including [PS1] [CostaBricks] and [SombRAT]', 'For [Operation Sharpshooter] the threat actors used the [Rising Sun] modular backdoor.', '[Ke3chang] has developed custom malware that allowed them to maintain persistence on victim networks.', 'For [Operation Dream Job] [Lazarus Group] developed custom tools such as Sumarta, DBLL Dropper, [Torisma] and [DRATzarus] for their operations.', '[TeamTNT] has developed custom malware such as [Hildegard]', '[FIN7] has developed malware for use in operations, including the creation of infected removable media.', ""[UNC2452] developed [SUNSPOT] [SUNBURST] [TEARDROP] and [Raindrop] [SUNSPOT] and [SUNBURST] were tailored to be incorporated into SolarWind's Orion software library."", '[Night Dragon] used privately developed and customized remote access tools.']"
T1562.009,Safe Mode Boot,"Adversaries may abuse Windows safe mode to disable endpoint defenses. Safe mode starts up the Windows operating system with a limited set of drivers and services. Third-party security software such as endpoint detection and response (EDR) tools may not start after booting Windows in safe mode. There are two versions of safe mode: Safe Mode and Safe Mode with Networking. It is possible to start additional services after a safe mode boot.  Adversaries may abuse safe mode to disable endpoint defenses that may not start with a limited boot. Hosts can be forced into safe mode after the next reboot via modifications to Boot Configuration Data (BCD) stores, which are files that manage boot application settings.  Adversaries may also add their malicious applications to the list of minimal services that start in safe mode by modifying relevant Registry values (i.e. [Modify Registry] Malicious [Component Object Model] (COM) objects may also be registered and loaded in safe mode.","['[REvil] can force a reboot in safe mode with networking.', '[Black Basta] can reboot victim machines in safe mode with networking via `bcdedit /set safeboot network`.', '[AvosLocker] can restart a compromised machine in safe mode. ']"
T1543.003,Windows Service,"Adversaries may create or modify Windows services to repeatedly execute malicious payloads as part of persistence. When Windows boots up, it starts programs or applications called services that perform background system functions. Windows service configuration information, including the file path to the service's executable or recovery programs/commands, is stored in the Windows Registry.  Adversaries may install a new service or modify an existing service to execute at startup in order to persist on a system. Service configurations can be set or modified using system utilities (such as sc.exe), by directly modifying the Registry, or by interacting directly with the Windows API.   Adversaries may also use services to install and execute malicious drivers. For example, after dropping a driver file (ex: `.sys`) to disk, the payload can be loaded and registered via [Native API] functions such as `CreateServiceW()` (or manually via functions such as `ZwLoadDriver()` and `ZwSetValueKey()`), by creating the required service Registry values (i.e. [Modify Registry] or by using command-line utilities such as `PnPUtil.exe`. Adversaries may leverage these drivers as [Rootkit] to hide the presence of malicious activity on a system. Adversaries may also load a signed yet vulnerable driver onto a compromised machine (known as ""Bring Your Own Vulnerable Driver"" (BYOVD)) as part of [Exploitation for Privilege Escalation]  Services may be created with administrator privileges but are executed under SYSTEM privileges, so an adversary may also use a service to escalate privileges. Adversaries may also directly start services through [Service Execution] To make detection analysis more challenging, malicious services may also incorporate [Masquerade Task or Service] (ex: using a service and/or payload name related to a legitimate OS or benign software component).","['[NightClub] has created a Windows service named `WmdmPmSp` to establish persistence.', '[Industroyer] can use an arbitrary system service to load at system boot for persistence and replaces the ImagePath registry value of a Windows service with a new backdoor binary. ', '[Tropic Trooper] has installed a service pointing to a malicious DLL dropped to disk.', '[FunnyDream] has established persistence by running `sc.exe` and by setting the `WSearch` service to run automatically.', '[Winnti for Windows] sets its DLL file as a new service in the Registry to establish persistence.', '[Cuba] can modify services by using the <code>OpenService</code> and <code>ChangeServiceConfig</code> functions. ', '[Briba] installs a service pointing to a malicious DLL dropped to disk.', '[DCSrv] has created new services for persistence by modifying the Registry.', '[WastedLocker] created and established a service that runs until the encryption process is complete. ', '[GoldenSpy] has established persistence by running in the background as an autostart service.\t', 'During [Operation CuckooBees] the threat actors modified the `IKEEXT` and `PrintNotify` Windows services for persistence.', '[DarkVishnya] created new services for shellcode loaders distribution.', ""[Volgmer] installs a copy of itself in a randomly selected service, then overwrites the ServiceDLL entry in the service's Registry entry. Some [Volgmer] variants also install .dll files as services with names generated by a list of hard-coded strings."", '[MoonWind] installs itself as a new service with automatic startup to establish persistence. The service checks every 60 seconds to determine if the malware is running; if not, it will spawn a new instance.', '[CosmicDuke] uses Windows services typically named ""javamtsup"" for persistence.', '[PoisonIvy] creates a Registry subkey that registers a new service. [PoisonIvy] also creates a Registry entry modifying the Logical Disk Manager service to point to a malicious DLL dropped to disk.', '[STARWHALE] has the ability to create the following Windows service to establish persistence on an infected host: `sc create Windowscarpstss binpath= ""cmd.exe /c cscript.exe c:\\\\windows\\\\system32\\\\w7_1.wsf humpback_whale"" start= ""auto"" obj= ""LocalSystem""`.', '[ZeroT] can add a new service to ensure [PlugX] persists on the system when delivered as another payload onto the system.', '[Gelsemium] can drop itself in `C:\\Windows\\System32\\spool\\prtprocs\\x64\\winprint.dll` as an alternative Print Processor to be loaded automatically when the spoolsv Windows service starts.', '[APT38] has installed a new Windows service to establish persistence.', '[QakBot] can remotely create a temporary service on a target host.', '[Conficker] copies itself into the <code>%systemroot%\\system32</code> directory and registers as a service.', '[GreyEnergy] chooses a service, drops a DLL file, and writes it to that serviceDLL Registry key.', '[APT41] modified legitimate Windows services to install malware backdoors. [APT41] created the StorSyncSvc service to provide persistence for Cobalt Strike.', '[KeyBoy] installs a service pointing to a malicious DLL dropped to disk.', '[Wizard Spider] has installed [TrickBot] as a service named ControlServiceA in order to establish persistence. ', '[Elise] configures itself as a service.', 'To establish persistence, [Okrum] can install itself as a new service named NtmSsvc.', '[Blue Mockingbird] has made their XMRIG payloads persistent as a Windows Service.', '[TeamTNT] has used malware that adds cryptocurrency miners as a service.', '[AppleJeus] can install itself as a service. ', '[Dtrack] can add a service called WBService to establish persistence.', '[Stuxnet] uses a driver registered as a boot start service as the main load-point.', '[zwShell] has established persistence by adding itself as a new service.', '[SILENTTRINITY] can establish persistence by creating a new service.', '[ZLib] creates Registry keys to allow itself to run as various services.', '[Bisonal] has been modified to be used as a Windows service. ', '[PsExec] can leverage Windows services to escalate privileges from administrator to SYSTEM with the <code>-s</code> argument.', '[ThreatNeedle] can run in memory and register its payload as a Windows service.', '[Duqu] creates a new service that loads a malicious driver when the system starts. When Duqu is active, the operating system believes that the driver is legitimate, as it has been signed with a valid private key.', 'An [APT19] Port 22 malware variant registers itself as a service.', '[Shamoon] creates a new service named “ntssrv” to execute the payload. Newer versions create the ""MaintenaceSrv"" and ""hdv_725x"" services.', '[TrickBot] establishes persistence by creating an autostart service that allows it to run whenever the machine boots.', '[StreamEx] establishes persistence by installing a new service pointing to its DLL and setting the service to auto-start.', '[Kwampirs] creates a new service named WmiApSrvEx to establish persistence.', '[SLOTHFULMEDIA] has created a service on victim machines named ""TaskFrame"" to establish persistence.', '[Bankshot] can terminate a specific process by its process id.', '[Cobalt Strike] can install a new service.', '[Pandora] has the ability to gain system privileges through Windows services.', '[RDAT] has created a service when it is installed on the victim machine.\t', '[PowerSploit] contains a collection of Privesc-PowerUp modules that can discover and replace/modify service binaries, paths, and configs.', '[Carbon] establishes persistence by creating a service and naming it based off the operating system version running on the current machine.', '[Threat Group-3390] malware can create a new service, sometimes naming it after the config information, to gain persistence.', '[Wiarp] creates a backdoor through which remote attackers can create a service.', '[Nerex] creates a Registry subkey that registers a new service.', '[Catchamas] adds a new service named NetAdapter to establish persistence.', '[Hydraq] creates new services to establish persistence.', '[PlugX] can be added as a service to establish persistence. [PlugX] also has a module to change service configurations as well as start, control, and delete services.', '[Ke3chang] backdoor RoyalDNS established persistence through adding a service called <code>Nwsapagent</code>.', '[LoudMiner] can automatically launch a Linux virtual machine as a service at startup if the AutoStart option is enabled in the VBoxVmService configuration file.', '[PROMETHIUM] has created new services and modified existing services for persistence.', '[Attor] dispatcher can establish persistence by registering a new service.', '[Kazuar] can install itself as a new service.', '[Ursnif] has registered itself as a system service in the Registry for automatic execution at system startup.', '[SUGARUSH] has created a service named `Service1` for persistence.', 'During the [2016 Ukraine Electric Power Attack] [Sandworm Team] used an arbitrary system service to load at system boot for persistence for [Industroyer] They also replaced the ImagePath registry value of a Windows service with a new backdoor binary. ', '[hcdLoader] installs itself as a service for persistence.', '[BitPaymer] has attempted to install itself as a service to maintain persistence.', '[PingPull] has the ability to install itself as a service.', '[TinyZBot] can install as a Windows service for persistence.', 'The [Exaramel for Windows] dropper creates and starts a Windows service named wsmprovav with the description “Windows Check AV.”', '[Anchor] can establish persistence by creating a service.\t', '[KONNI] has registered itself as a service using its export function. ', '[ZxShell] can create a new service using the service parser function ProcessScCommand. ', '[RainyDay] can use services to establish persistence.', '[BBSRAT] can modify service configurations.', '[InvisiMole] can register a Windows service named CsPower as part of its execution chain, and a Windows service named clr_optimization_v2.0.51527_X86 to achieve persistence.', '[APT32] modified Windows Services to ensure PowerShell scripts were loaded on the system. [APT32] also creates a Windows service to establish persistence.', '[TEARDROP] ran as a Windows service from the <code>c:\\windows\\syswow64</code> folder.', '[Nebulae] can create a service to establish persistence.', '[FinFisher] creates a new Windows service with the malicious executable for persistence.', '[StrongPity] has created new services and modified existing services for persistence.', '[Black Basta] can create a new service to establish persistence.', '[Seasalt] is capable of installing itself as a service.', '[Wingbird] uses services.exe to register a new autostart service named ""Audit Service"" using a copy of the local lsass.exe file.', 'During [Operation Honeybee] threat actors installed DLLs and backdoors as Windows services.', '[gh0st RAT] can create a new service to establish persistence.', '[Carbanak] malware installs itself as a service to provide persistence and SYSTEM privileges.', '[Uroburos] has registered a service, typically named `WerFaultSvc`, to decrypt and find a kernel driver and kernel driver loader to maintain persistence.', '[JHUHUGIT] has registered itself as a service to establish persistence.', '[Naid] creates a new service to establish.', '[Ragnar Locker] has used sc.exe to create a new service for the VirtualBox driver.', '[APT3] has a tool that creates a new service for persistence.', '[FIN7] created new Windows services and added them to the startup directories for persistence.', 'Some [InnaputRAT] variants create a new Windows service to establish persistence.', 'One variant of [BlackEnergy] creates a new service using either a hard-coded or randomly generated name.', '[Kimsuky] has created new services for persistence.', '[ShimRat] has installed a Windows service to maintain persistence on victim machines.', 'One persistence mechanism used by [CozyCar] is to register itself as a Windows service.', '[Clambling] can register itself as a system service to gain persistence.', '[TYPEFRAME] variants can add malicious DLL modules as new services.[TYPEFRAME] can also delete services from the victim’s machine.', '[HermeticWiper] can load drivers by creating a new service using the `CreateServiceW` API.', '[Earth Lusca] created a service using the command <code>sc create “SysUpdate” binpath= “cmd /c start “[file path]””&&sc config “SysUpdate” start= auto&&net start SysUpdate</code> for persistence.', '[RawPOS] installs itself as a service to maintain persistence.', '[Cobalt Group] has created new services to establish persistence.', 'Some [Sakula] samples install themselves as services for persistence by calling WinExec with the <code>net start</code> argument.', 'If running as administrator, [TDTESS] installs itself as a new service named bmwappushservice to establish persistence.', 'Several [Lazarus Group] malware families install themselves as new services.', '[AuditCred] is installed as a new service on the system.', '[PipeMon] can establish persistence by registering a malicious DLL as an alternative Print Processor which is loaded when the print spooler service starts.', '[Dyre] registers itself as a service by adding several Registry keys.', '[Emissary] is capable of configuring itself as a service.', '[Empire] can utilize built-in modules to modify service binaries and restore them to their original state.', '[Emotet] has been observed creating new services to maintain persistence. ', '[Reaver] installs itself as a new service.', '[FALLCHILL] has been installed as a Windows service.', '[SysUpdate] can create a service to establish persistence.', '[Nidiran] can create a new service named msamger (Microsoft Security Accounts Manager).', '[WannaCry] creates the service ""mssecsvc2.0"" with the display name ""Microsoft Security Center (2.0) Service.""', '[Honeybee] has batch files that modify the system service COMSysApp to load a malicious DLL.', '[Cobalt Strike] can install a new service.']"
T1499.004,Application or System Exploitation,"Adversaries may exploit software vulnerabilities that can cause an application or system to crash and deny availability to users.  Some systems may automatically restart critical applications and services when crashes occur, but they can likely be re-exploited to cause a persistent denial of service (DoS) condition.  Adversaries may exploit known or zero-day vulnerabilities to crash applications and/or systems, which may also lead to dependent applications and/or systems to be in a DoS condition. Crashed or restarted applications or systems may also have other effects such as [Data Destruction] [Firmware Corruption] [Service Stop] etc. which may further cause a DoS condition and deny availability to critical information, applications and/or systems. ",['[Industroyer] uses a custom DoS tool that leverages CVE-2015-5374 and targets hardcoded IP addresses of Siemens SIPROTEC devices.']
T1574.001,DLL Search Order Hijacking,"Adversaries may execute their own malicious payloads by hijacking the search order used to load DLLs. Windows systems use a common method to look for required DLLs to load into a program.  Hijacking DLL loads may be for the purpose of establishing persistence as well as elevating privileges and/or evading restrictions on file execution.  There are many ways an adversary can hijack DLL loads. Adversaries may plant trojan dynamic-link library files (DLLs) in a directory that will be searched before the location of a legitimate library that will be requested by a program, causing Windows to load their malicious library when it is called for by the victim program. Adversaries may also perform DLL preloading, also called binary planting attacks,  by placing a malicious DLL with the same name as an ambiguously specified DLL in a location that Windows searches before the legitimate DLL. Often this location is the current working directory of the program. Remote DLL preloading attacks occur when a program sets its current directory to a remote location such as a Web share before loading a DLL.   Adversaries may also directly modify the search order via DLL redirection, which after being enabled (in the Registry and creation of a redirection file) may cause a program to load a different DLL.  If a search order-vulnerable program is configured to run at a higher privilege level, then the adversary-controlled DLL that is loaded will also be executed at the higher level. In this case, the technique could be used for privilege escalation from user to administrator or SYSTEM or from administrator to SYSTEM, depending on the program. Programs that fall victim to path hijacking may appear to behave normally because malicious DLLs may be configured to also load the legitimate DLLs they were meant to replace.","['[RTM] has used search order hijacking to force TeamViewer to load a malicious DLL.', '[Tonto Team] abuses a legitimate and signed Microsoft executable to launch a malicious DLL.', '[HTTPBrowser] abuses the Windows DLL load order by using a legitimate Symantec anti-virus binary, VPDN_LU.exe, to load a malicious DLL that mimics a legitimate Symantec DLL, navlu.dll.', 'Variants of [WEBC2] achieve persistence by using DLL search order hijacking, usually by copying the DLL file to <code>%SYSTEMROOT%</code> (<code>C:\\WINDOWS\\ntshrui.dll</code>).', '[Hikit] has used [DLL Search Order Hijacking] to load <code>oci.dll</code> as a persistence mechanism.', '[Whitefly] has used search order hijacking to run the loader Vcrodat.\t', 'A [FinFisher] variant uses DLL search order hijacking.', '[Aquatic Panda] has used DLL search-order hijacking to load `exe`, `dll`, and `dat` files into memory.', '[RedLeaves] is launched through use of DLL search order hijacking to load a malicious dll.', '[PlugX] has the ability to use DLL search order hijacking for installation on targeted systems.', '[Ramsay] can hijack outdated Windows application dependencies with malicious versions of its own DLL payload.\t', '[Evilnum] has used the malware variant, TerraTV, to load a malicious DLL placed in the TeamViewer directory, instead of the original Windows DLL located in a system folder. ', '[Prikormka] uses DLL search order hijacking for persistence by saving itself as ntshrui.dll to the Windows directory so it will load before the legitimate ntshrui.dll saved in the System32 subdirectory.', '[Astaroth] can launch itself via DLL Search Order Hijacking.', '[Melcoz] can use DLL hijacking to bypass security controls.', '[MirageFox] is likely loaded via DLL hijacking into a legitimate McAfee binary.', '[PowerSploit] contains a collection of Privesc-PowerUp modules that can discover and exploit DLL hijacking opportunities in services and processes.', '[FoggyWeb] loader has used DLL Search Order Hijacking to load malicious code instead of the legitimate `version.dll` during the `Microsoft.IdentityServer.ServiceHost.exe` execution process.', ' [WastedLocker] has performed DLL hijacking before execution.', '[Crutch] can persist via DLL search order hijacking on Google Chrome, Mozilla Firefox, or Microsoft OneDrive.', '[Chaes] has used search order hijacking to load a malicious DLL.', '[InvisiMole] can be launched by using DLL search order hijacking in which the wrapper DLL is placed in the same folder as explorer.exe and loaded during startup into the Windows Explorer process instead of the legitimate library.', '[Threat Group-3390] has performed DLL search order hijacking to execute their payload.', '[BackdoorDiplomacy] has executed DLL search order hijacking.', '[BOOSTWRITE] has exploited the loading of the legitimate Dwrite.dll file by actually loading the gdi library, which then loads the gdiplus library and ultimately loads the local Dwrite dll.', '[Empire] contains modules that can discover and exploit various DLL hijacking opportunities.', '[Brute Ratel C4] has used search order hijacking to load a malicious payload DLL as a dependency to a benign application packaged in the same ISO.', '[Downdelph] uses search order hijacking of the Windows executable sysprep.exe to escalate privileges.', '[APT41] has used search order hijacking to execute malicious payloads, such as Winnti RAT.', '[menuPass] has used DLL search order hijacking.']"
T1553.002,Code Signing,"Adversaries may create, acquire, or steal code signing materials to sign their malware or tools. Code signing provides a level of authenticity on a binary from the developer and a guarantee that the binary has not been tampered with.  The certificates used during an operation may be created, acquired, or stolen by the adversary.   Unlike [Invalid Code Signature] this activity will result in a valid signature.  Code signing to verify software on first run can be used on modern Windows and macOS systems. It is not used on Linux due to the decentralized nature of the platform.   Code signing certificates may be used to bypass security policies that require signed code to execute on a system. ","['[Cobalt Strike] can use self signed Java applets to execute signed applet attacks.', '[BackConfig] has been signed with self signed digital certificates mimicking a legitimate software company.', '[FIN7] has signed [Carbanak] payloads with legally purchased code signing certificates. [FIN7] has also digitally signed their phishing documents, backdoors and other staging tools to bypass security controls.', '[Scattered Spider] has used self-signed and stolen certificates originally issued to NVIDIA and Global Software LLC.', 'Some [Daserf] samples were signed with a stolen digital certificate.', '[Patchwork] has signed malware with self-signed certificates from fictitious and spoofed legitimate software companies.', '[HermeticWizard] has been signed by valid certificates assigned to Hermetica Digital.', '[Kimsuky] has signed files with the name EGIS CO,. Ltd..', '[Helminth] samples have been signed with legitimate, compromised code signing certificates owned by software company AI Squared.', 'The [Black Basta] dropper has been digitally signed with a certificate issued by Akeo Consulting for legitimate executables used for creating bootable USB drives.', '[GALLIUM] has used stolen certificates to sign its tools including those from Whizzimo LLC.', '[APT41] leveraged code-signing certificates to sign malware when targeting both gaming and non-gaming organizations.', 'For [C0015] the threat actors used DLL files that had invalid certificates.', '[Molerats] has used forged Microsoft code-signing certificates on malware.', '[SysUpdate] has been signed with stolen digital certificates.', 'The [HermeticWiper] executable has been signed with a legitimate certificate issued to Hermetica Digital Ltd.', '[GreyEnergy] digitally signs the malware with a code-signing certificate.', '[BLINDINGCAN] has been signed with code-signing certificates such as CodeRipper.', '[Nerex] drops a signed Microsoft DLL to disk.', '[AppleJeus] has used a valid digital signature from Sectigo to appear legitimate. ', 'During [Operation Honeybee] the threat actors deployed the MaoCheng dropper with a stolen Adobe Systems digital signature.', '[CSPY Downloader] has come signed with revoked certificates.', 'During [Operation Dream Job] [Lazarus Group] digitally signed their own malware to evade detection.', '[QakBot] can use signed loaders to evade detection. ', '[Ember Bear] has used stolen certificates from Electrum Technologies GmbH to sign payloads.', '[RTM] samples have been signed with a code-signing certificates.', '[Anchor] has been signed with valid certificates to evade detection by security tools.', '[Lazarus Group] has digitally signed malware and utilities to evade detection.', 'During the [SolarWinds Compromise] [APT29] was able to get [SUNBURST] signed by SolarWinds code signing certificates by injecting the malware into the SolarWinds Orion software lifecycle.', '[Turla] has used valid digital certificates from Sysprint AG to sign its [Epic] dropper.', '[Moses Staff] has used signed drivers from an open source tool called DiskCryptor to evade detection.', '[Silence] has used a valid certificate to sign their primary loader Silence.Downloader (aka TrueBot).', '[SUNBURST] was digitally signed by SolarWinds from March - May 2020.', '[Wizard Spider] has used Digicert code-signing certificates for some of its malware.', '[Leviathan] has used stolen code signing certificates to sign malware.', '[FIN6] has used Comodo code-signing certificates.\t', '[Clop] can use code signing to evade detection.', '[menuPass] has resized and added data to the certificate table to enable the signing of modified files with legitimate signatures.', '[BOOSTWRITE] has been signed by a valid CA.', '[PROMETHIUM] has signed code with self-signed certificates.', '[Darkhotel] has used code-signing certificates on its malware that are either forged due to weak keys or stolen. [Darkhotel] has also stolen certificates and signed backdoors and downloaders with them.', '[Bazar] has been signed with fake certificates including those appearing to be from VB CORPORATE PTY. LTD.', '[TA505] has signed payloads with code signing certificates from Thawte and Sectigo.', '[Metamorfo] has digitally signed executables using AVAST Software certificates. ', '[LockerGoga] has been signed with stolen certificates in order to make it look more legitimate.', '[Gazer] versions are signed with various valid certificates; one was likely faked and issued by Comodo for ""Solid Loop Ltd,"" and another was issued for ""Ultimate Computer Support Ltd.""', '[Ecipekac] has used a valid, legitimate digital signature to evade detection.', '[TrickBot] has come with a signed downloader component.', '[More_eggs] has used a signed binary shellcode loader and a signed Dynamic Link Library (DLL) to create a reverse shell.', '[Suckfly] has used stolen certificates to sign its malware.', 'A [QuasarRAT] .dll file is digitally signed by a certificate from AirVPN.', '[Stuxnet] used a digitally signed driver with a compromised Realtek certificate.', '[Ebury] has installed a self-signed RPM package mimicking the original system package on RPM based systems.', '[SpicyOmelette] has been signed with valid digital certificates.', '[StrongPity] has been signed with self-signed certificates.', '[LuminousMoth] has signed their malware with a valid digital signature.', '[PipeMon] its installer, and tools are signed with stolen code-signing certificates.', '[Winnti Group] used stolen certificates to sign its malware.', '[CopyKittens] digitally signed an executable with a stolen certificate from legitimate company AI Squared.', '[Janicab] used a valid AppleDeveloperID to sign the code to get past security restrictions.', '[ChChes] samples were digitally signed with a certificate originally used by Hacking Team that was later leaked and subsequently revoked.', '[Bandook] was signed with valid Certum certificates. ', '[UNC2452] was able to get [SUNBURST] signed by SolarWinds code signing certificates by injecting the malware into the SolarWinds Orion software lifecycle.', '[APT29] was able to get [SUNBURST] signed by SolarWinds code signing certificates by injecting the malware into the SolarWinds Orion software lifecycle.', '[Honeybee] uses a dropper called MaoCheng that harvests a stolen digital signature from Adobe Systems.', '[SDelete] is digitally signed by Microsoft.']"
T1552.002,Credentials in Registry,Adversaries may search the Registry on compromised systems for insecurely stored credentials. The Windows Registry stores configuration information that can be used by the system or other programs. Adversaries may query the Registry looking for credentials and passwords that have been stored for use by other programs or services. Sometimes these credentials are used for automatic logons.  Example commands to find Registry keys related to password information:   * Local Machine Hive: <code>reg query HKLM /f password /t REG_SZ /s</code> * Current User Hive: <code>reg query HKCU /f password /t REG_SZ /s</code>,"['[Reg] may be used to find credentials in the Windows Registry.', '[PowerSploit] has several modules that search the Windows Registry for stored credentials: <code>Get-UnattendedInstallFile</code>, <code>Get-Webconfig</code>, <code>Get-ApplicationHost</code>, <code>Get-SiteListPassword</code>, <code>Get-CachedGPPPassword</code>, and <code>Get-RegistryAutoLogon</code>.', '[APT32] used Outlook Credential Dumper to harvest credentials stored in Windows registry.', '[IceApple] can harvest credentials from local and remote host registries.', '[TrickBot] has retrieved PuTTY credentials by querying the <code>Software\\SimonTatham\\Putty\\Sessions</code> registry key ', '[Valak] can use the clientgrabber module to steal e-mail credentials from the Registry.', '[Agent Tesla] has the ability to extract credentials from the Registry. ']"
T1498.002,Reflection Amplification,"Adversaries may attempt to cause a denial of service (DoS) by reflecting a high-volume of network traffic to a target. This type of Network DoS takes advantage of a third-party server intermediary that hosts and will respond to a given spoofed source IP address. This third-party server is commonly termed a reflector. An adversary accomplishes a reflection attack by sending packets to reflectors with the spoofed address of the victim. Similar to Direct Network Floods, more than one system may be used to conduct the attack, or a botnet may be used. Likewise, one or more reflectors may be used to focus traffic on the target. This Network DoS attack may also reduce the availability and functionality of the targeted system(s) and network.  Reflection attacks often take advantage of protocols with larger responses than requests in order to amplify their traffic, commonly known as a Reflection Amplification attack. Adversaries may be able to generate an increase in volume of attack traffic that is several orders of magnitude greater than the requests sent to the amplifiers. The extent of this increase will depending upon many variables, such as the protocol in question, the technique used, and the amplifying servers that actually produce the amplification in attack volume. Two prominent protocols that have enabled Reflection Amplification Floods are DNS and NTP, though the use of several others in the wild have been documented.  In particular, the memcache protocol showed itself to be a powerful protocol, with amplification sizes up to 51,200 times the requesting packet.",[]
T1505.005,Terminal Services DLL,"Adversaries may abuse components of Terminal Services to enable persistent access to systems. Microsoft Terminal Services, renamed to Remote Desktop Services in some Windows Server OSs as of 2022, enable remote terminal connections to hosts. Terminal Services allows servers to transmit a full, interactive, graphical user interface to clients via RDP.  [Windows Service] that are run as a ""generic"" process (ex: <code>svchost.exe</code>) load the service's DLL file, the location of which is stored in a Registry entry named <code>ServiceDll</code>. The <code>termsrv.dll</code> file, typically stored in `%SystemRoot%\System32\`, is the default <code>ServiceDll</code> value for Terminal Services in `HKLM\System\CurrentControlSet\services\TermService\Parameters\`.  Adversaries may modify and/or replace the Terminal Services DLL to enable persistent access to victimized hosts. Modifications to this DLL could be done to execute arbitrary payloads (while also potentially preserving normal <code>termsrv.dll</code> functionality) as well as to simply enable abusable features of Terminal Services. For example, an adversary may enable features such as concurrent [Remote Desktop Protocol] sessions by either patching the <code>termsrv.dll</code> file or modifying the <code>ServiceDll</code> value to point to a DLL that provides increased RDP functionality. On a non-server Windows OS this increased functionality may also enable an adversary to avoid Terminal Services prompts that warn/log out users of a system when a new RDP session is created.",[]
T1499.002,Service Exhaustion Flood,"Adversaries may target the different network services provided by systems to conduct a denial of service (DoS). Adversaries often target the availability of DNS and web services, however others have been targeted as well. Web server software can be attacked through a variety of means, some of which apply generally while others are specific to the software being used to provide the service.  One example of this type of attack is known as a simple HTTP flood, where an adversary sends a large number of HTTP requests to a web server to overwhelm it and/or an application that runs on top of it. This flood relies on raw volume to accomplish the objective, exhausting any of the various resources required by the victim software to provide the service.  Another variation, known as a SSL renegotiation attack, takes advantage of a protocol feature in SSL/TLS. The SSL/TLS protocol suite includes mechanisms for the client and server to agree on an encryption algorithm to use for subsequent secure connections. If SSL renegotiation is enabled, a request can be made for renegotiation of the crypto algorithm. In a renegotiation attack, the adversary establishes a SSL/TLS connection and then proceeds to make a series of renegotiation requests. Because the cryptographic renegotiation has a meaningful cost in computation cycles, this can cause an impact to the availability of the service when done in volume.",[]
T1195.003,Compromise Hardware Supply Chain,"Adversaries may manipulate hardware components in products prior to receipt by a final consumer for the purpose of data or system compromise. By modifying hardware or firmware in the supply chain, adversaries can insert a backdoor into consumer networks that may be difficult to detect and give the adversary a high degree of control over the system. Hardware backdoors may be inserted into various devices, such as servers, workstations, network infrastructure, or peripherals.",[]
T1547.009,Shortcut Modification,"Adversaries may create or modify shortcuts that can execute a program during system boot or user login. Shortcuts or symbolic links are used to reference other files or programs that will be opened or executed when the shortcut is clicked or executed by a system startup process.  Adversaries may abuse shortcuts in the startup folder to execute their tools and achieve persistence. Although often used as payloads in an infection chain (e.g. [Spearphishing Attachment] adversaries may also create a new shortcut as a means of indirection, while also abusing [Masquerading] to make the malicious shortcut appear as a legitimate program. Adversaries can also edit the target path or entirely replace an existing shortcut so their malware will be executed instead of the intended legitimate program.  Shortcuts can also be abused to establish persistence by implementing other methods. For example, LNK browser extensions may be modified (e.g. [Browser Extensions] to persistently launch malware.","['[RogueRobin] establishes persistence by creating a shortcut (.LNK file) in the Windows startup folder to run a script each time the user logs in.', '[RedLeaves] attempts to add a shortcut file in the Startup folder to achieve persistence.', '[Okrum] can establish persistence by creating a .lnk shortcut to itself in the Startup folder.', '[Reaver] creates a shortcut file and saves it in a Startup folder to establish persistence.', '[Grandoreiro] can write or modify browser shortcuts to enable launching of malicious browser extensions. ', '[APT39] has modified LNK shortcuts.', '[Helminth] establishes persistence by creating a shortcut.', '[MarkiRAT] can modify the shortcut that launches Telegram by replacing its path with the malicious payload to launch with the legitimate executable.', '[Micropsia] creates a shortcut to maintain persistence.', '[Leviathan] has used JavaScript to create a shortcut file in the Startup folder that points to its main backdoor.', 'To establish persistence, [SslMM] identifies the Start Menu Startup directory and drops a link to its own executable disguised as an “Office Start,” “Yahoo Talk,” “MSN Gaming Z0ne,” or “MSN Talk” shortcut.', '[Lazarus Group] malware has maintained persistence on a system by creating a LNK shortcut in the user’s Startup folder.', '[Comnie] establishes persistence via a .lnk file in the victim’s startup path.', '[Gazer] can establish persistence by creating a .lnk file in the Start menu or by modifying existing .lnk files to execute the malware through cmd.exe.', 'The [BlackEnergy] 3 variant drops its main DLL component and then creates a .lnk shortcut to that file in the startup folder.', ""[SPACESHIP] achieves persistence by creating a shortcut in the current user's Startup folder."", '[TinyZBot] can create a shortcut in the Windows startup folder for persistence.', '[Astaroth] initial payload is a malicious .LNK file. ', '[S-Type] may create the file <code>%HOMEPATH%\\Start Menu\\Programs\\Startup\\Realtek {Unique Identifier}.lnk</code>, which points to the malicious `msdtc.exe` file already created in the `%CommonFiles%` directory.', '[SHIPSHAPE] achieves persistence by creating a shortcut in the Startup folder.', '[Gorgon Group] malware can create a .lnk file and add a Registry Run key to establish persistence.', '[BACKSPACE] achieves persistence by creating a shortcut to itself in the CSIDL_STARTUP directory.', '[SeaDuke] is capable of persisting via a .lnk file stored in the Startup directory.', '[InvisiMole] can use a .lnk shortcut for the Control Panel to establish persistence.', '[FELIXROOT] creates a .LNK file for persistence.', 'A version of [KONNI] drops a Windows shortcut on the victim’s machine to establish persistence.', '[Bazar] can establish persistence by writing shortcuts to the Windows Startup folder.', '[Empire] can persist by modifying a .LNK file to include a backdoor.', '[Kazuar] adds a .lnk file to the Windows startup folder.', '[Dragonfly] has manipulated .lnk files to gather user credentials in conjunction with [Forced Authentication]', '[Stuxnet] used copies of .lnk shortcuts to propagate through removable media.', '[APT29] drops a Windows shortcut file for execution.', '[Darkhotel] has dropped an mspaint.lnk shortcut to disk which launches a shell script that downloads and executes a file.', '[Dragonfly 2.0] manipulated .lnk files to gather user credentials in conjunction with [Forced Authentication]']"
T1562.002,Disable Windows Event Logging,"Adversaries may disable Windows event logging to limit data that can be leveraged for detections and audits. Windows event logs record user and system activity such as login attempts, process creation, and much more. This data is used by security tools and analysts to generate detections.  The EventLog service maintains event logs from various system components and applications. By default, the service automatically starts when a system powers on. An audit policy, maintained by the Local Security Policy (secpol.msc), defines which system events the EventLog service logs. Security audit policy settings can be changed by running secpol.msc, then navigating to <code>Security Settings\Local Policies\Audit Policy</code> for basic audit policy settings or <code>Security Settings\Advanced Audit Policy Configuration</code> for advanced audit policy settings. <code>auditpol.exe</code> may also be used to set audit policies.  Adversaries may target system-wide logging or just that of a particular application. For example, the Windows EventLog service may be disabled using the <code>Set-Service -Name EventLog -Status Stopped</code> or <code>sc config eventlog start=disabled</code> commands (followed by manually stopping the service using <code>Stop-Service  -Name EventLog</code>). Additionally, the service may be disabled by modifying the “Start” value in <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog</code> then restarting the system for the change to take effect.  There are several ways to disable the EventLog service via registry key modification. First, without Administrator privileges, adversaries may modify the ""Start"" value in the key <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Security</code>, then reboot the system to disable the Security EventLog. Second, with Administrator privilege, adversaries may modify the same values in <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System</code> and <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Application</code> to disable the entire EventLog.  Additionally, adversaries may use <code>auditpol</code> and its sub-commands in a command prompt to disable auditing or clear the audit policy. To enable or disable a specified setting or audit category, adversaries may use the <code>/success</code> or <code>/failure</code> parameters. For example, <code>auditpol /set /category:”Account Logon” /success:disable /failure:disable</code> turns off auditing for the Account Logon category. To clear the audit policy, adversaries may run the following lines: <code>auditpol /clear /y</code> or <code>auditpol /remove /allusers</code>.  By disabling Windows event logging, adversaries can operate while leaving less evidence of a compromise behind.","['[Wevtutil] can be used to disable specific event logs on the system.', '[Threat Group-3390] has used appcmd.exe to disable logging on a victim server.', '[Magic Hound] has executed scripts to disable the event log service.', 'During the [SolarWinds Compromise] [APT29] used `AUDITPOL` to prevent the collection of audit logs.', 'During the [2016 Ukraine Electric Power Attack] [Sandworm Team] disabled event logging on compromised systems.', '[APT29] used <code>AUDITPOL</code> to prevent the collection of audit logs.', '[Sandworm Team] has disabled event logging on compromised systems.', '[UNC2452] used <code>AUDITPOL</code> to prevent the collection of audit logs.']"
T1021.002,SMB/Windows Admin Shares,"Adversaries may use [Valid Accounts] to interact with a remote network share using Server Message Block (SMB). The adversary may then perform actions as the logged-on user.  SMB is a file, printer, and serial port sharing protocol for Windows machines on the same network or domain. Adversaries may use SMB to interact with file shares, allowing them to move laterally throughout a network. Linux and macOS implementations of SMB typically use Samba.  Windows systems have hidden network shares that are accessible only to administrators and provide the ability for remote file copy and other administrative functions. Example network shares include `C$`, `ADMIN$`, and `IPC$`. Adversaries may use this technique in conjunction with administrator-level [Valid Accounts] to remotely access a networked system over SMB, to interact with systems using remote procedure calls (RPCs), transfer files, and run transferred binaries through remote Execution. Example execution techniques that rely on authenticated sessions over SMB/RPC are [Scheduled Task/Job] [Service Execution] and [Windows Management Instrumentation] Adversaries can also use NTLM hashes to access administrator shares on systems with [Pass the Hash] and certain configuration and patch levels.","['[Conti] can spread via SMB and encrypts files on different hosts, potentially compromising an entire network.', '[Moses Staff] has used batch scripts that can enable SMB on a compromised host.', '[Threat Group-1314] actors mapped network drives using <code>net use</code>.', '[HermeticWizard] can use a list of hardcoded credentials to to authenticate via NTLMSSP to the SMB shares on remote systems.', '[Emotet] has leveraged the Admin$, C$, and IPC$ shares for lateral movement.  ', '[zwShell] has been copied over network shares to move laterally.', '[Ryuk] has used the C$ network share for lateral movement.', '[PsExec] a tool that has been used by adversaries, writes programs to the <code>ADMIN$</code> network share to execute commands on remote systems.', '[Wizard Spider] has used SMB to drop Cobalt Strike Beacon on a domain controller for lateral movement.', '[Shamoon] accesses network share(s), enables share access to the target device, copies an executable payload to the target system, and uses a [Scheduled Task/Job] to execute the malware.', '[APT41] has transferred implant files using Windows Admin Shares.', '[Royal] can use SMB to connect to move laterally.', '[Ke3chang] actors have been known to copy files to the network shares of other computers to move laterally.', '[NotPetya] can use [PsExec] which interacts with the <code>ADMIN$</code> network share to execute commands on remote systems.', '[Turla] used <code>net use</code> commands to connect to lateral systems within a network.', '[Diavol] can spread throughout a network via SMB prior to encryption.', '[BlackEnergy] has run a plug-in on a victim to spread through the local network by using [PsExec] and accessing admin shares.', 'During the [SolarWinds Compromise] [APT29] used administrative accounts to connect over SMB to targeted users.', '[FIN13] has leveraged SMB to move laterally within a compromised network via application servers and SQL servers.', '[Chimera] has used Windows admin shares to move laterally.', '[Fox Kitten] has used valid accounts to access SMB shares.', '[Brute Ratel C4] has the ability to use SMB to pivot in compromised networks.', '[Zox] has the ability to use SMB for communication.', '[Conficker] variants spread through NetBIOS share propagation.', '[Sandworm Team] has copied payloads to the `ADMIN$` share of remote systems and run <code>net use</code> to connect to network shares.', 'During [Operation Wocao] threat actors used [Impacket] smbexec.py as well as accessing the C$ and IPC$ shares to move laterally.', 'Adversaries can instruct [Duqu] to spread laterally by copying itself to shares it has enumerated and for which it has obtained legitimate credentials (via keylogging or other means). The remote host is then infected by using the compromised credentials to schedule a task on remote machines that executes the malware.', '[Kwampirs] copies itself over network shares to move laterally on a victim network.', '[APT3] will copy files over to Windows Admin Shares (like ADMIN$) as part of lateral movement.', 'Lateral movement can be done with [Net] through <code>net use</code> commands to connect to the on remote systems.', '[FIN8] has attempted to map to C$ on enumerated hosts to test the scope of their current credentials/context. [FIN8] has also used smbexec from the [Impacket] suite for lateral movement.', 'The [Regin] malware platform can use Windows admin shares to move laterally.', '[Blue Mockingbird] has used Windows Explorer to manually copy malicious files to remote hosts over SMB.', ""[APT32] used [Net] to use Windows' hidden network shares to copy their tools to remote machines for execution."", '[Stuxnet] propagates to available network shares.', '[Cobalt Strike] can use Window admin shares (C$ and ADMIN$) for lateral movement.', '[Olympic Destroyer] uses [PsExec] to interact with the <code>ADMIN$</code> network share to execute commands on remote systems.', '[Orangeworm] has copied its backdoor across open network shares, including ADMIN$, C$WINDOWS, D$WINDOWS, and E$WINDOWS.', '[Lazarus Group] malware SierraAlfa accesses the <code>ADMIN$</code> share via SMB to conduct lateral movement.', '[Net Crawler] uses Windows admin shares to establish authenticated sessions to remote systems over SMB as part of lateral movement.', '[Lucifer] can infect victims by brute forcing SMB.', 'During the [2016 Ukraine Electric Power Attack] [Sandworm Team] utilized `net use` to connect to network shares.', '[Deep Panda] uses net.exe to connect to network shares using <code>net use</code> commands with compromised credentials.', '[Anchor] can support windows execution via SMB shares.', '[APT39] has used SMB for lateral movement.', '[APT28] has mapped network drives using [Net] and administrator credentials.', '[APT29] has used administrative accounts to connect over SMB to targeted users.', ""[Operation Wocao] has used Impacket's smbexec.py as well as accessing the C$ and IPC$ shares to move laterally."", '[Cobalt Strike] can use Window admin shares (C$ and ADMIN$) for lateral movement.']"
T1562.004,Disable or Modify System Firewall,"Adversaries may disable or modify system firewalls in order to bypass controls limiting network usage. Changes could be disabling the entire mechanism as well as adding, deleting, or modifying particular rules. This can be done numerous ways depending on the operating system, including via command-line, editing Windows Registry keys, and Windows Control Panel.  Modifying or disabling a system firewall may enable adversary C2 communications, lateral movement, and/or data exfiltration that would otherwise not be allowed. For example, adversaries may add a new firewall rule for a well-known protocol (such as RDP) using a non-traditional and potentially less securitized port (i.e. [Non-Standard Port]","['[InvisiMole] has a command to disable routing and the Firewall on the victim’s machine.', '[Carbanak] may use [netsh] to add local firewall rule exceptions.', ""[NanoCore] can modify the victim's firewall."", '[BADCALL] disables the Windows firewall before binding to a port.', '[Rocke] used scripts which killed processes and added firewall rules to block traffic related to other cryptominers.\t', '[TeamTNT] has disabled <code>iptables</code>.', '[H1N1] kills and disables services for Windows Firewall.', '[TYPEFRAME] can open the Windows Firewall on the victim’s machine to allow incoming connections.', '[Dragonfly] has disabled host-based firewalls. The group has also globally opened port 3389.', '[netsh] can be used to disable local firewall settings.', '[PyDCrypt] has modified firewall rules to allow incoming SMB, NetBIOS, and RPC connections using `netsh.exe` on remote machines.', '[Cyclops Blink] can modify the Linux iptables firewall to enable C2 communication via a stored list of port numbers.', '[Moses Staff] has used batch scripts that can disable the Windows firewall on specific remote machines.', '[njRAT] has modified the Windows firewall to allow itself to communicate through the firewall.', '[Grandoreiro] can block the Deibold Warsaw GAS Tecnologia security tool at the firewall level.', '[Remsec] can add or remove applications or ports on the Windows firewall or disable it entirely.', '[ZxShell] can disable the firewall by modifying the registry key <code>HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile</code>. ', '[DarkComet] can disable Security Center functions like the Windows Firewall.', '[CookieMiner] has checked for the presence of ""Little Snitch"", macOS network monitoring and application firewall software, stopping and exiting if it is found.', '[Magic Hound] has added the following rule to a victim\'s Windows firewall to allow RDP traffic - `""netsh"" advfirewall firewall add rule name=""Terminal Server"" dir=in action=allow protocol=TCP localport=3389`.', 'During [Operation Wocao] threat actors used PowerShell to add and delete rules in the Windows firewall.', 'Various [Lazarus Group] malware modifies the Windows firewall to allow incoming connections or disable it entirely using [netsh] ', '[APT38] have created firewall exemptions on specific ports, including ports 443, 6443, 8443, and 9443.', '[Kimsuky] has been observed disabling the system firewall.', '[HOPLIGHT] has modified the firewall using [netsh]\t', '[HARDRAIN] opens the Windows Firewall to modify incoming connections.', 'The ""ZR"" variant of [BACKSPACE] will check to see if known host-based firewalls are installed on the infected systems. [BACKSPACE] will attempt to establish a C2 channel, then will examine open windows to identify a pop-up from the firewall software and will simulate a mouse-click to allow the connection to proceed.', '[Kasidet] has the ability to change firewall settings to allow a plug-in to be downloaded.', 'During the [SolarWinds Compromise] [APT29] used `netsh` to configure firewall rules that limited certain UDP outbound packets.', '[UNC2452] used <code>netsh</code> to configure firewall rules that limited certain UDP outbound packets.', '[APT29] used <code>netsh</code> to configure firewall rules that limited certain UDP outbound packets.', '[Operation Wocao] has used PowerShell to add and delete rules in the Windows firewall.', '[Dragonfly 2.0] has disabled host-based firewalls. The group has also globally opened port 3389.']"
T1543.004,Launch Daemon,"Adversaries may create or modify Launch Daemons to execute malicious payloads as part of persistence. Launch Daemons are plist files used to interact with Launchd, the service management framework used by macOS. Launch Daemons require elevated privileges to install, are executed for every user on a system prior to login, and run in the background without the need for user interaction. During the macOS initialization startup, the launchd process loads the parameters for launch-on-demand system-level daemons from plist files found in <code>/System/Library/LaunchDaemons/</code> and <code>/Library/LaunchDaemons/</code>. Required Launch Daemons parameters include a <code>Label</code> to identify the task, <code>Program</code> to provide a path to the executable, and <code>RunAtLoad</code> to specify when the task is run. Launch Daemons are often used to provide access to shared resources, updates to software, or conduct automation tasks.  Adversaries may install a Launch Daemon configured to execute at startup by using the <code>RunAtLoad</code> parameter set to <code>true</code> and the <code>Program</code> parameter set to the malicious executable path. The daemon name may be disguised by using a name from a related operating system or benign software (i.e. [Masquerading] When the Launch Daemon is executed, the program inherits administrative permissions.  Additionally, system configuration changes (such as the installation of third party package managing software) may cause folders such as <code>usr/local/bin</code> to become globally writeable. So, it is possible for poor configurations to allow an adversary to modify executables referenced by current Launch Daemon's plist files.","['[Green Lambert] can add a plist file in the `Library/LaunchDaemons` to establish persistence. ', 'When running with root privileges after a [Launch Agent] is installed, [ThiefQuest] installs a plist file to the <code>/Library/LaunchDaemons/</code> folder with the <code>RunAtLoad</code> key set to <code>true</code> establishing persistence as a Launch Daemon. ', '[LoudMiner] adds plist files with the naming format <code>com.[random_name].plist</code> in the <code>/Library/LaunchDaemons</code> folder with the RunAtLoad and KeepAlive keys set to <code>true</code>.', 'If running with <code>root</code> permissions, [OSX_OCEANLOTUS.D] can create a persistence file in the folder <code>/Library/LaunchDaemons</code>.', '[Bundlore] can persist via a LaunchDaemon.', '[Dacls] can establish persistence via a Launch Daemon.', '[XCSSET] uses the ssh launchdaemon to elevate privileges, bypass system controls, and enable remote access to the victim.', '[AppleJeus] has placed a plist file within the <code>LaunchDaemons</code> folder and launched it manually.']"
T1574.008,Path Interception by Search Order Hijacking,"Adversaries may execute their own malicious payloads by hijacking the search order used to load other programs. Because some programs do not call other programs using the full path, adversaries may place their own file in the directory where the calling program is located, causing the operating system to launch their malicious software at the request of the calling program.  Search order hijacking occurs when an adversary abuses the order in which Windows searches for programs that are not given a path. Unlike [DLL Search Order Hijacking] the search order differs depending on the method that is used to execute the program.    However, it is common for Windows to search in the directory of the initiating program before searching through the Windows system directory. An adversary who finds a program vulnerable to search order hijacking (i.e., a program that does not specify the path to an executable) may take advantage of this vulnerability by creating a program named after the improperly specified program and placing it within the initiating program's directory.  For example, ""example.exe"" runs ""cmd.exe"" with the command-line argument <code>net user</code>. An adversary may place a program called ""net.exe"" within the same directory as example.exe, ""net.exe"" will be run instead of the Windows system utility net. In addition, if an adversary places a program called ""net.com"" in the same directory as ""net.exe"", then <code>cmd.exe /C net user</code> will execute ""net.com"" instead of ""net.exe"" due to the order of executable extensions defined under PATHEXT.   Search order hijacking is also a common practice for hijacking DLL loads and is covered in [DLL Search Order Hijacking]","['[Empire] contains modules that can discover and exploit search order hijacking vulnerabilities.', '[PowerSploit] contains a collection of Privesc-PowerUp modules that can discover and exploit search order hijacking vulnerabilities.']"
T1505.003,Web Shell,"Adversaries may backdoor web servers with web shells to establish persistent access to systems. A Web shell is a Web script that is placed on an openly accessible Web server to allow an adversary to use the Web server as a gateway into a network. A Web shell may provide a set of functions to execute or a command-line interface on the system that hosts the Web server.  In addition to a server-side script, a Web shell may have a client interface program that is used to talk to the Web server (e.g. [China Chopper] Web shell client).","['[P.A.S. Webshell] can gain remote access and execution on target web servers.', '[OwaAuth] is a Web shell that appears to be exclusively used by [Threat Group-3390] It is installed as an ISAPI filter on Exchange servers and shares characteristics with the [China Chopper] Web shell.', ""[Dragonfly] has commonly created Web shells on victims' publicly accessible email and web servers, which they used to maintain access to a victim network and download additional malicious files."", ""[APT28] has used a modified and obfuscated version of the reGeorg web shell to maintain persistence on a target's Outlook Web Access (OWA) server."", '[OilRig] has used web shells, often to maintain access to a victim network.', '[FIN13] has utilized obfuscated and open-source web shells such as JspSpy, reGeorg, MiniWebCmdShell, and Vonloesch Jsp File Browser 1.2 to enable remote code execution and to execute commands on compromised web server.', ""[BackdoorDiplomacy] has used web shells to establish an initial foothold and for lateral movement within a victim's system."", '[Deep Panda] uses Web shells on publicly accessible Web servers to access victim networks.', 'During [C0017] [APT41] deployed JScript web shells through the creation of malicious ViewState objects.', '[APT39] has installed ANTAK and ASPXSPY web shells.', '[Volatile Cedar] can inject web shell code into a server. ', '[GALLIUM] used Web shells to persist in victim environments and assist in execution and exfiltration.', '[Threat Group-3390] has used a variety of Web shells.', '[ASPXSpy] is a Web shell. The ASPXTool version used by [Threat Group-3390] has been deployed to accessible servers running Internet Information Services (IIS).', '[Tropic Trooper] has started a web service in the target host and wait for the adversary to connect, acting as a web shell.\t', '[TEMP.Veles] has planted Web shells on Outlook Exchange servers.', '[HAFNIUM] has deployed multiple web shells on compromised servers including SIMPLESEESHARP, SPORTSBALL, [China Chopper] and [ASPXSpy]   ', '[Moses Staff] has dropped a web shell onto a compromised system.', '[Sandworm Team] has used webshells including [P.A.S. Webshell] to maintain access to victim networks.', '[Fox Kitten] has installed web shells on compromised hosts to maintain access.', '[Tonto Team] has used a first stage web shell after compromising a vulnerable Exchange server.', '[Volt Typhoon] has used webshells, including ones named AuditReport.jspx and iisstart.aspx, in compromised environments.', '[APT38] has used web shells for persistence or to ensure redundant access.', '[APT29] has installed web shells on exploited Microsoft Exchange servers.', 'During [Operation CuckooBees] the threat actors generated a web shell within a vulnerable Enterprise Resource Planning Web Application Server as a persistence mechanism.', '[SUPERNOVA] is a Web shell.', '[Magic Hound] has used multiple web shells to gain execution.', '[SEASHARPEE] is a Web shell.', '[China Chopper] server component is a Web Shell payload.', '[APT32] has used Web shells to maintain access to victim websites.', ""[Leviathan] relies on web shells for an initial foothold as well as persistence into the victim's systems."", 'During [Operation Wocao] threat actors used their own web shells, as well as those previously placed on target systems by other threat actors, for reconnaissance and lateral movement.', '[Kimsuky] has used modified versions of open source PHP web shells to maintain access, often adding ""Dinosaur"" references within the code.', '[Operation Wocao] has used their own web shells, as well as those previously placed on target systems by other threat actors, for reconnaissance and lateral movement.', ""[Dragonfly 2.0] commonly created Web shells on victims' publicly accessible email and web servers, which they used to maintain access to a victim network and download additional malicious files.""]"
T1552.004,Private Keys,"Adversaries may search for private key certificate files on compromised systems for insecurely stored credentials. Private cryptographic keys and certificates are used for authentication, encryption/decryption, and digital signatures. Common key and certificate file extensions include: .key, .pgp, .gpg, .ppk., .p12, .pem, .pfx, .cer, .p7b, .asc.   Adversaries may also look in common key directories, such as <code>~/.ssh</code> for SSH keys on * nix-based systems or <code>C:&#92;Users&#92;(username)&#92;.ssh&#92;</code> on Windows. Adversary tools may also search compromised systems for file extensions relating to cryptographic keys and certificates.  When a device is registered to Azure AD, a device key and a transport key are generated and used to verify the device’s identity. An adversary with access to the device may be able to export the keys in order to impersonate the device.  On network devices, private keys may be exported via [Network Device CLI] commands such as `crypto pki export`.   Some private keys require a password or passphrase for operation, so an adversary may also use [Input Capture] for keylogging or attempt to [Brute Force] the passphrase off-line. These private keys can be used to authenticate to [Remote Services] like SSH or for use in decrypting other collected files such as email.","['[Machete] has scanned and looked for cryptographic keys and certificate file extensions. ', '[Mimikatz] <code>CRYPTO::Extract</code> module can extract keys by interacting with Windows cryptographic application programming interface (API) functions.', 'During [Operation Wocao] threat actors used [Mimikatz] to dump certificates and private keys from the Windows certificate store.', '[Kinsing] has searched for private keys.', '[Hildegard] has searched for private keys in .ssh.', '[Mafalda] can collect a Chrome encryption key used to protect browser cookies.', 'During the [SolarWinds Compromise] [APT29] obtained PKI keys, certificate files, and the private encryption key from an Active Directory Federation Services (AD FS) container to decrypt corresponding SAML signing certificates.', '[FoggyWeb] can retrieve token signing certificates and token decryption certificates from a compromised AD FS server.', '[TeamTNT] has searched for unsecured SSH keys.', '[Empire] can use modules like <code>Invoke-SessionGopher</code> to extract private key and session information.', '[AADInternals] can gather encryption keys from Azure AD services such as ADSync and Active Directory Federated Services servers.', '[Rocke] has used SSH private keys on the infected machine to spread its coinminer throughout a network.', '[Ebury] has intercepted unencrypted private keys as well as private key pass-phrases.\t', '[jRAT] can steal keys for VPNs and cryptocurrency wallets.', '[UNC2452] obtained the private encryption key from an Active Directory Federation Services (AD FS) container to decrypt corresponding SAML signing certificates.', '[APT29] obtained PKI keys, certificate files and the private encryption key from an Active Directory Federation Services (AD FS) container to decrypt corresponding SAML signing certificates.', '[Operation Wocao] has used Mimikatz to dump certificates and private keys from the Windows certificate store.']"
T1078.001,Default Accounts,"Adversaries may obtain and abuse credentials of a default account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Default accounts are those that are built-into an OS, such as the Guest or Administrator accounts on Windows systems. Default accounts also include default factory/provider set accounts on other types of systems, software, or devices, including the root user account in AWS and the default service account in Kubernetes.  Default accounts are not limited to client machines, rather also include accounts that are preset for equipment such as network devices and computer applications whether they are internal, open source, or commercial. Appliances that come preset with a username and password combination pose a serious threat to organizations that do not change it post installation, as they are easy targets for an adversary. Similarly, adversaries may also utilize publicly disclosed or stolen [Private Keys] or credential materials to legitimately connect to remote environments via [Remote Services]","['[FIN13] has leveraged default credentials for authenticating myWebMethods (WMS) and QLogic web management interface to gain initial access.', '[HyperStack] can use default credentials to connect to IPC$ shares on remote machines.', '[Magic Hound] enabled and used the default system managed account, DefaultAccount, via `""powershell.exe"" /c net user DefaultAccount /active:yes` to connect to a targeted Exchange server over RDP.', '[Stuxnet] infected WinCC machines via a hardcoded database server password.']"
T1574.006,Dynamic Linker Hijacking,"Adversaries may execute their own malicious payloads by hijacking environment variables the dynamic linker uses to load shared libraries. During the execution preparation phase of a program, the dynamic linker loads specified absolute paths of shared libraries from environment variables and files, such as <code>LD_PRELOAD</code> on Linux or <code>DYLD_INSERT_LIBRARIES</code> on macOS. Libraries specified in environment variables are loaded first, taking precedence over system libraries with the same function name. These variables are often used by developers to debug binaries without needing to recompile, deconflict mapped symbols, and implement custom functions without changing the original library.  On Linux and macOS, hijacking dynamic linker variables may grant access to the victim process's memory, system/network resources, and possibly elevated privileges. This method may also evade detection from security products since the execution is masked under a legitimate process. Adversaries can set environment variables via the command line using the <code>export</code> command, <code>setenv</code> function, or <code>putenv</code> function. Adversaries can also leverage [Dynamic Linker Hijacking] to export variables in a shell or set variables programmatically using higher level syntax such Python’s <code>os.environ</code>.  On Linux, adversaries may set <code>LD_PRELOAD</code> to point to malicious libraries that match the name of legitimate libraries which are requested by a victim program, causing the operating system to load the adversary's malicious code upon execution of the victim program. <code>LD_PRELOAD</code> can be set via the environment variable or <code>/etc/ld.so.preload</code> file. Libraries specified by <code>LD_PRELOAD</code> are loaded and mapped into memory by <code>dlopen()</code> and <code>mmap()</code> respectively.    On macOS this behavior is conceptually the same as on Linux, differing only in how the macOS dynamic libraries (dyld) is implemented at a lower level. Adversaries can set the <code>DYLD_INSERT_LIBRARIES</code> environment variable to point to malicious libraries containing names of legitimate libraries or functions requested by a victim program. ","['[Rocke] has modified /etc/ld.so.preload to hook libc functions in order to hide the installed dropper and mining software in process lists.\t', '[Hildegard] has modified /etc/ld.so.preload to intercept shared library import functions.', '[HiddenWasp] adds itself as a shared object to the LD_PRELOAD environment variable.', '[XCSSET] adds malicious file paths to the <code>DYLD_FRAMEWORK_PATH</code> and <code>DYLD_LIBRARY_PATH</code> environment variables to execute malicious code.', '[APT41] has configured payloads to load via LD_PRELOAD.\t', '[Ebury] has injected its dynamic library into descendent processes of sshd via LD_PRELOAD.']"
T1134.002,Create Process with Token,"Adversaries may create a new process with an existing token to escalate privileges and bypass access controls. Processes can be created with the token and resulting security context of another user using features such as <code>CreateProcessWithTokenW</code> and <code>runas</code>.  Creating processes with a token not associated with the current user may require the credentials of the target user, specific privileges to impersonate that user, or access to the token to be used. For example, the token could be duplicated via [Token Impersonation/Theft] or created via [Make and Impersonate Token] before being used to create a process.  While this technique is distinct from [Token Impersonation/Theft] the techniques can be used in conjunction where a token is duplicated and then used to create a new process.","['[Azorult] can call WTSQueryUserToken and CreateProcessAsUser to start a new process with local system privileges.', '[Turla] RPC backdoors can impersonate or steal process tokens before executing commands.\t', '[PipeMon] can attempt to gain administrative privileges using token impersonation.', ""[Lazarus Group] keylogger KiloAlfa obtains user tokens from interactive sessions to execute itself with API call <code>CreateProcessAsUserA</code> under that user's context."", '[PoshC2] can use Invoke-RunAs to make tokens.', '[Aria-body] has the ability to execute a process using <code>runas</code>.', '[REvil] can launch an instance of itself with administrative rights using runas.', '[ZxShell] has a command called RunAs, which creates a new process as another user or process context. ', 'The [WhisperGate] third stage can use the AdvancedRun.exe tool to execute commands in the context of the Windows TrustedInstaller group via `%TEMP%\\AdvancedRun.exe"" /EXEFilename ""C:\\Windows\\System32\\sc.exe"" /WindowState 0 /CommandLine ""stop WinDefend"" /StartDirectory """" /RunAs 8 /Run`.', '[KONNI] has duplicated the token of a high integrity process to spawn an instance of cmd.exe under an impersonated user. ', '[Bankshot] grabs a user token using WTSQueryUserToken and then creates a process by impersonating a logged-on user.', '[Empire] can use <code>Invoke-RunAs</code> to make tokens.']"
T1110.003,Password Spraying,"Adversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials. Password spraying uses one password (e.g. 'Password01'), or a small list of commonly used passwords, that may match the complexity policy of the domain. Logins are attempted with that password against many different accounts on a network to avoid account lockouts that would normally occur when brute forcing a single account with many passwords.   Typically, management services over commonly used ports are used when password spraying. Commonly targeted services include the following:  * SSH (22/TCP) * Telnet (23/TCP) * FTP (21/TCP) * NetBIOS / SMB / Samba (139/TCP & 445/TCP) * LDAP (389/TCP) * Kerberos (88/TCP) * RDP / Terminal Services (3389/TCP) * HTTP/HTTP Management Services (80/TCP & 443/TCP) * MSSQL (1433/TCP) * Oracle (1521/TCP) * MySQL (3306/TCP) * VNC (5900/TCP)  In addition to management services, adversaries may ""target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,"" as well as externally facing email applications, such as Office 365.  In default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows ""logon failure"" event ID 4625.","['[Bad Rabbit] <code>infpub.dat</code> file uses NTLM login credentials to brute force Windows machines.', '[CrackMapExec] can brute force credential authentication by using a supplied list of usernames and a single password.', '[Linux Rabbit] brute forces SSH passwords in order to attempt to gain access and install its malware onto the server. ', '[APT29] has conducted brute force password spray attacks.', '[HEXANE] has used password spraying attacks to obtain valid credentials.', '[Lazarus Group] malware attempts to connect to Windows shares for lateral movement by using a generated list of usernames, which center around permutations of the username Administrator, and weak passwords.', '[APT33] has used password spraying to gain access to target systems.', '[Silent Librarian] has used collected lists of names and e-mail accounts to use in password spraying attacks against private sector targets.', ""[Chimera] has used multiple password spraying attacks against victim's remote services to obtain valid user and administrator accounts."", '[MailSniper] can be used for password spraying against Exchange and Office 365.', '[Leafminer] used a tool called Total SMB BruteForcer to perform internal password spraying.', '[APT28] has used a brute-force/password-spray tooling that operated in two modes: in password-spraying mode it conducted approximately four authentication attempts per hour per targeted account over the course of several days or weeks. [APT28] has also used a Kubernetes cluster to conduct distributed, large-scale password spray attacks.', '[Sandworm Team] has used a script to attempt RPC authentication against a number of hosts. ']"
T1574.005,Executable Installer File Permissions Weakness,"Adversaries may execute their own malicious payloads by hijacking the binaries used by an installer. These processes may automatically execute specific binaries as part of their functionality or to perform other actions. If the permissions on the file system directory containing a target binary, or permissions on the binary itself, are improperly set, then the target binary may be overwritten with another binary using user-level permissions and executed by the original process. If the original process and thread are running under a higher permissions level, then the replaced binary will also execute under higher-level permissions, which could include SYSTEM.  Another variation of this technique can be performed by taking advantage of a weakness that is common in executable, self-extracting installers. During the installation process, it is common for installers to use a subdirectory within the <code>%TEMP%</code> directory to unpack binaries such as DLLs, EXEs, or other payloads. When installers create subdirectories and files they often do not set appropriate permissions to restrict write access, which allows for execution of untrusted code placed in the subdirectories or overwriting of binaries used in the installation process. This behavior is related to and may take advantage of [DLL Search Order Hijacking]  Adversaries may use this technique to replace legitimate binaries with malicious ones as a means of executing code at a higher permissions level. Some installers may also require elevated privileges that will result in privilege escalation when executing adversary controlled code. This behavior is related to [Bypass User Account Control] Several examples of this weakness in existing common installers have been reported to software vendors.   If the executing process is set to run at a specific time or during a certain event (e.g., system bootup) then this technique can also be used for persistence.",[]
T1546.008,Accessibility Features,"Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by accessibility features. Windows contains accessibility features that may be launched with a key combination before a user has logged in (ex: when the user is on the Windows logon screen). An adversary can modify the way these programs are launched to get a command prompt or backdoor without logging in to the system.  Two common accessibility programs are <code>C:\Windows\System32\sethc.exe</code>, launched when the shift key is pressed five times and <code>C:\Windows\System32\utilman.exe</code>, launched when the Windows + U key combination is pressed. The sethc.exe program is often referred to as ""sticky keys"", and has been used by adversaries for unauthenticated access through a remote desktop login screen.   Depending on the version of Windows, an adversary may take advantage of these features in different ways. Common methods used by adversaries include replacing accessibility feature binaries or pointers/references to these binaries in the Registry. In newer versions of Windows, the replaced binary needs to be digitally signed for x64 systems, the binary must reside in <code>%systemdir%\</code>, and it must be protected by Windows File or Resource Protection (WFP/WRP).  The [Image File Execution Options Injection] debugger method was likely discovered as a potential workaround because it does not require the corresponding accessibility feature binary to be replaced.  For simple binary replacement on Windows XP and later as well as and Windows Server 2003/R2 and later, for example, the program (e.g., <code>C:\Windows\System32\utilman.exe</code>) may be replaced with ""cmd.exe"" (or another program that provides backdoor access). Subsequently, pressing the appropriate key combination at the login screen while sitting at the keyboard or when connected over [Remote Desktop Protocol] will cause the replaced file to be executed with SYSTEM privileges.   Other accessibility features exist that may also be leveraged in a similar fashion:   * On-Screen Keyboard: <code>C:\Windows\System32\osk.exe</code> * Magnifier: <code>C:\Windows\System32\Magnify.exe</code> * Narrator: <code>C:\Windows\System32\Narrator.exe</code> * Display Switcher: <code>C:\Windows\System32\DisplaySwitch.exe</code> * App Switcher: <code>C:\Windows\System32\AtBroker.exe</code>","['[Empire] can leverage WMI debugging to remotely replace binaries like sethc.exe, Utilman.exe, and Magnify.exe with cmd.exe.', '[APT41] leveraged sticky keys to establish persistence. ', '[APT3] replaces the Sticky Keys binary <code>C:\\Windows\\System32\\sethc.exe</code> for persistence.', '[Deep Panda] has used the sticky-keys technique to bypass the RDP login screen on remote systems during intrusions.', '[Axiom] actors have been known to use the Sticky Keys replacement within RDP sessions to obtain persistence.', '[Fox Kitten] has used sticky keys to launch a command prompt.', '[APT29] used sticky-keys to obtain unauthenticated, privileged console access.']"
T1562.007,Disable or Modify Cloud Firewall,"Adversaries may disable or modify a firewall within a cloud environment to bypass controls that limit access to cloud resources. Cloud firewalls are separate from system firewalls that are described in [Disable or Modify System Firewall]   Cloud environments typically utilize restrictive security groups and firewall rules that only allow network activity from trusted IP addresses via expected ports and protocols. An adversary may introduce new firewall rules or policies to allow access into a victim cloud environment. For example, an adversary may use a script or utility that creates new ingress rules in existing security groups to allow any TCP/IP connectivity, or remove networking limitations to support traffic associated with malicious activity (such as cryptomining).  Modifying or disabling a cloud firewall may enable adversary C2 communications, lateral movement, and/or data exfiltration that would otherwise not be allowed.",['[Pacu] can allowlist IP addresses in AWS GuardDuty.']
T1542.002,Component Firmware,"Adversaries may modify component firmware to persist on systems. Some adversaries may employ sophisticated means to compromise computer components and install malicious firmware that will execute adversary code outside of the operating system and main system firmware or BIOS. This technique may be similar to [System Firmware] but conducted upon other system components/devices that may not have the same capability or level of integrity checking.  Malicious component firmware could provide both a persistent level of access to systems despite potential typical failures to maintain access and hard disk re-images, as well as a way to evade host software-based defenses and integrity checks.","['[Equation] is known to have the capability to overwrite the firmware on hard drives from some manufacturers. ', '[Cyclops Blink] has maintained persistence by patching legitimate device firmware when it is downloaded, including that of WatchGuard devices.']"
T1550.003,Pass the Ticket,"Adversaries may “pass the ticket” using stolen Kerberos tickets to move laterally within an environment, bypassing normal system access controls. Pass the ticket (PtT) is a method of authenticating to a system using Kerberos tickets without having access to an account's password. Kerberos authentication can be used as the first step to lateral movement to a remote system.  When preforming PtT, valid Kerberos tickets for [Valid Accounts] are captured by [OS Credential Dumping] A user's service tickets or ticket granting ticket (TGT) may be obtained, depending on the level of access. A service ticket allows for access to a particular resource, whereas a TGT can be used to request service tickets from the Ticket Granting Service (TGS) to access any resource the user has privileges to access.  A [Silver Ticket] can be obtained for services that use Kerberos as an authentication mechanism and are used to generate tickets to access that particular resource and the system that hosts the resource (e.g., SharePoint).  A [Golden Ticket] can be obtained for the domain using the Key Distribution Service account KRBTGT account NTLM hash, which enables generation of TGTs for any account in Active Directory.  Adversaries may also create a valid Kerberos ticket using other user information, such as stolen password hashes or AES keys. For example, ""overpassing the hash"" involves using a NTLM password hash to authenticate as a user (i.e. [Pass the Hash] while also using the password hash to create a valid Kerberos ticket.","['Some [SeaDuke] samples have a module to use pass the ticket with Kerberos for authentication.', '[APT29] used Kerberos ticket attacks for lateral movement.', '[Mimikatz] <code>LSADUMP::DCSync</code> and <code>KERBEROS::PTT</code> modules implement the three steps required to extract the krbtgt account hash and create/use Kerberos tickets.', '[Pupy] can also perform pass-the-ticket.', '[APT32] successfully gained remote access by using pass the ticket.', '[BRONZE BUTLER] has created forged Kerberos Ticket Granting Ticket (TGT) and Ticket Granting Service (TGS) tickets to maintain administrative access.']"
T1036.004,Masquerade Task or Service,"Adversaries may attempt to manipulate the name of a task or service to make it appear legitimate or benign. Tasks/services executed by the Task Scheduler or systemd will typically be given a name and/or description. Windows services will have a service name as well as a display name. Many benign tasks and services exist that have commonly associated names. Adversaries may give tasks or services names that are similar or identical to those of legitimate ones.  Tasks or services contain other fields, such as a description, that adversaries may attempt to make appear legitimate.","['[DCSrv] has masqueraded its service as a legitimate svchost.exe process.', 'In one instance, [menuPass] added [PlugX] as a service with a display name of ""Corel Writing Tools Utility.""', '[SVCReady] has named a task `RecoveryExTask` as part of its persistence activity.', 'During [C0017] [APT41] used `SCHTASKS  /Change` to modify legitimate scheduled tasks to run malicious code.', '[Attor] dispatcher disguises itself as a legitimate task (i.e., the task name and description appear legitimate).', '[Maze] operators have created scheduled tasks masquerading as ""Windows Update Security"", ""Windows Update Security Patches"", and ""Google Chrome Security Update"" designed to launch the ransomware. ', '[RDAT] has used Windows Video Service as a name for malicious services.', '[Kimsuky] has disguised services to appear as benign software or related to operating system functions.', '[Carbanak] has copied legitimate service names to use for malicious services.', '[SUGARDUMP] scheduled task has been named `MicrosoftInternetExplorerCrashRepoeterTaskMachineUA` or `MicrosoftEdgeCrashRepoeterTaskMachineUA`, depending on the Windows OS version. ', '[POWERSTATS] has created a scheduled task named ""MicrosoftEdge"" to establish persistence.', '[Fysbis] has masqueraded as the rsyncd and dbus-inotifier services.', '[Meteor] has been disguised as the Windows Power Efficiency Diagnostics report tool.', 'New services created by [RawPOS] are made to appear like legitimate Windows services, with names such as ""Windows Management Help Service"", ""Microsoft Support"", and ""Windows Advanced Task Manager"".', '[FIN7] has created a scheduled task named “AdobeFlashSync” to establish persistence.', '[RainyDay] has named services and scheduled tasks to appear benign including ""ChromeCheck"" and ""googleupdate.""', '[Shamoon] creates a new service named “ntssrv” that attempts to appear legitimate; the service\'s display name is “Microsoft Network Realtime Inspection Service” and its description is “Helps guard against time change attempts targeting known and newly discovered vulnerabilities in network time protocols.” Newer versions create the ""MaintenaceSrv"" service, which misspells the word ""maintenance.""', '[ZxxZ] has been disguised as a Windows security update service.', '[build_downer] has added itself to the Registry Run key as ""NVIDIA"" to appear legitimate.', '[PingPull] can mimic the names and descriptions of legitimate services such as `iphlpsvc`, `IP Helper`,  and `Onedrive` to evade detection.', '[StrongPity] has named services to appear legitimate.', '[Seasalt] has masqueraded as a service called ""SaSaut"" with a display name of ""System Authorization Service"" in an apparent attempt to masquerade as a legitimate service.', '[KONNI] has pretended to be the xmlProv Network Provisioning service. ', '[SLOTHFULMEDIA] has named a service it establishes on victim machines as ""TaskFrame"" to hide its malicious purpose. ', ""[FIN13] has used scheduled tasks names such as `acrotyr` and `AppServicesr` to mimic the same names in a compromised network's `C:\\Windows` directory."", '[APT-C-36] has disguised its scheduled tasks as those used by Google.', '[FunnyDream] has used a service named `WSearch` for execution.', '[CSPY Downloader] has attempted to appear as a legitimate Windows service with a fake description claiming it is used to support packed applications.', '[Okrum] can establish persistence by adding a new service NtmsSvc with the display name Removable Storage to masquerade as a legitimate Removable Storage Manager.', '[Uroburos] has registered a service named `WerFaultSvc`, likely to spoof the legitimate Windows error reporting service.', '[ShimRat] can impersonate Windows services and antivirus products to avoid detection on compromised systems.', '[Egregor] has masqueraded the svchost.exe process to exfiltrate data.', '[Machete] renamed task names to masquerade as legitimate Google Chrome, Java, Dropbox, Adobe Reader and Python tasks. ', '[APT32] has used hidden or non-printing characters to help masquerade service names, such as appending a Unicode no-break space character to a legitimate service name. [APT32] has also impersonated the legitimate Flash installer file name ""install_flashplayer.exe"".', '[Tarrask] creates a scheduled task called “WinUpdate” to re-establish any dropped  C2 connections.', '[Hildegard] has disguised itself as a known Linux process.', '[Wizard Spider] has used scheduled tasks to install [TrickBot] using task names to appear legitimate such as WinDotNet, GoogleTask, or Sysnetsf. It has also used common document file names for other malware binaries.', '[TinyTurla] has mimicked an existing Windows service by being installed as <code>Windows Time Service</code>.', '[SysUpdate] has named their unit configuration file similarly to other unit files residing in the same directory, `/usr/lib/systemd/system/`, to appear benign.', '[BITTER] has disguised malware as a Windows Security update service.', 'To establish persistence, [Truvasys] adds a Registry Run key with a value ""TaskMgr"" in an attempt to masquerade as the legitimate Windows Task Manager.', '[RTM] has named the scheduled task it creates ""Windows Update"".', '[FIN6] has renamed the ""psexec"" service name to ""mstdc"" to masquerade as a legitimate Windows service.\t', '[Nebulae] has created a service named ""Windows Update Agent1"" to appear legitimate.', '[Naikon] renamed a malicious service <code>taskmgr</code> to appear to be a legitimate version of Task Manager.', '[IronNetInjector] has been disguised as a legitimate service using the name PythonUpdateSrvc.', '[NightClub] has created a service named `WmdmPmSp` to spoof a Windows Media service.', '[Nidiran] can create a new service named msamger (Microsoft Security Accounts Manager), which mimics the legitimate Microsoft database by the same name.', '[Bazar] can create a task named to appear benign.', '[Crutch] has established persistence with a scheduled task impersonating the Outlook item finder.', '[Emotet] has installed itself as a new service with the service name `Windows Defender System Service` and display name `WinDefService`.', ""[OSX_OCEANLOTUS.D] uses file naming conventions with associated executable locations to blend in with the macOS TimeMachine and OpenSSL services. Such as, naming a LaunchAgent plist file `com.apple.openssl.plist` which executes [OSX_OCEANLOTUS.D] from the user's `~/Library/OpenSSL/` folder upon user login."", '[Fox Kitten] has named the task for a reverse proxy lpupdate to appear legitimate.', '[PROMETHIUM] has named services to appear legitimate.', '[InnaputRAT] variants have attempted to appear legitimate by adding a new service named OfficeUpdateService.', '[Kwampirs] establishes persistence by adding a new service with the display name ""WMI Performance Adapter Extension"" in an attempt to masquerade as a legitimate WMI service.', '[Catchamas] adds a new service named NetAdapter in an apparent attempt to masquerade as a legitimate service.', 'During [Frankenstein] the threat actors named a malicious scheduled task ""WinUpdate"" for persistence.', '[DEADEYE] has used `schtasks /change` to modify scheduled tasks including `\\Microsoft\\Windows\\PLA\\Server Manager Performance Monitor`, `\\Microsoft\\Windows\\Ras\\ManagerMobility, \\Microsoft\\Windows\\WDI\\SrvSetupResults`, and `\\Microsoft\\Windows\\WDI\\USOShared`.', '[ZIRCONIUM] has created a run key named <code>Dropbox Update Setup</code> to mask a persistence mechanism for a malicious binary.', '[Green Lambert] has created a new executable named `Software Update Check` to appear legitimate. ', '[Magic Hound] has named a malicious script CacheTask.bat to mimic a legitimate task.', '[KillDisk] registers as a service under the Plug-And-Play Support name.', 'During the [SolarWinds Compromise] [APT29] named tasks `\\Microsoft\\Windows\\SoftwareProtectionPlatform\\EventCacheManager` in order to appear legitimate.', 'The [Exaramel for Windows] dropper creates and starts a Windows service named wsmprovav with the description “Windows Check AV” in an apparent attempt to masquerade as a legitimate service.', '[Higaisa] named a shellcode loader binary <code>svchast.exe</code> to spoof the legitimate <code>svchost.exe</code>. ', '[Lazarus Group] has used a scheduled task named `SRCheck` to mask the execution of a malicious .dll.', 'Some [Volgmer] variants add new services with display names generated by a list of hard-coded strings such as Application, Background, Security, and Windows, presumably as a way to masquerade as a legitimate service.', '[Turian] can disguise as a legitimate service to blend into normal operations.', '[InvisiMole] has attempted to disguise itself by registering under a seemingly legitimate service name.', '[GoldMax] has impersonated systems management software to avoid detection.', '[ComRAT] has used a task name associated with Windows SQM Consolidator.', '[Heyoka Backdoor] has been named `srvdll.dll` to appear as a legitimate service.', '[BackdoorDiplomacy] has disguised their backdoor droppers with naming conventions designed to blend into normal operations.', '[APT41] has created services to appear as benign system tools.', '[Black Basta] has established persistence by creating a new service named `FAX` after deleting the legitimate service by the same name.', '[APT29] named tasks <code>\\Microsoft\\Windows\\SoftwareProtectionPlatform\\EventCacheManager</code> in order to appear legitimate.', '[UNC2452] named tasks <code>\\Microsoft\\Windows\\SoftwareProtectionPlatform\\EventCacheManager</code> in order to appear legitimate.', 'A [Lazarus Group] custom backdoor implant included a custom PE loader named ""Security Package"" that was added into the lsass.exe process via registry key. ']"
T1552.003,Bash History,"Adversaries may search the bash command history on compromised systems for insecurely stored credentials. Bash keeps track of the commands users type on the command-line with the ""history"" utility. Once a user logs out, the history is flushed to the user’s <code>.bash_history</code> file. For each user, this file resides at the same location: <code>~/.bash_history</code>. Typically, this file keeps track of the user’s last 500 commands. Users often type usernames and passwords on the command-line as parameters to programs, which then get saved to this file when they log out. Adversaries can abuse this by looking through the file for potential credentials. ",['[Kinsing] has searched <code>bash_history</code> for credentials.']
T1552.001,Credentials In Files,"Adversaries may search local file systems and remote file shares for files containing insecurely stored credentials. These can be files created by users to store their own credentials, shared credential stores for a group of individuals, configuration files containing passwords for a system or service, or source code/binary files containing embedded passwords.  It is possible to extract passwords from backups or saved virtual machines through [OS Credential Dumping]  Passwords may also be obtained from Group Policy Preferences stored on the Windows Domain Controller.   In cloud and/or containerized environments, authenticated user and service account credentials are often stored in local configuration and credential files. They may also be found as parameters to deployment commands in container logs. In some cases, these files can be copied and reused on another machine or the contents can be read and then used to authenticate without needing to copy any files.","['[XTunnel] is capable of accessing locally stored passwords on victims.', '[Pupy] can use Lazagne for harvesting credentials.', '[Emotet] has been observed leveraging a module that retrieves passwords stored on a system for the current logged-on user. ', '[PoshC2] contains modules for searching for passwords in local and remote files.', '[Smoke Loader] searches for files named logins.json to parse for credentials.', '[APT33] has used a variety of publicly available tools like [LaZagne] to gather credentials.', '[Agent Tesla] has the ability to extract credentials from configuration or support files. ', '[LaZagne] can obtain credentials from chats, databases, mail, and WiFi.', '[Empire] can use various modules to search for files containing passwords.', '[Azorult] can steal credentials in files belonging to common software such as Skype, Telegram, and Steam.', '[Pysa] has extracted credentials from the password database before encrypting the files. ', '[Fox Kitten] has accessed files to gain valid credentials.', '[Hildegard] has searched for SSH keys, Docker credentials, and Kubernetes service tokens.', '[TA505] has used malware to gather credentials from FTP clients and Outlook.', '[TrickBot] can obtain passwords stored in files from several applications such as Outlook, Filezilla, OpenSSH, OpenVPN and WinSCP. Additionally, it searches for the "".vnc.lnk"" affix to steal VNC credentials.', '[AADInternals] can gather unsecured credentials for Azure AD services, such as Azure AD Connect, from a local machine.', '[FIN13] has obtained administrative credentials by browsing through local files on a compromised machine.', '[APT3] has a tool that can locate credentials in files on the file system such as those from Firefox or Chrome.', '[Leafminer] used several tools for retrieving login and password information, including LaZagne.', '[QuasarRAT] can obtain passwords from FTP clients.', 'If an initial connectivity check fails, [pngdowner] attempts to extract proxy details and credentials from Windows Protected Storage and from the IE Credentials Store. This allows the adversary to use the proxy credentials for subsequent requests if they enable outbound HTTP access.', '[Kimsuky] has used tools that are capable of obtaining credentials from saved mail.', '[BlackEnergy] has used a plug-in to gather credentials stored in files on the host by various software programs, including The Bat! email client, Outlook, and Windows Credential Store.', '[jRAT] can capture passwords from common chat applications such as MSN Messenger, AOL, Instant Messenger, and and Google Talk.', '[OilRig] has used credential dumping tools such as [LaZagne] to steal credentials to accounts logged into the compromised system and to Outlook Web Access.', '[TeamTNT] has searched for unsecured AWS credentials and Docker API credentials.', '[MuddyWater] has run a tool that steals passwords saved in victim email.', '[Stolen Pencil] has used tools that are capable of obtaining credentials from saved mail.']"
T1134.001,Token Impersonation/Theft,"Adversaries may duplicate then impersonate another user's existing token to escalate privileges and bypass access controls. For example, an adversary can duplicate an existing token using `DuplicateToken` or `DuplicateTokenEx`. The token can then be used with `ImpersonateLoggedOnUser` to allow the calling thread to impersonate a logged on user's security context, or with `SetThreadToken` to assign the impersonated token to a thread.  An adversary may perform [Token Impersonation/Theft] when they have a specific, existing process they want to assign the duplicated token to. For example, this may be useful for when the target user has a non-network logon session on the system.  When an adversary would instead use a duplicated token to create a new process rather than attaching to an existing process, they can additionally [Create Process with Token] using `CreateProcessWithTokenW` or `CreateProcessAsUserW`. [Token Impersonation/Theft] is also distinct from [Make and Impersonate Token] in that it refers to duplicating an existing token, rather than creating a new one.","['[FinFisher] uses token manipulation with NtFilterToken as part of UAC bypass.', '[Emotet] has the ability to duplicate the user’s token.', '[Stuxnet] attempts to impersonate an anonymous token to enumerate bindings in the service control manager.', '[Cobalt Strike] can steal access tokens from exiting processes.', '[Tarrask] leverages token theft to obtain `lsass.exe` security permissions. ', '[SILENTTRINITY] can find a process owned by a specific user and impersonate the associated token.', '[BitPaymer] can use the tokens of users to create processes on infected systems.', '[Shamoon] can impersonate tokens using <code>LogonUser</code>, <code>ImpersonateLoggedOnUser</code>, and <code>ImpersonateNamedPipeClient</code>.', ""[Okrum] can impersonate a logged-on user's security context using a call to the ImpersonateLoggedOnUser API."", '[Aria-body] has the ability to duplicate a token from ntprint.exe.', '[APT28] has used CVE-2015-1701 to access the SYSTEM token and copy it into the current process as part of privilege escalation.', '[REvil] can obtain the token from the user that launched the explorer.exe process to avoid affecting the desktop of the SYSTEM user.', '[Pupy] can obtain a list of SIDs and provide the option for selecting process tokens to impersonate.', '[BADHATCH] can impersonate a `lsass.exe` or `vmtoolsd.exe` token. ', '[Siloscape] impersonates the main thread of <code>CExecSvc.exe</code> by calling <code>NtImpersonateThread</code>.', '[FIN8] has used a malicious framework designed to impersonate the lsass.exe/vmtoolsd.exe token.', '[Cobalt Strike] can steal access tokens from exiting processes.']"
T1134.003,Make and Impersonate Token,"Adversaries may make new tokens and impersonate users to escalate privileges and bypass access controls. For example, if an adversary has a username and password but the user is not logged onto the system the adversary can then create a logon session for the user using the `LogonUser` function. The function will return a copy of the new session's access token and the adversary can use `SetThreadToken` to assign the token to a thread.  This behavior is distinct from [Token Impersonation/Theft] in that this refers to creating a new user token instead of stealing or duplicating an existing one.","['[Mafalda] can create a token for a different user.', '[FIN13] has utilized tools such as Incognito V2 for token manipulation and impersonation.', '[Cobalt Strike] can make tokens from known credentials.', '[Cobalt Strike] can make tokens from known credentials.']"
T1552.006,Group Policy Preferences,"Adversaries may attempt to find unsecured credentials in Group Policy Preferences (GPP). GPP are tools that allow administrators to create domain policies with embedded credentials. These policies allow administrators to set local accounts.  These group policies are stored in SYSVOL on a domain controller. This means that any domain user can view the SYSVOL share and decrypt the password (using the AES key that has been made public).  The following tools and scripts can be used to gather and decrypt the password file from Group Policy Preference XML files:  * Metasploit’s post exploitation module: <code>post/windows/gather/credentials/gpp</code> * Get-GPPPassword * gpprefdecrypt.py  On the SYSVOL share, adversaries may use the following command to enumerate potential GPP XML files: <code>dir /s * .xml</code> ","['[SILENTTRINITY] has a module that can extract cached GPP passwords. ', '[PowerSploit] contains a collection of Exfiltration modules that can harvest credentials from Group Policy Preferences.', '[APT33] has used a variety of publicly available tools like Gpppassword to gather credentials.', '[Wizard Spider] has used PowerShell cmdlets `Get-GPPPassword` and `Find-GPOPassword` to find unsecured credentials in a compromised network group policy.']"
T1562.003,Impair Command History Logging,"Adversaries may impair command history logging to hide commands they run on a compromised system. Various command interpreters keep track of the commands users type in their terminal so that users can retrace what they've done.   On Linux and macOS, command history is tracked in a file pointed to by the environment variable <code>HISTFILE</code>. When a user logs off a system, this information is flushed to a file in the user's home directory called <code>~/.bash_history</code>. The <code>HISTCONTROL</code> environment variable keeps track of what should be saved by the <code>history</code> command and eventually into the <code>~/.bash_history</code> file when a user logs out. <code>HISTCONTROL</code> does not exist by default on macOS, but can be set by the user and will be respected.  Adversaries may clear the history environment variable (<code>unset HISTFILE</code>) or set the command history size to zero (<code>export HISTFILESIZE=0</code>) to prevent logging of commands. Additionally, <code>HISTCONTROL</code> can be configured to ignore commands that start with a space by simply setting it to ""ignorespace"". <code>HISTCONTROL</code> can also be set to ignore duplicate commands by setting it to ""ignoredups"". In some Linux systems, this is set by default to ""ignoreboth"" which covers both of the previous examples. This means that “ ls” will not be saved, but “ls” would be saved by history. Adversaries can abuse this to operate without leaving traces by simply prepending a space to all of their terminal commands.   On Windows systems, the <code>PSReadLine</code> module tracks commands used in all PowerShell sessions and writes them to a file (<code>$env:APPDATA\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code> by default). Adversaries may change where these logs are saved using <code>Set-PSReadLineOption -HistorySavePath {File Path}</code>. This will cause <code>ConsoleHost_history.txt</code> to stop receiving logs. Additionally, it is possible to turn off logging to this file using the PowerShell command <code>Set-PSReadlineOption -HistorySaveStyle SaveNothing</code>.  Adversaries may also leverage a [Network Device CLI] on network devices to disable historical command logging (e.g. <code>no logging</code>).","['[APT38] has prepended a space to all of their terminal commands to operate without leaving traces in the HISTCONTROL environment.', '[SILENTTRINITY] can bypass ScriptBlock logging to execute unmanaged PowerShell code from memory.']"
T1546.001,Change Default File Association,"Adversaries may establish persistence by executing malicious content triggered by a file type association. When a file is opened, the default program used to open the file (also called the file association or handler) is checked. File association selections are stored in the Windows Registry and can be edited by users, administrators, or programs that have Registry access or by administrators using the built-in assoc utility. Applications can modify the file association for a given file extension to call an arbitrary program when a file with the given extension is opened.  System file associations are listed under <code>HKEY_CLASSES_ROOT\.[extension]</code>, for example <code>HKEY_CLASSES_ROOT\.txt</code>. The entries point to a handler for that extension located at <code>HKEY_CLASSES_ROOT\\[handler]</code>. The various commands are then listed as subkeys underneath the shell key at <code>HKEY_CLASSES_ROOT\\[handler]\shell\\[action]\command</code>. For example:   * <code>HKEY_CLASSES_ROOT\txtfile\shell\open\command</code> * <code>HKEY_CLASSES_ROOT\txtfile\shell\print\command</code> * <code>HKEY_CLASSES_ROOT\txtfile\shell\printto\command</code>  The values of the keys listed are commands that are executed when the handler opens the file extension. Adversaries can modify these values to continually execute arbitrary commands.","['[SILENTTRINITY] can conduct an image hijack of an `.msc` file extension as part of its UAC bypass process.', '[Kimsuky] has a HWP document stealer module which changes the default program association in the registry to open HWP documents.']"
T1574.010,Services File Permissions Weakness,"Adversaries may execute their own malicious payloads by hijacking the binaries used by services. Adversaries may use flaws in the permissions of Windows services to replace the binary that is executed upon service start. These service processes may automatically execute specific binaries as part of their functionality or to perform other actions. If the permissions on the file system directory containing a target binary, or permissions on the binary itself are improperly set, then the target binary may be overwritten with another binary using user-level permissions and executed by the original process. If the original process and thread are running under a higher permissions level, then the replaced binary will also execute under higher-level permissions, which could include SYSTEM.  Adversaries may use this technique to replace legitimate binaries with malicious ones as a means of executing code at a higher permissions level. If the executing process is set to run at a specific time or during a certain event (e.g., system bootup) then this technique can also be used for persistence.","[""One variant of [BlackEnergy] locates existing driver services that have been disabled and drops its driver component into one of those service's paths, replacing the legitimate executable. The malware then sets the hijacked service to start automatically to establish persistence.""]"
T1547.006,Kernel Modules and Extensions,"Adversaries may modify the kernel to automatically execute programs on system boot. Loadable Kernel Modules (LKMs) are pieces of code that can be loaded and unloaded into the kernel upon demand. They extend the functionality of the kernel without the need to reboot the system. For example, one type of module is the device driver, which allows the kernel to access hardware connected to the system.   When used maliciously, LKMs can be a type of kernel-mode [Rootkit] that run with the highest operating system privilege (Ring 0). Common features of LKM based rootkits include: hiding itself, selective hiding of files, processes and network activity, as well as log tampering, providing authenticated backdoors, and enabling root access to non-privileged users.  Kernel extensions, also called kext, are used in macOS to load functionality onto a system similar to LKMs for Linux. Since the kernel is responsible for enforcing security and the kernel extensions run as apart of the kernel, kexts are not governed by macOS security policies. Kexts are loaded and unloaded through <code>kextload</code> and <code>kextunload</code> commands. Kexts need to be signed with a developer ID that is granted privileges by Apple allowing it to sign Kernel extensions. Developers without these privileges may still sign kexts but they will not load unless SIP is disabled. If SIP is enabled, the kext signature is verified before being added to the AuxKC.  Since macOS Catalina 10.15, kernel extensions have been deprecated in favor of System Extensions. However, kexts are still allowed as ""Legacy System Extensions"" since there is no System Extension for Kernel Programming Interfaces.  Adversaries can use LKMs and kexts to conduct [Persistence] and/or [Privilege Escalation] on a system. Examples have been found in the wild, and there are some relevant open source projects as well.","['[Drovorub] can use kernel modules to establish persistence.', '[Skidmap] has the ability to install several loadable kernel modules (LKMs) on infected machines.', 'During [Operation CuckooBees] attackers used a signed kernel rootkit to establish additional persistence.']"
T1218.001,Compiled HTML File,"Adversaries may abuse Compiled HTML files (.chm) to conceal malicious code. CHM files are commonly distributed as part of the Microsoft HTML Help system. CHM files are compressed compilations of various content such as HTML documents, images, and scripting/web related programming languages such VBA, JScript, Java, and ActiveX.  CHM content is displayed using underlying components of the Internet Explorer browser  loaded by the HTML Help executable program (hh.exe).   A custom CHM file containing embedded payloads could be delivered to a victim then triggered by [User Execution] CHM execution may also bypass application application control on older and/or unpatched systems that do not account for execution of binaries through hh.exe.  ","['[OilRig] has used a CHM payload to load and execute another malicious file once delivered to a victim.', '[Dark Caracal] leveraged a compiled HTML file that contained a command to download and run an executable.', '[Silence] has weaponized CHM files in their phishing campaigns.', '[APT41] used compiled HTML (.chm) files for targeting. ', '[APT38] has used CHM files to move concealed payloads.', '[Astaroth] uses ActiveX objects for file execution and manipulation. ', '[Lazarus Group] has used CHM files to move concealed payloads.']"
T1562.001,Disable or Modify Tools,"Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities. This may take many forms, such as killing security software processes or services, modifying / deleting Registry keys or configuration files so that tools do not operate properly, or other methods to interfere with security tools scanning or reporting information. Adversaries may also disable updates to prevent the latest security patches from reaching tools on victim systems.  Adversaries may also tamper with artifacts deployed and utilized by security tools. Security tools may make dynamic changes to system components in order to maintain visibility into specific events. For example, security products may load their own modules and/or modify those loaded by processes to facilitate data collection. Similar to [Indicator Blocking] adversaries may unhook or otherwise modify these features added by tools (especially those that exist in userland or are otherwise potentially accessible to adversaries) to avoid detection.   Adversaries may also focus on specific applications such as Sysmon. For example, the “Start” and “Enable” values in <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Microsoft-Windows-Sysmon-Operational</code> may be modified to tamper with and potentially disable Sysmon logging.   On network devices, adversaries may attempt to skip digital signature verification checks by altering startup configuration files and effectively disabling firmware verification that typically occurs at boot.  In cloud environments, tools disabled by adversaries may include cloud monitoring agents that report back to services such as AWS CloudWatch or Google Cloud Monitor.  Furthermore, although defensive tools may have anti-tampering mechanisms, adversaries may abuse tools such as legitimate rootkit removal kits to impair and/or disable these tools. For example, adversaries have used tools such as GMER to find and shut down hidden processes and antivirus software on infected systems.  Additionally, adversaries may exploit legitimate drivers from anti-virus software to gain access to kernel space (i.e. [Exploitation for Privilege Escalation] which may lead to bypassing anti-tampering features.","['[RunningRAT] kills antimalware running process.', '[SUNBURST] attempted to disable software security services following checks against a FNV-1a + XOR hashed hardcoded blocklist.', '[Diavol] can attempt to stop security software.', '[TA2541]  has attempted to disable built-in security protections such as Windows AMSI. ', '[H1N1] kills and disables services for Windows Security Center, and Windows Defender.', '[Turla] has used a AMSI bypass, which patches the in-memory amsi.dll, in PowerShell scripts to bypass Windows antimalware products.', '[Ryuk] has stopped services related to anti-virus.', '[Netwalker] can detect and terminate active security software-related processes on infected systems.', '[SILENTTRINITY] `amsiPatch.py` module can disable Antimalware Scan Interface (AMSI) functions.', ""[REvil] can connect to and disable the Symantec server on the victim's network."", '[Cobalt Strike] has the ability to use Smart Applet attacks to disable the Java SecurityManager sandbox.', '[POWERSTATS] can disable Microsoft Office Protected View by changing Registry keys.', '[LockerGoga] installation has been immediately preceded by a ""task kill"" command in order to disable anti-virus.', ""[ChChes] can alter the victim's proxy configuration."", '[Avaddon] looks for and attempts to stop anti-malware solutions.', '[Ebury] can disable SELinux Role-Based Access Control and deactivate PAM modules.', '[WhisperGate] can download and execute AdvancedRun.exe to disable the Windows Defender Theat Protection service and set an exclusion path for the C:\\ drive.', ""[MuddyWater] can disable the system's local proxy settings."", '[Clop] can uninstall or disable security products.', '[NanHaiShu] can change Internet Explorer settings to reduce warnings about malware activity.', '[Carberp] has attempted to disable security software by creating a suspended process for the security software and injecting code to delete antivirus core files when the process is resumed.', '[WarzoneRAT] can disarm Windows Defender during the UAC process to evade detection.', 'During the [SolarWinds Compromise] [APT29] used the service control manager on a remote system to disable services associated with security monitoring products.', '[JPIN] can lower security settings by changing Registry keys.', '[Indrik Spider] used [PsExec] to leverage Windows Defender to disable scanning of all downloaded files and to restrict real-time monitoring.', '[Ember Bear] has executed a batch script designed to disable Windows Defender on a compromised host.', '[MegaCortex] was used to kill endpoint security processes.', '[Bazar] has manually loaded ntdll from disk in order to identity and remove API hooks set by security products.\t', '[Pysa] has the capability to stop antivirus services and disable Windows Defender. ', '[StrongPity] can add directories used by the malware to the Windows Defender exclusions list to prevent detection.', '[TeamTNT] has disabled and uninstalled security tools such as Alibaba, Tencent, and BMC cloud monitoring agents on cloud-based infrastructure.', '[FIN6] has deployed a utility script named <code>kill.bat</code> to disable anti-virus.', '[HDoor] kills anti-virus found on the victim.', '[TA505] has used malware to disable Windows Defender.', '[Gamaredon Group] has delivered macros which can tamper with Microsoft Office security settings.\t', '[Hildegard] has modified DNS resolvers to evade DNS monitoring tools.', '[Grandoreiro] can hook APIs, kill processes, break file system paths, and change ACLs to prevent security tools from running.', '[APT29] has disabled Purview Audit on targeted accounts prior to stealing emails from  Microsoft 365 tenants.', '[KOCTOPUS] will attempt to delete or disable all Registry keys and scheduled tasks related to Microsoft Security Defender and Security Essentials.', '[Meteor] can attempt to uninstall Kaspersky Antivirus or remove the Kaspersky license; it can also add all files and folders related to the attack to the Windows Defender exclusion list.', ""[Goopy] has the ability to disable Microsoft Outlook's security policies to disable macro warnings.\t"", '[ThiefQuest] uses the function <code>kill_unwanted</code> to obtain a list of running processes and kills each process matching a list of security related processes.', '[TrickBot] can disable Windows Defender.', '[BRONZE BUTLER] has incorporated code into several tools that attempts to terminate anti-virus processes.', '[RobbinHood] will search for Windows services that are associated with antivirus software on the system and kill the process. ', '[Gorgon Group] malware can attempt to disable security features in Microsoft Office and Windows Defender using the <code>taskkill</code> command.', 'Malware used by [Putter Panda] attempts to terminate processes corresponding to two components of Sophos Anti-Virus (SAVAdminService.exe and SavService.exe).', '[Magic Hound] has disabled antivirus services on targeted systems in order to upload malicious payloads.', '[Aquatic Panda] has attempted to stop endpoint detection and response (EDR) tools on compromised systems.', '[Babuk] can stop anti-virus services on a compromised host.', '[Metamorfo] has a function to kill processes associated with defenses and can prevent certain processes from launching. ', '[Gold Dragon] terminates anti-malware processes if they’re found running on the system.', '[EKANS] stops processes related to security and management software.', '[Lazarus Group] malware TangoDelta attempts to terminate various processes associated with McAfee. Additionally, [Lazarus Group] malware SHARPKNOT disables the Microsoft Windows System Event Notification and Alerter services.. ', '[Egregor] has disabled Windows Defender to evade protections.', '[SslMM] identifies and kills anti-malware processes.', '[Agent Tesla] has the capability to kill any running analysis processes and AV software.', '[TinyZBot] can disable Avira anti-virus.', '[DarkComet] can disable Security Center functions like anti-virus.', ""[ZxShell] can kill AV products' processes. "", ""[NanoCore] can modify the victim's anti-virus."", '[Kimsuky] has been observed turning off Windows Security Center and can hide the AV software window from the view of the infected user.', '[Conficker] terminates various services related to system security and Windows.', '[Rocke] used scripts which detected and uninstalled antivirus software.', '[Ragnar Locker] has attempted to terminate/stop processes and services associated with endpoint security products.', '[Donut] can patch Antimalware Scan Interface (AMSI), Windows Lockdown Policy (WLDP), as well as exit-related [Native API] functions to avoid process termination.\t', '[Wizard Spider] has shut down or uninstalled security applications on victim systems that might prevent ransomware from executing.', ""[Maze] has disabled dynamic analysis and other security tools including IDA debugger, x32dbg, and OllyDbg. It has also disabled Windows Defender's Real-Time Monitoring feature and attempted to disable endpoint protection services."", ""[macOS.OSAMiner] has searched for the Activity Monitor process in the System Events process list and kills the process if running. [macOS.OSAMiner] also searches the operating system's `install.log` for apps matching its hardcoded list, killing all matching process names."", '[Proton] kills security tools like Wireshark that are running.', '[Skidmap] has the ability to set SELinux to permissive mode.', 'During the [2015 Ukraine Electric Power Attack] [Sandworm Team] modified in-registry internet settings to lower internet security. ', '[Brave Prince] terminates antimalware processes.', '[QakBot] has the ability to modify the Registry to add its binaries to the Windows Defender exclusion list.', 'During [Night Dragon] threat actors disabled anti-virus and anti-spyware tools in some instances on the victim’s machines. The actors also disabled proxy settings to allow direct communication from victims to the Internet.', '[Unknown Logger] has functionality to disable security tools, including Kaspersky, BitDefender, and MalwareBytes.', '[Bundlore] can change browser security settings to enable extensions to be installed. [Bundlore] uses the <code>pkill cfprefsd</code> command to prevent users from inspecting processes.', '[Imminent Monitor] has a feature to disable Windows Task Manager.\t', '[APT29] used the service control manager on a remote system to disable services associated with security monitoring products.', '[UNC2452] used the service control manager on a remote system to disable services associated with security monitoring products.', '[Night Dragon] has disabled anti-virus and anti-spyware tools in some instances on the victim’s machines. The actors have also disabled proxy settings to allow direct communication from victims to the Internet.', '[OSX/Shlayer] can disable Gatekeeper using the native <code>spctl</code> application.']"
T1564.009,Resource Forking,"Adversaries may abuse resource forks to hide malicious code or executables to evade detection and bypass security applications. A resource fork provides applications a structured way to store resources such as thumbnail images, menu definitions, icons, dialog boxes, and code. Usage of a resource fork is identifiable when displaying a file’s extended attributes, using <code>ls -l@</code> or <code>xattr -l</code> commands. Resource forks have been deprecated and replaced with the application bundle structure. Non-localized resources are placed at the top level directory of an application bundle, while localized resources are placed in the <code>/Resources</code> folder.  Adversaries can use resource forks to hide malicious data that may otherwise be stored directly in files. Adversaries can execute content with an attached resource fork, at a specified offset, that is moved to an executable location then invoked. Resource fork content may also be obfuscated/encrypted until execution.","[""[Keydnap] uses a resource fork to present a macOS JPEG or text file icon rather than the executable's icon assigned by the operating system."", '[OSX/Shlayer] has used a resource fork to hide a compressed binary file of itself from the terminal, Finder, and potentially evade traditional scanners.']"
T1110.004,Credential Stuffing,"Adversaries may use credentials obtained from breach dumps of unrelated accounts to gain access to target accounts through credential overlap. Occasionally, large numbers of username and password pairs are dumped online when a website or service is compromised and the user account credentials accessed. The information may be useful to an adversary attempting to compromise accounts by taking advantage of the tendency for users to use the same passwords across personal and business accounts.  Credential stuffing is a risky option because it could cause numerous authentication failures and account lockouts, depending on the organization's login failure policies.  Typically, management services over commonly used ports are used when stuffing credentials. Commonly targeted services include the following:  * SSH (22/TCP) * Telnet (23/TCP) * FTP (21/TCP) * NetBIOS / SMB / Samba (139/TCP & 445/TCP) * LDAP (389/TCP) * Kerberos (88/TCP) * RDP / Terminal Services (3389/TCP) * HTTP/HTTP Management Services (80/TCP & 443/TCP) * MSSQL (1433/TCP) * Oracle (1521/TCP) * MySQL (3306/TCP) * VNC (5900/TCP)  In addition to management services, adversaries may ""target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,"" as well as externally facing email applications, such as Office 365.","[""[Chimera] has used credential stuffing against victim's remote services to obtain valid accounts."", '[TrickBot] uses brute-force attack against RDP with rdpscanDll module.']"
T1556.006,Multi-Factor Authentication,"Adversaries may disable or modify multi-factor authentication (MFA) mechanisms to enable persistent access to compromised accounts.  Once adversaries have gained access to a network by either compromising an account lacking MFA or by employing an MFA bypass method such as [Multi-Factor Authentication Request Generation] adversaries may leverage their access to modify or completely disable MFA defenses. This can be accomplished by abusing legitimate features, such as excluding users from Azure AD Conditional Access Policies, registering a new yet vulnerable/adversary-controlled MFA method, or by manually patching MFA programs and configuration files to bypass expected functionality.  For example, modifying the Windows hosts file (`C:\windows\system32\drivers\etc\hosts`) to redirect MFA calls to localhost instead of an MFA server may cause the MFA process to fail. If a ""fail open"" policy is in place, any otherwise successful authentication attempt may be granted access without enforcing MFA.    Depending on the scope, goals, and privileges of the adversary, MFA defenses may be disabled for individual accounts or for all accounts tied to a larger group, such as all domain accounts in a victim's network environment. ",['The [AADInternals] `Set-AADIntUserMFA` command can be used to disable MFA for a specified user.']
T1114.002,Remote Email Collection,"Adversaries may target an Exchange server, Office 365, or Google Workspace to collect sensitive information. Adversaries may leverage a user's credentials and interact directly with the Exchange server to acquire information from within a network. Adversaries may also access externally facing Exchange services, Office 365, or Google Workspace to access email using credentials or access tokens. Tools such as [MailSniper] can be used to automate searches for specific keywords.","['[Ke3chang] has used compromised credentials and a .NET tool to dump data from Microsoft Exchange mailboxes.', '[MailSniper] can be used for searching through email in Exchange and Office 365 environments.', 'During the [SolarWinds Compromise] [APT29] collected emails from specific individuals, such as executives and IT staff, using `New-MailboxExportRequest` followed by `Get-MailboxExportRequest`.', '[APT28] has collected emails from victim Microsoft Exchange servers.', '[APT1] uses two utilities, GETMAIL and MAPIGET, to steal email. MAPIGET steals email still on Exchange servers that has not yet been archived.', '[LightNeuron] collects Exchange emails matching rules specified in its configuration.', '[APT29] has collected emails from targeted mailboxes within a compromised Azure AD tenant and compromised Exchange servers, including via Exchange Web Services (EWS) API requests.', 'Some [SeaDuke] samples have a module to extract email from Microsoft Exchange servers using compromised credentials.', '[HAFNIUM] has used web shells to export mailbox data.', '[Valak] can collect sensitive mailing information from Exchange servers, including credentials and the domain certificate of an enterprise.', '[Magic Hound] has exported emails from compromised Exchange servers including through use of the cmdlet `New-MailboxExportRequest.`', '[Chimera] has harvested data from remote mailboxes including through execution of <code>\\\\<hostname>\\c$\\Users\\<username>\\AppData\\Local\\Microsoft\\Outlook*.ost</code>.', '[Dragonfly] has accessed email accounts using Outlook Web Access.', '[FIN4] has accessed and hijacked online email communications using stolen credentials.', '[Leafminer] used a tool called MailSniper to search through the Exchange server mailboxes for keywords.', '[Kimsuky] has used tools such as the MailFetch mail crawler to collect victim emails (excluding spam) from online services via IMAP.', '[APT29] collected emails from specific individuals, such as executives and IT staff, using <code>New-MailboxExportRequest</code> followed by <code>Get-MailboxExportRequest</code>.', '[UNC2452] collected emails from specific individuals, such as executives and IT staff, using <code>New-MailboxExportRequest</code> followed by <code>Get-MailboxExportRequest</code>.', '[Dragonfly 2.0] accessed email accounts using Outlook Web Access.']"
T1036.001,Invalid Code Signature,"Adversaries may attempt to mimic features of valid code signatures to increase the chance of deceiving a user, analyst, or tool. Code signing provides a level of authenticity on a binary from the developer and a guarantee that the binary has not been tampered with. Adversaries can copy the metadata and signature information from a signed program, then use it as a template for an unsigned program. Files with invalid code signatures will fail digital signature validation checks, but they may appear more legitimate to users and security tools may improperly handle these files.  Unlike [Code Signing] this activity will not result in a valid signature.","['[WindTail] has been incompletely signed with revoked certificates.', '[BADNEWS] is sometimes signed with an invalid Authenticode certificate in an apparent effort to make it look more legitimate.', '[Regin] stage 1 modules for 64-bit systems have been found to be signed with fake certificates masquerading as originating from Microsoft Corporation and Broadcom Corporation.', '[APT37] has signed its malware with an invalid digital certificates listed as “Tencent Technology (Shenzhen) Company Limited.”', '[Windshift] has used revoked certificates to sign malware.', 'The [NETWIRE] client has been signed by fake and invalid digital certificates.', '[PcShare] has used an invalid certificate in attempt to appear legitimate.', '[Gelsemium] has used unverified signatures on malicious DLLs.']"
T1546.004,Unix Shell Configuration Modification,"Adversaries may establish persistence through executing malicious commands triggered by a user’s shell. User [Unix Shell] execute several configuration scripts at different points throughout the session based on events. For example, when a user opens a command-line interface or remotely logs in (such as via SSH) a login shell is initiated. The login shell executes scripts from the system (<code>/etc</code>) and the user’s home directory (<code>~/</code>) to configure the environment. All login shells on a system use /etc/profile when initiated. These configuration scripts run at the permission level of their directory and are often used to set environment variables, create aliases, and customize the user’s environment. When the shell exits or terminates, additional shell scripts are executed to ensure the shell exits appropriately.   Adversaries may attempt to establish persistence by inserting commands into scripts automatically executed by shells. Using bash as an example, the default shell for most GNU/Linux systems, adversaries may add commands that launch malicious binaries into the <code>/etc/profile</code> and <code>/etc/profile.d</code> files. These files typically require root permissions to modify and are executed each time any shell on a system launches. For user level permissions, adversaries can insert malicious commands into <code>~/.bash_profile</code>, <code>~/.bash_login</code>, or <code>~/.profile</code> which are sourced when a user opens a command-line interface or connects remotely. Since the system only executes the first existing file in the listed order, adversaries have used <code>~/.bash_profile</code> to ensure execution. Adversaries have also leveraged the <code>~/.bashrc</code> file which is additionally executed if the connection is established remotely or an additional interactive shell is opened, such as a new tab in the command-line interface. Some malware targets the termination of a program to trigger execution, adversaries can use the <code>~/.bash_logout</code> file to execute malicious commands at the end of a session.   For macOS, the functionality of this technique is similar but may leverage zsh, the default shell for macOS 10.15+. When the Terminal.app is opened, the application launches a zsh login shell and a zsh interactive shell. The login shell configures the system environment using <code>/etc/profile</code>, <code>/etc/zshenv</code>, <code>/etc/zprofile</code>, and <code>/etc/zlogin</code>. The login shell then configures the user environment with <code>~/.zprofile</code> and <code>~/.zlogin</code>. The interactive shell uses the <code>~/.zshrc</code> to configure the user environment. Upon exiting, <code>/etc/zlogout</code> and <code>~/.zlogout</code> are executed. For legacy programs, macOS executes <code>/etc/bashrc</code> on startup.","['When executing with non-root level permissions, [RotaJakiro] can install persistence by adding a command to the .bashrc file that executes a binary in the  `${HOME}/.gvfsd/.profile/` folder.', '[Linux Rabbit] maintains persistence on an infected machine through rc.local and .bashrc files. ', '[Green Lambert] can establish persistence on a compromised host through modifying the `profile`, `login`, and run command (rc) files associated with the `bash`, `csh`, and `tcsh` shells.  ']"
T1548.004,Elevated Execution with Prompt,"Adversaries may leverage the <code>AuthorizationExecuteWithPrivileges</code> API to escalate privileges by prompting the user for credentials. The purpose of this API is to give application developers an easy way to perform operations with root privileges, such as for application installation or updating. This API does not validate that the program requesting root privileges comes from a reputable source or has been maliciously modified.   Although this API is deprecated, it still fully functions in the latest releases of macOS. When calling this API, the user will be prompted to enter their credentials but no checks on the origin or integrity of the program are made. The program calling the API may also load world writable files which can be modified to perform malicious behavior with elevated privileges.  Adversaries may abuse <code>AuthorizationExecuteWithPrivileges</code> to obtain root privileges in order to install malicious software on victims and install persistence mechanisms. This technique may be combined with [Masquerading] to trick the user into granting escalated privileges to malicious code. This technique has also been shown to work by modifying legitimate programs present on the machine that make use of this API.",['[OSX/Shlayer] can escalate privileges to root by asking the user for credentials.']
T1592.002,Software,"Adversaries may gather information about the victim's host software that can be used during targeting. Information about installed software may include a variety of details such as types and versions on specific hosts, as well as the presence of additional components that might be indicative of added defensive protections (ex: antivirus, SIEMs, etc.).  Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning] (ex: listening ports, server banners, user agent strings) or [Phishing for Information] Adversaries may also compromise sites then include malicious content designed to collect host information from visitors. Information about the installed software may also be exposed to adversaries via online or other accessible data sets (ex: job postings, network maps, assessment reports, resumes, or purchase invoices). Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains] or [Search Open Technical Databases] establishing operational resources (ex: [Develop Capabilities] or [Obtain Capabilities] and/or for initial access (ex: [Supply Chain Compromise] or [External Remote Services]","['[Magic Hound] has captured the user-agent strings from visitors to their phishing sites.', '[Sandworm Team] has researched software code to enable supply-chain operations, most notably for the 2017 [NotPetya] attack. [Sandworm Team] also collected a list of computers using specific software as part of its targeting efforts.', '[Andariel] has inserted a malicious script within compromised websites to collect potential victim information such as browser type, system language, Flash Player version, and other data.']"
T1195.002,Compromise Software Supply Chain,"Adversaries may manipulate application software prior to receipt by a final consumer for the purpose of data or system compromise. Supply chain compromise of software can take place in a number of ways, including manipulation of the application source code, manipulation of the update/distribution mechanism for that software, or replacing compiled releases with a modified version.  Targeting may be specific to a desired victim set or may be distributed to a broad set of consumers but only move on to additional tactics on specific victims.  ","['[APT41] gained access to production environments where they could inject malicious code into legitimate, signed files and widely distribute them to end users.', '[Cobalt Group] has compromised legitimate web browser updates to deliver a backdoor. ', '[GOLD SOUTHFIELD] has distributed ransomware by backdooring software installers via a strategic web compromise of the site hosting Italian WinRAR.', '[GoldenSpy] has been packaged with a legitimate tax preparation software.', '[SUNSPOT] malware was designed and used to insert [SUNBURST] into software builds of the SolarWinds Orion IT management product.', '[Sandworm Team] has distributed [NotPetya] by compromising the legitimate Ukrainian accounting software M.E.Doc and replacing a legitimate software update with a malicious one.', ""[CCBkdr] was added to a legitimate, signed version 5.33 of the CCleaner software and distributed on CCleaner's distribution site."", '[Dragonfly] has placed trojanized installers for control system software on legitimate vendor app stores.', ""[Threat Group-3390] has compromised the Able Desktop installer to gain access to victim's environments."", 'During the [SolarWinds Compromise] [APT29] gained initial network access to some victims via a trojanized update of SolarWinds Orion software.', ""[FIN7] has gained initial access by compromising a victim's software supply chain."", '[UNC2452] gained initial network access via a trojanized update of SolarWinds Orion software.', '[APT29] gained initial network access to some victims via a trojanized update of SolarWinds Orion software.', '[Gelsemium] has compromised software supply chains to gain access to victims.']"
T1036.003,Rename System Utilities,Adversaries may rename legitimate system utilities to try to evade security mechanisms concerning the usage of those utilities. Security monitoring and control mechanisms may be in place for system utilities adversaries are capable of abusing.  It may be possible to bypass those security mechanisms by renaming the utility prior to utilization (ex: rename <code>rundll32.exe</code>).  An alternative case occurs when a legitimate utility is copied or moved to a different directory and renamed to avoid detections based on system utilities executing from non-standard paths. ,"['[menuPass] has renamed [certutil] and moved it to a different location on the system to avoid detection based on use of the tool.', '[Lazarus Group] has renamed system utilities such as <code>wscript.exe</code> and <code>mshta.exe</code>.', '[APT32] has moved and renamed pubprn.vbs to a .txt file to avoid detection.', ""The [CozyCar] dropper has masqueraded a copy of the infected system's rundll32.exe executable that was moved to the malware's install directory and renamed according to a predefined configuration file."", '[Kevin] has renamed an image of `cmd.exe` with a random name followed by a `.tmpl` extension.', '[GALLIUM] used a renamed cmd.exe file to evade detection.']"
T1574.009,Path Interception by Unquoted Path,"Adversaries may execute their own malicious payloads by hijacking vulnerable file path references. Adversaries can take advantage of paths that lack surrounding quotations by placing an executable in a higher level directory within the path, so that Windows will choose the adversary's executable to launch.  Service paths  and shortcut paths may also be vulnerable to path interception if the path has one or more spaces and is not surrounded by quotation marks (e.g., <code>C:\unsafe path with space\program.exe</code> vs. <code>""C:\safe path with space\program.exe""</code>).  (stored in Windows Registry keys) An adversary can place an executable in a higher level directory of the path, and Windows will resolve that executable instead of the intended executable. For example, if the path in a shortcut is <code>C:\program files\myapp.exe</code>, an adversary may create a program at <code>C:\program.exe</code> that will be run instead of the intended program.    This technique can be used for persistence if executables are called on a regular basis, as well as privilege escalation if intercepted executables are started by a higher privileged process.","['[PowerSploit] contains a collection of Privesc-PowerUp modules that can discover and exploit unquoted path vulnerabilities.', '[Empire] contains modules that can discover and exploit unquoted path vulnerabilities.']"
T1027.003,Steganography,"Adversaries may use steganography techniques in order to prevent the detection of hidden information. Steganographic techniques can be used to hide data in digital media such as images, audio tracks, video clips, or text files.  [Duqu] was an early example of malware that used steganography. It encrypted the gathered information from a victim's system and hid it within an image before exfiltrating the image to a C2 server.   By the end of 2017, a threat group used <code>Invoke-PSImage</code> to hide [PowerShell] commands in an image file (.png) and execute the code on a victim's system. In this particular case the [PowerShell] code downloaded another obfuscated script to gather intelligence from the victim's machine and communicate it back to the adversary.  ","['[Earth Lusca] has used steganography to hide shellcode in a BMP image file.', '[RDAT] can also embed data within a BMP image prior to exfiltration.\t', '[PowerDuke] uses steganography to hide backdoors in PNG files, which are also encrypted using the Tiny Encryption Algorithm (TEA). ', ""For [Operation Spalax] the threat actors used packers that read pixel data from images contained in PE files' resource sections and build the next layer of execution from the data."", '[APT37] uses steganography to send images to users that are embedded with shellcode.', '[LiteDuke] has used image files to hide its loader component.', '[BBK] can extract a malicious Portable Executable (PE) from a photo.', '[RegDuke] can hide data in images, including use of the Least Significant Bit (LSB).', '[build_downer] can extract malware from a downloaded JPEG.', '[Okrum] payload is encrypted and embedded within its loader, or within a legitimate PNG file.', '[Bandook] has used .PNG images within a zip file to build the executable. ', '[TA551] has hidden encoded data for malware DLLs in a PNG.', '[Diavol] has obfuscated its main code routines within bitmap images as part of its anti-analysis techniques. ', '[Leviathan] has used steganography to hide stolen data inside other files stored on Github.', '[Ramsay] has PE data embedded within JPEG files contained within Word documents.', '[ObliqueRAT] can hide its payload in BMP images hosted on compromised websites.', '[IcedID] has embedded binaries within RC4 encrypted .png files.', '[ABK] can extract a malicious Portable Executable (PE) from a photo.', '[ProLock] can use .jpg and .bmp files to store its payload.', '[MuddyWater] has stored obfuscated JavaScript code in an image file named temp.jpg.', '[Invoke-PSImage] can be used to embed a PowerShell script within the pixels of a PNG file.', 'During [Operation Ghost] [APT29] used steganography to hide payloads inside valid images.', '[Raindrop] used steganography to locate the start of its encoded payload within legitimate 7-Zip code.', '[Avenger] can extract backdoor malware from downloaded images.', '[Andariel] has hidden malicious executables within PNG files.', '[Tropic Trooper] has used JPG files with encrypted payloads to mask their backdoor routines and evade detection.', '[PolyglotDuke] can use steganography to hide C2 information in images.', '[BRONZE BUTLER] has used steganography in multiple operations to conceal malicious payloads.']"
T1584.002,DNS Server,"Adversaries may compromise third-party DNS servers that can be used during targeting. During post-compromise activity, adversaries may utilize DNS traffic for various tasks, including for Command and Control (ex: [Application Layer Protocol] Instead of setting up their own DNS servers, adversaries may compromise third-party DNS servers in support of operations.  By compromising DNS servers, adversaries can alter DNS records. Such control can allow for redirection of an organization's traffic, facilitating Collection and Credential Access efforts for the adversary.  Additionally, adversaries may leverage such control in conjunction with [Digital Certificates] to redirect traffic to adversary-controlled infrastructure, mimicking normal trusted network communications. Adversaries may also be able to silently create subdomains pointed at malicious servers without tipping off the actual owner of the DNS server.","[""[LAPSUS$] has reconfigured a victim's DNS records to actor-controlled domains and websites.""]"
T1550.004,Web Session Cookie,"Adversaries can use stolen session cookies to authenticate to web applications and services. This technique bypasses some multi-factor authentication protocols since the session is already authenticated.  Authentication cookies are commonly used in web applications, including cloud-based services, after a user has authenticated to the service so credentials are not passed and re-authentication does not need to occur as frequently. Cookies are often valid for an extended period of time, even if the web application is not actively used. After the cookie is obtained through [Steal Web Session Cookie] or [Web Cookies] the adversary may then import the cookie into a browser they control and is then able to use the site or application as the user for as long as the session cookie is active. Once logged into the site, an adversary can access sensitive information, read email, or perform actions that the victim account has permissions to perform.  There have been examples of malware targeting session cookies to bypass multi-factor authentication systems.","['During the [SolarWinds Compromise] [APT29] used stolen cookies to access cloud resources and a forged `duo-sid` cookie to bypass MFA set on an email account.', '[APT29] used stolen cookies to access cloud resources, and a forged <code>duo-sid</code> cookie to bypass MFA set on an email account.', '[UNC2452] used a forged <code>duo-sid</code> cookie to bypass MFA set on an email account.']"
T1553.004,Install Root Certificate,"Adversaries may install a root certificate on a compromised system to avoid warnings when connecting to adversary controlled web servers. Root certificates are used in public key cryptography to identify a root certificate authority (CA). When a root certificate is installed, the system or application will trust certificates in the root's chain of trust that have been signed by the root certificate. Certificates are commonly used for establishing secure TLS/SSL communications within a web browser. When a user attempts to browse a website that presents a certificate that is not trusted an error message will be displayed to warn the user of the security risk. Depending on the security settings, the browser may not allow the user to establish a connection to the website.  Installation of a root certificate on a compromised system would give an adversary a way to degrade the security of that system. Adversaries have used this technique to avoid security warnings prompting users when compromised systems connect over HTTPS to adversary controlled web servers that spoof legitimate websites in order to collect login credentials.  Atypical root certificates have also been pre-installed on systems by the manufacturer or in the software supply chain and were used in conjunction with malware/adware to provide [Adversary-in-the-Middle] capability for intercepting information transmitted over secure TLS/SSL communications.  Root certificates (and their associated chains) can also be cloned and reinstalled. Cloned certificate chains will carry many of the same metadata characteristics of the source and can be used to sign malicious code that may then bypass signature validation tools (ex: Sysinternals, antivirus, etc.) used to block execution and/or uncover artifacts of Persistence.  In macOS, the Ay MaMi malware uses <code>/usr/bin/security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain /path/to/malicious/cert</code> to install a malicious certificate as a trusted root certificate into the system keychain.","['[certutil] can be used to install browser root certificates as a precursor to performing [Adversary-in-the-Middle] between connections to banking websites. Example command: <code>certutil -addstore -f -user ROOT ProgramData\\cert512121.der</code>.', '[Dok] installs a root certificate to aid in [Adversary-in-the-Middle] actions using the command <code>add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain /tmp/filename</code>.', '[Hikit] uses <code>certmgr.exe -add GlobalSign.cer -c -s -r localMachine Root</code> and <code>certmgr.exe -add GlobalSign.cer -c -s -r localMachineTrustedPublisher</code> to install a self-generated certificate to the local trust store as a root CA and Trusted Publisher.', '[RTM] can add a certificate to the Windows store.']"
T1027.004,Compile After Delivery,"Adversaries may attempt to make payloads difficult to discover and analyze by delivering files to victims as uncompiled code. Text-based source code files may subvert analysis and scrutiny from protections targeting executables/binaries. These payloads will need to be compiled before execution; typically via native utilities such as csc.exe or GCC/MinGW.  Source code payloads may also be encrypted, encoded, and/or embedded within other files, such as those delivered as a [Phishing] Payloads may also be delivered in formats unrecognizable and inherently benign to the native OS (ex: EXEs on macOS/Linux) before later being (re)compiled into a proper executable binary with a bundled compiler and execution framework.","['[Gamaredon Group] has compiled the source code for a downloader directly on the infected system using the built-in <code>Microsoft.CSharp.CSharpCodeProvider</code> class.\t', '[FoggyWeb] can compile and execute source code sent to the compromised AD FS server via a specific HTTP POST.', '[Rocke] has compiled malware, delivered to victims as .c files, with the GNU Compiler Collection (GCC).\t', '[MuddyWater] has used the .NET csc.exe tool to compile executables from downloaded C# code.', '[njRAT] has used AutoIt to compile the payload and main script into a single executable after delivery.', '[Cardinal RAT] and its watchdog component are compiled and executed after being delivered to victims as embedded, uncompiled source code.', '[DarkWatchman] has used the <code>csc.exe</code> tool to compile a C# executable. ']"
T1557.002,ARP Cache Poisoning,"Adversaries may poison Address Resolution Protocol (ARP) caches to position themselves between the communication of two or more networked devices. This activity may be used to enable follow-on behaviors such as [Network Sniffing] or [Transmitted Data Manipulation]  The ARP protocol is used to resolve IPv4 addresses to link layer addresses, such as a media access control (MAC) address. Devices in a local network segment communicate with each other by using link layer addresses. If a networked device does not have the link layer address of a particular networked device, it may send out a broadcast ARP request to the local network to translate the IP address to a MAC address. The device with the associated IP address directly replies with its MAC address. The networked device that made the ARP request will then use as well as store that information in its ARP cache.  An adversary may passively wait for an ARP request to poison the ARP cache of the requesting device. The adversary may reply with their MAC address, thus deceiving the victim by making them believe that they are communicating with the intended networked device. For the adversary to poison the ARP cache, their reply must be faster than the one made by the legitimate IP address owner. Adversaries may also send a gratuitous ARP reply that maliciously announces the ownership of a particular IP address to all the devices in the local network segment.  The ARP protocol is stateless and does not require authentication. Therefore, devices may wrongly add or update the MAC address of the IP address in their ARP cache.  Adversaries may use ARP cache poisoning as a means to intercept network traffic. This activity may be used to collect and/or relay data such as credentials, especially those sent over an insecure, unencrypted protocol. ","['[Cleaver] has used custom tools to facilitate ARP cache poisoning.', '[LuminousMoth] has used ARP spoofing to redirect a compromised machine to an actor-controlled website.']"
T1562.008,Disable or Modify Cloud Logs,"An adversary may disable or modify cloud logging capabilities and integrations to limit what data is collected on their activities and avoid detection. Cloud environments allow for collection and analysis of audit and application logs that provide insight into what activities a user does within the environment. If an adversary has sufficient permissions, they can disable or modify logging to avoid detection of their activities.  For example, in AWS an adversary may disable CloudWatch/CloudTrail integrations prior to conducting further malicious activity. They may alternatively tamper with logging functionality – for example, by removing any associated SNS topics, disabling multi-region logging, or disabling settings that validate and/or encrypt log files. In Office 365, an adversary may disable logging on mail collection activities for specific users by using the `Set-MailboxAuditBypassAssociation` cmdlet, by disabling M365 Advanced Auditing for the user, or by downgrading the user’s license from an Enterprise E5 to an Enterprise E3 license.","['[Pacu] can disable or otherwise restrict various AWS logging services, such as AWS CloudTrail and VPC flow logs.']"
T1565.002,Transmitted Data Manipulation,"Adversaries may alter data en route to storage or other systems in order to manipulate external outcomes or hide activity, thus threatening the integrity of the data. By manipulating transmitted data, adversaries may attempt to affect a business process, organizational understanding, and decision making.  Manipulation may be possible over a network connection or between system processes where there is an opportunity deploy a tool that will intercept and change information. The type of modification and the impact it will have depends on the target transmission mechanism as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.","['[Melcoz] can monitor the clipboard for cryptocurrency addresses and change the intended address to one controlled by the adversary.', '[APT38] has used DYEPACK to manipulate SWIFT messages en route to a printer.', '[LightNeuron] is capable of modifying email content, headers, and attachments during transit.', ""[Metamorfo] has a function that can watch the contents of the system clipboard for valid bitcoin addresses, which it then overwrites with the attacker's address. ""]"
T1543.001,Launch Agent,"Adversaries may create or modify launch agents to repeatedly execute malicious payloads as part of persistence. When a user logs in, a per-user launchd process is started which loads the parameters for each launch-on-demand user agent from the property list (.plist) file found in <code>/System/Library/LaunchAgents</code>, <code>/Library/LaunchAgents</code>, and <code>~/Library/LaunchAgents</code>.  Property list files use the <code>Label</code>, <code>ProgramArguments </code>, and <code>RunAtLoad</code> keys to identify the Launch Agent's name, executable location, and execution time. Launch Agents are often installed to perform updates to programs, launch user specified programs at login, or to conduct other developer tasks.   Launch Agents can also be executed using the [Launchctl] command.   Adversaries may install a new Launch Agent that executes at login by placing a .plist file into the appropriate folders with the <code>RunAtLoad</code> or <code>KeepAlive</code> keys set to <code>true</code>. The Launch Agent name may be disguised by using a name from the related operating system or benign software. Launch Agents are created with user level privileges and execute with user level permissions. ","['[Calisto] adds a .plist file to the /Library/LaunchAgents folder to maintain persistence.', '[Proton] persists via Launch Agent.', '[MacSpy] persists via a Launch Agent.', '[CrossRAT] creates a Launch Agent on macOS.', '[Dok] installs two LaunchAgents to redirect all network traffic with a randomly generated name for each plist file maintaining the format <code>com.random.name.plist</code>.', '[Dacls] can establish persistence via a LaunchAgent.', '[MacMa] installs a `com.apple.softwareupdate.plist` file in the `/LaunchAgents` folder with the `RunAtLoad` value set to `true`. Upon user login, [MacMa] is executed from `/var/root/.local/softwareupdate` with root privileges. Some variations also include the `LimitLoadToSessionType` key with the value `Aqua`, ensuring the [MacMa] only runs when there is a logged in GUI user.', '[OSX_OCEANLOTUS.D] can create a persistence file in the folder <code>/Library/LaunchAgents</code>.', '[Bundlore] can persist via a LaunchAgent.', '[ThiefQuest] installs a launch item using an embedded encrypted launch agent property list template. The plist file is installed in the <code>~/Library/LaunchAgents/</code> folder and configured with the path to the persistent binary located in the <code>~/Library/</code> folder.', '[macOS.OSAMiner] has placed a [Stripped Payloads] with a `plist` extension in the [Launch Agent] folder. ', '[CoinTicker] creates user launch agents named .espl.plist and com.apple.[random string].plist to establish persistence.\t', '[Green Lambert] can create a [Launch Agent] with the `RunAtLoad` key-value pair set to <code>true</code>, ensuring the `com.apple.GrowlHelper.plist` file runs every time a user logs in.', '[CookieMiner] has installed multiple new Launch Agents in order to maintain persistence for cryptocurrency mining software.', '[FruitFly] persists via a Launch Agent.', ' The [Komplex] trojan creates a persistent launch agent called with <code>$HOME/Library/LaunchAgents/com.apple.updates.plist</code> with <code>launchctl load -w ~/Library/LaunchAgents/com.apple.updates.plist</code>.', '[NETWIRE] can use launch agents for persistence.', '[Keydnap] uses a Launch Agent to persist.']"
T1027.006,HTML Smuggling,"Adversaries may smuggle data and files past content filters by hiding malicious payloads inside of seemingly benign HTML files. HTML documents can store large binary objects known as JavaScript Blobs (immutable data that represents raw bytes) that can later be constructed into file-like objects. Data may also be stored in Data URLs, which enable embedding media type or MIME files inline of HTML documents. HTML5 also introduced a download attribute that may be used to initiate file downloads.  Adversaries may deliver payloads to victims that bypass security controls through HTML Smuggling by abusing JavaScript Blobs and/or HTML5 download attributes. Security controls such as web content filters may not identify smuggled malicious files inside of HTML/JS files, as the content may be based on typically benign MIME types such as <code>text/plain</code> and/or <code>text/html</code>. Malicious files or data can be obfuscated and hidden inside of HTML files through Data URLs and/or JavaScript Blobs and can be deobfuscated when they reach the victim (i.e. [Deobfuscate/Decode Files or Information] potentially bypassing content filters.  For example, JavaScript Blobs can be abused to dynamically generate malicious files in the victim machine and may be dropped to disk by abusing JavaScript functions such as <code>msSaveBlob</code>.","['[QakBot] has been delivered in ZIP files via HTML smuggling.', '[APT29] has embedded an ISO file within an HTML attachment that contained JavaScript code to initiate malware execution. ', '[EnvyScout] contains JavaScript code that can extract an encoded blob from its HTML body and write it to disk.']"
T1546.016,Installer Packages,"Adversaries may establish persistence and elevate privileges by using an installer to trigger the execution of malicious content. Installer packages are OS specific and contain the resources an operating system needs to install applications on a system. Installer packages can include scripts that run prior to installation as well as after installation is complete. Installer scripts may inherit elevated permissions when executed. Developers often use these scripts to prepare the environment for installation, check requirements, download dependencies, and remove files after installation.  Using legitimate applications, adversaries have distributed applications with modified installer scripts to execute malicious content. When a user installs the application, they may be required to grant administrative permissions to allow the installation. At the end of the installation process of the legitimate application, content such as macOS `postinstall` scripts can be executed with the inherited elevated permissions. Adversaries can use these scripts to execute a malicious executable or install other malicious components (such as a [Launch Daemon] with the elevated permissions.  Depending on the distribution, Linux versions of package installer scripts are sometimes called maintainer scripts or post installation scripts. These scripts can include `preinst`, `postinst`, `prerm`, `postrm` scripts and run as root when executed.  For Windows, the Microsoft Installer services uses `.msi` files to manage the installing, updating, and uninstalling of applications. Adversaries have leveraged `Prebuild` and `Postbuild` events to run commands before or after a build when installing .msi files.","[""During [AppleJeus] installation process, it uses `postinstall` scripts to extract a hidden plist from the application's `/Resources` folder and execute the `plist` file as a [Launch Daemon] with elevated permissions.""]"
T1550.002,Pass the Hash,"Adversaries may “pass the hash” using stolen password hashes to move laterally within an environment, bypassing normal system access controls. Pass the hash (PtH) is a method of authenticating as a user without having access to the user's cleartext password. This method bypasses standard authentication steps that require a cleartext password, moving directly into the portion of the authentication that uses the password hash.  When performing PtH, valid password hashes for the account being used are captured using a [Credential Access] technique. Captured hashes are used with PtH to authenticate as that user. Once authenticated, PtH may be used to perform actions on local or remote systems.  Adversaries may also use stolen password hashes to ""overpass the hash."" Similar to PtH, this involves using a password hash to authenticate as a user but also uses the password hash to create a valid Kerberos ticket. This ticket can then be used to perform [Pass the Ticket] attacks.","['[APT32] has used pass the hash for lateral movement.', '[Cobalt Strike] can perform pass the hash.', '[Pass-The-Hash Toolkit] can perform pass the hash.', '[APT28] has used pass the hash for lateral movement.', '[Chimera] has dumped password hashes for use in pass the hash authentication attacks.', 'The [APT1] group is known to have used pass the hash.', '[Wizard Spider] has used the `Invoke-SMBExec` PowerShell cmdlet to execute the pass-the-hash technique and utilized stolen password hashes to move laterally.', '[HOPLIGHT] has been observed loading several APIs associated with Pass the Hash.\t', '[PoshC2] has a number of modules that leverage pass the hash for lateral movement.', '[Mimikatz] <code>SEKURLSA::Pth</code> module can impersonate a user, with only a password hash, to execute arbitrary commands.', '[Kimsuky] has used pass the hash for authentication to remote access software used in C2.', '[Empire] can perform pass the hash attacks.', '[FIN13] has used the PowerShell utility `Invoke-SMBExec` to execute the pass the hash method for lateral movement within an compromised environment.', '[BADHATCH] can perform pass the hash on compromised machines with x64 versions. ', '[CrackMapExec] can pass the hash to authenticate via SMB.', 'During [Night Dragon] threat actors used pass-the-hash tools to obtain authenticated access to sensitive internal desktops and servers.', '[GALLIUM] used dumped hashes to authenticate to other machines via pass the hash.', '[Night Dragon] used pass-the-hash tools to gain usernames and passwords.', '[Cobalt Strike] can perform pass the hash.']"
T1001.002,Steganography,"Adversaries may use steganographic techniques to hide command and control traffic to make detection efforts more difficult. Steganographic techniques can be used to hide data in digital messages that are transferred between systems. This hidden information can be used for command and control of compromised systems. In some cases, the passing of files embedded using steganography, such as image or document files, can be used for command and control. ","['[Axiom] has used steganography to hide its C2 communications.', '[HAMMERTOSS] is controlled via commands that are appended to image files.', '[Sliver] can encode binary data into a .PNG file for C2 communication.', 'During [Operation Ghost] [APT29] used steganography to hide the communications between the implants and their C&C servers.', '[Zox] has used the .PNG file format for C2 communications.', '[LightNeuron] is controlled via commands that are embedded into PDFs and JPGs using steganographic methods.', '[ZeroT] has retrieved stage 2 payloads as Bitmap images that use Least Significant Bit (LSB) steganography.', '[Daserf] can use steganography to hide malicious code downloaded to the victim.', '[RDAT] can process steganographic images attached to email messages to send and receive C2 commands. [RDAT] can also embed additional messages within BMP images to communicate with the [RDAT] operator.\t', 'When the [Duqu] command and control is operating over HTTP or HTTPS, Duqu uploads data to its controller by appending it to a blank JPG file.', '[SUNBURST] C2 data attempted to appear as benign XML related to .NET assemblies or as a faux JSON blob.', '[APT29] has used steganography to hide C2 communications in images.']"
T1550.001,Application Access Token,"Adversaries may use stolen application access tokens to bypass the typical authentication process and access restricted accounts, information, or services on remote systems. These tokens are typically stolen from users or services and used in lieu of login credentials.  Application access tokens are used to make authorized API requests on behalf of a user or service and are commonly used to access resources in cloud, container-based applications, and software-as-a-service (SaaS).   OAuth is one commonly implemented framework that issues tokens to users for access to systems. These frameworks are used collaboratively to verify the user and determine what actions the user is allowed to perform. Once identity is established, the token allows actions to be authorized, without passing the actual credentials of the user. Therefore, compromise of the token can grant the adversary access to resources of other sites through a malicious application.  For example, with a cloud-based email service, once an OAuth access token is granted to a malicious application, it can potentially gain long-term access to features of the user account if a ""refresh"" token enabling background access is awarded. With an OAuth access token an adversary can use the user-granted REST API to perform functions such as email searching and contact enumeration.  Compromised access tokens may be used as an initial step in compromising other services. For example, if a token grants access to a victim’s primary email, the adversary may be able to extend access to all other services which the target subscribes by triggering forgotten password routines. In AWS and GCP environments, adversaries can trigger a request for a short-lived access token with the privileges of another user account. The adversary can then use this token to request data or perform actions the original account could not. If permissions for this feature are misconfigured – for example, by allowing all users to request a token for a particular account - an adversary may be able to gain initial access to a Cloud Account or escalate their privileges.  Direct API access through a token negates the effectiveness of a second authentication factor and may be immune to intuitive countermeasures like changing passwords.  For example, in AWS environments, an adversary who compromises a user’s AWS API credentials may be able to use the `sts:GetFederationToken` API call to create a federated user session, which will have the same permissions as the original user but may persist even if the original user credentials are deactivated. Additionally, access abuse over an API channel can be difficult to detect even from the service provider end, as the access can still align well with a legitimate workflow.","['[Peirates] can use stolen service account tokens to perform its operations. It also enables adversaries to switch between valid service accounts.', '[CreepyDrive] can use legitimate OAuth refresh tokens to authenticate with OneDrive.', 'During the [SolarWinds Compromise] [APT29] used compromised service principals to make changes to the Office 365 environment.', '[APT28] has used several malicious applications that abused OAuth access tokens to gain access to target email accounts, including Gmail and Yahoo Mail.', '[APT29] has used compromised service principals to make changes to the Office 365 environment.']"
T1558.003,Kerberoasting,"Adversaries may abuse a valid Kerberos ticket-granting ticket (TGT) or sniff network traffic to obtain a ticket-granting service (TGS) ticket that may be vulnerable to [Brute Force]   Service principal names (SPNs) are used to uniquely identify each instance of a Windows service. To enable authentication, Kerberos requires that SPNs be associated with at least one service logon account (an account specifically tasked with running a service).  Adversaries possessing a valid Kerberos ticket-granting ticket (TGT) may request one or more Kerberos ticket-granting service (TGS) service tickets for any SPN from a domain controller (DC). Portions of these tickets may be encrypted with the RC4 algorithm, meaning the Kerberos 5 TGS-REP etype 23 hash of the service account associated with the SPN is used as the private key and is thus vulnerable to offline [Brute Force] attacks that may expose plaintext credentials.   This same behavior could be executed using service tickets captured from network traffic.  Cracked hashes may enable [Persistence] [Privilege Escalation] and [Lateral Movement] via access to [Valid Accounts]","['[Rubeus] can use the `KerberosRequestorSecurityToken.GetRequest` method to request kerberoastable service tickets.', '[Impacket] modules like GetUserSPNs can be used to get Service Principal Names (SPNs) for user accounts. The output is formatted to be compatible with cracking tools like John the Ripper and Hashcat.', '[Empire] uses [PowerSploit] <code>Invoke-Kerberoast</code> to request service tickets and return crackable ticket hashes.', '[Wizard Spider] has used Rubeus, MimiKatz Kerberos module, and the Invoke-Kerberoast cmdlet to steal AES hashes.', 'During [Operation Wocao] threat actors used [PowerSploit] `Invoke-Kerberoast` module to request encrypted service tickets and bruteforce the passwords of Windows service accounts offline.', '[SILENTTRINITY] contains a module to conduct Kerberoasting.', 'During the [SolarWinds Compromise] [APT29] obtained Ticket Granting Service (TGS) tickets for Active Directory Service Principle Names to crack offline.', '[PowerSploit] <code>Invoke-Kerberoast</code> module can request service tickets and return crackable ticket hashes.', '[FIN7] has used Kerberoasting PowerShell commands such as, `Invoke-Kerberoast` for credential access and to enable lateral movement.', '[Brute Ratel C4] can decode Kerberos 5 tickets and convert it to hashcat format for subsequent cracking.', '[APT29] obtained Ticket Granting Service (TGS) tickets for Active Directory Service Principle Names to crack offline.', '[UNC2452] obtained Ticket Granting Service (TGS) tickets for Active Directory Service Principle Names to crack offline.', ""[Operation Wocao] has used PowerSploit's Invoke-Kerberoast module to request encrypted service tickets and bruteforce the passwords of Windows service accounts offline.""]"
T1056.004,Credential API Hooking,"Adversaries may hook into Windows application programming interface (API) functions to collect user credentials. Malicious hooking mechanisms may capture API calls that include parameters that reveal user authentication credentials. Unlike [Keylogging]  this technique focuses specifically on API functions that include parameters that reveal user credentials. Hooking involves redirecting calls to these functions and can be implemented via:  * **Hooks procedures**, which intercept and execute designated code in response to events such as messages, keystrokes, and mouse inputs. * **Import address table (IAT) hooking**, which use modifications to a process’s IAT, where pointers to imported API functions are stored. * **Inline hooking**, which overwrites the first bytes in an API function to redirect code flow. ","['[Zeus Panda] hooks processes by leveraging its own IAT hooked functions.', '[Carberp] has hooked several Windows API functions to steal credentials.', '[FinFisher] hooks processes by modifying IAT pointers to CreateWindowEx.', '[Ursnif] has hooked APIs to perform a wide variety of information theft, such as monitoring traffic from browsers.', '[ZxShell] hooks several API functions to spawn system threads. ', '[PLATINUM] is capable of using Windows hook interfaces for information gathering such as credential access.', '[Zebrocy] installs an application-defined Windows hook to get notified when a network drive has been attached, so it can then use the hook to call its RecordToFile file stealing method.', '[RDFSNIFFER] hooks several Win32 API functions to hijack elements of the remote system management user-interface.', '[Empire] contains some modules that leverage API hooking to carry out tasks, such as netripper.', '[TrickBot] has the ability to capture RDP credentials by capturing the <code>CredEnumerateA</code> API ', ""[NOKKI] uses the Windows call SetWindowsHookEx and begins injecting it into every GUI process running on the victim's machine.""]"
T1574.004,Dylib Hijacking,"Adversaries may execute their own payloads by placing a malicious dynamic library (dylib) with an expected name in a path a victim application searches at runtime. The dynamic loader will try to find the dylibs based on the sequential order of the search paths. Paths to dylibs may be prefixed with <code>@rpath</code>, which allows developers to use relative paths to specify an array of search paths used at runtime based on the location of the executable.  Additionally, if weak linking is used, such as the <code>LC_LOAD_WEAK_DYLIB</code> function, an application will still execute even if an expected dylib is not present. Weak linking enables developers to run an application on multiple macOS versions as new APIs are added.  Adversaries may gain execution by inserting malicious dylibs with the name of the missing dylib in the identified path. Dylibs are loaded into an application's address space allowing the malicious dylib to inherit the application's privilege level and resources. Based on the application, this could result in privilege escalation and uninhibited network access. This method may also evade detection from security products since the execution is masked under a legitimate process.",['[Empire] has a dylib hijacker module that generates a malicious dylib given the path to a legitimate dylib of a vulnerable application.']
